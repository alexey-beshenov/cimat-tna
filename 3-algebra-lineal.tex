\chapter{Álgebra \texorpdfstring{$\ZZ$}{ℤ}-lineal}

Dedicamos el capítulo anterior al álgebra conmutativa, y ahora nos ocuparemos
de\dots{} álgebra lineal. Recordemos que para una extensión finita de campos
$L/K$, la norma y traza de un elemento $\alpha \in L$ se definen como el
determinante y traza de la aplicación $K$-lineal $x \mapsto \alpha x$.
Ahora vamos a explorar estas construcciones para extensiones de anillos.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\pdfbookmark{Clase 9 (07/09/20)}{clase-9}
\section{Norma y traza}
\marginpar{\small Clase 9 \\ 07/09/20}

\begin{definicion}
  Sea $A \subset B$ una extensión de anillos tal que $B$ es un $A$-módulo libre
  de rango $n$ sobre $A$. Para $\beta \in B$ consideremos la aplicación
  $A$-lineal de multiplicación por $\beta$:
  $$\mu_\beta\colon B \to B, \quad x \mapsto \beta x.$$
  La \textbf{norma} y \textbf{traza} de $\beta$ se definen como el determinante
  y traza de $\mu_\beta$ respectivamente:
  $$N_{B/A} (\beta) = \det \mu_\beta, \quad T_{B/A} (\beta) = \tr \mu_\beta.$$
  Esto nos da aplicaciones
  $$N_{B/A}, T_{B/A}\colon B\to A.$$
\end{definicion}

Específicamente, si $e_1, \ldots, e_n$ es una base de $B$ sobre $A$ y
$\beta \, e_i = \sum_j m_{ij} e_j$, entonces
$$N (\beta) = \det (m_{ij})_{i,j}, \quad T (\beta) = \sum_i m_{ii}.$$

El argumento habitual demuestra que esto no depende de la elección de base:
si $T$ es una matriz de cambio de base, entonces es invertible, y luego
\begin{gather*}
  \det (T M T^{-1}) = \det (T) \, \det (M) \, \det (T)^{-1} = \det (M),\\
  \tr (T M T^{-1}) = \tr (T^{-1} T M) = \tr (M).
\end{gather*}

Vamos a denotar el polinomio característico correspondiente por
$$f^\beta_{B/A} = \det (x I_n - M).$$
Este es un polinomio mónico de grado $n$:
$$f^\beta_{B/A} = x^n + a_{n-1} x^{n-1} + \cdots + a_1 x + a_0 \in A [x].$$
El argumento habitual demuestra que
\begin{equation}
  \label{eqn:norma-y-traza-coeficientes-de-polinomio-caracteristico}
  a_0 = (-1)^n \, N_{B/A} (\beta), \quad a_{n-1} = -T_{B/A} (\beta).
\end{equation}

La norma es multiplicativa:
$$N (\beta \beta') = N (\beta)\,N(\beta'),$$
mientras que la traza es $A$-lineal:
\[ T (a \beta) = a \, T (\beta), \quad
   T (\beta+\beta') = T (\beta) + T (\beta'). \]
Para $a \in A$ se tiene
$$N (a) = a^n, \quad T (a) = na.$$

\begin{proposicion}
  Para un campo de números $K/\QQ$ tenemos $n = [K : \QQ]$ encajes
  $$\sigma_1,\ldots,\sigma_n\colon K \hookrightarrow \CC,$$
  y la norma y traza vienen dadas por
  \[ N_{K/\QQ} (\alpha) = \sigma_1 (\alpha) \cdots \sigma_n (\alpha), \quad
     T_{K/\QQ} (\alpha) = \sigma_1 (\alpha) + \cdots + \sigma_n (\alpha). \]
  Aquí $\sigma_i (\alpha)$ son las raíces del polinomio característico
  de $\alpha$ respecto a la extensión $K/\QQ$.

  \begin{proof}
    Primero, si $K = \QQ (\alpha)$, entonces un encaje
    $\sigma\colon K \hookrightarrow \CC$ está definido por la imagen de
    $\alpha$ y tiene que enviarlo a una raíz compleja del polinomio
    mínimo $f_\QQ^\alpha$. De esta manera surgen los
    $[K (\alpha) : \QQ]$ encajes. Tenemos
    \[ f_\QQ^\alpha =
       \prod_{\sigma\colon K\hookrightarrow \CC} (x - \sigma (\alpha)). \]

    En general, tenemos $\QQ \subset \QQ (\alpha) \subset K$, y cada
    encaje $\sigma\colon \QQ (\alpha) \hookrightarrow \CC$ admite
    $[K : \QQ (\alpha)]$ extensiones a un encaje $K \hookrightarrow \CC$.
    Ahora
    \[ f^\alpha_{K/\QQ} = (f^\alpha_\QQ)^{[K : \QQ (\alpha)]} =
       \prod_{\sigma\colon K\hookrightarrow \CC} (x - \sigma (\alpha)), \]
    donde $f^\alpha_{K/\QQ}$ es el polinomio característico, mientras que
    $f^\alpha_\QQ$ es el polinomio mínimo.
    En fin, recordemos cómo la norma y traza están relacionadas con los
    coeficientes del polinomio característico (las fórmulas
    \eqref{eqn:norma-y-traza-coeficientes-de-polinomio-caracteristico}).
  \end{proof}
\end{proposicion}

\begin{comentario}
  Dado que $K/\QQ$ es una extensión algebraica, en realidad todo encaje
  $\sigma\colon K \hookrightarrow \CC$ tiene su imagen en $\overline{\QQ}$,
  la cerradura algebraica de $\QQ$, así que los números complejos no son
  tan relevantes.

  Si $K/\QQ$ es una extensión de Galois, entonces los encajes
  $K \hookrightarrow \CC$ corresponden a los elementos de $\Gal (K/\QQ)$.
  En general, puede haber más encajes que automorfismos de Galois.

  Para revisar más detalles sobre la norma y traza de una extensión finita de
  campos, el lector puede revisar, por ejemplo,
  \cite[\S II.8]{Morandi-GTM167} o \cite[\S VI.5]{Lang-Algebra}.
\end{comentario}

\begin{proposicion}
  Si $\alpha \in \O_K$, entonces
  $N_{K/\QQ} (\alpha), T_{K/\QQ} (\alpha) \in \ZZ$.

  \begin{proof}
    Si $\alpha_1, \ldots, \alpha_n$ son las raíces del polinomio característico
    de $\alpha$ sobre $\QQ$, entonces estas son también enteros algebraicos,
    y por lo tanto $N (\alpha) = \alpha_1\cdots\alpha_n$ y
    $T (\alpha) = \alpha_1 + \cdots + \alpha_n$ son enteros algebraicos.
    Al mismo tiempo son números racionales, así que
    $N (\alpha), T (\alpha) \in \ZZ$.
  \end{proof}
\end{proposicion}

\begin{proposicion}
  Se tiene
  $$\O_K^\times = \{ \alpha \in \O_K \mid N (\alpha) = \pm 1 \}.$$

  \begin{proof}
    Si $\alpha \in \O_K$ tiene inverso $\alpha^{-1} \in \O_K$, entonces
    $$N (\alpha)\, N (\alpha^{-1}) = N (\alpha\alpha^{-1}) = 1.$$
    Pero $N (\alpha^{\pm 1}) \in \ZZ$, así que $N (\alpha) = \pm 1$.
    Viceversa, si $\alpha \in \O_K$ y $N (\alpha) = \pm 1$, sean
    $\alpha_1 = \alpha$, $\alpha_2$, $\ldots$, $\alpha_n$ las raíces
    del polinomio característico de $\alpha$. Tenemos
    $$\alpha \alpha_2 \cdots \alpha_n = \pm 1,$$
    y luego
    $$\alpha^{-1} = \pm (\alpha_2 \cdots \alpha_n),$$
    donde $\alpha_i$ son enteros algebraicos, así que el producto a la derecha
    está en $\O_K$\footnote{No estamos diciendo que cada $\alpha_i$ está en
      $K$; esto sucede cuando $K/\QQ$ es una extensión de Galois.}.
  \end{proof}
\end{proposicion}

\begin{ejemplo}
  Consideremos el campo cuadrático $K = \QQ (\sqrt{d})$, donde $d$ es libre de
  cuadrados. La multiplicación por $a + b\sqrt{d}$ en la base $1, \sqrt{d}$ se
  representa por la matriz
  \[ \begin{pmatrix}
    a & db \\
    b & a
  \end{pmatrix}. \]
  Entonces,
  \[ N (a + b\sqrt{d}) = a^2 - db^2, \quad
     T (a + b\sqrt{d}) = 2a. \]
  También calculamos
  \[ (a + b\sqrt{d})\,(a - b\sqrt{d}) = a^2 - db^2, \quad
     (a + b\sqrt{d}) + (a - b\sqrt{d}) = 2a. \qedhere \]
\end{ejemplo}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Recordatorio de álgebra lineal}

Sea $V$ un espacio vectorial de dimensión finita sobre un campo $k$.
Consideremos una forma bilineal simétrica
$$\langle\cdot,\cdot\rangle\colon V\times V\to k.$$

Sea $e_1,\ldots,e_n$ una base de $V$. El \textbf{discriminante} de
$\langle\cdot,\cdot\rangle$ respecto a esta base se define como
$$\Delta (e_1,\ldots,e_n) = \det (\langle e_i,e_j\rangle)_{i,j}.$$

El discriminante depende de la base. En general, si $f_1,\ldots,f_n$ son algunos
elementos de $V$ y $f_i = \sum_j a_{ij} e_j$, entonces calculamos que
\[ \langle f_k,f_\ell\rangle =
   \langle \sum_i a_{ki} e_i, \sum_j a_{\ell j} e_j \rangle =
   \sum_{i,j} a_{ki} \, \langle e_i, e_j\rangle \, a_{\ell j}. \]
En términos de matrices,
\[ (\langle f_i,f_j\rangle)_{i,j} =
   (a_{ij}) \cdot (\langle e_i, e_j\rangle)_{i,j} \cdot (a_{ij})^t. \]
Luego,
\[ \det (\langle f_i,f_j\rangle)_{i,j} =
   \det (a_{ij})_{i,j}^2 \cdot \det (\langle e_i, e_j\rangle)_{i,j}. \]
También recordemos que $f_1,\ldots,f_n$ es otra base de $V$ si y solamente si
$\det (a_{ij})_{i,j} \ne 0$.

Se dice que la forma $\langle\cdot,\cdot\rangle$ es \textbf{no degenerada}
si se cumple una de las siguientes condiciones equivalentes:
\begin{enumerate}
\item[1)] el discriminante de $\langle\cdot,\cdot\rangle$ respecto a alguna
  base de $V$ no es nulo;
\item[2)] $\langle\cdot,\cdot\rangle$ induce un isomorfismo entre $V$ y el
  espacio dual $V^\vee = \Hom_k (V,k)$ mediante
  \[ \phi\colon V \xrightarrow{\cong} V^\vee, \quad
     v \mapsto (x \mapsto \langle v,x\rangle). \]
\end{enumerate}

Ahora supongamos que se cumplen estas condiciones. Recordemos que el espacio
dual $V^\vee$ tiene base $e_1^*, \ldots, e_n^*$ definida por
\[ e_i^* (e_j) = \delta_{ij} = \begin{cases}
  1, & \text{si } i = j,\\
  0, & \text{si } i \ne j.
\end{cases} \]
Usando el isomorfismo $\phi\colon V \cong V^\vee$ de arriba, podemos tomar
los vectores $e_i' = \phi^{-1} (e_i^*)$, y luego $e_1', \ldots, e_n'$ cumplen
$$\langle e_i', e_j\rangle = \delta_{ij}.$$
Podemos decir que $e_1', \ldots, e_n'$ es la base \textbf{dual} a
$e_1, \ldots, e_n$ respecto a la forma bilineal.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Apareamiento de traza y el discriminante}

\begin{definicion}
  Para una extensión de anillos $A \subset B$ tal que $B$ es un $A$-módulo libre
  de rango $n$, el \textbf{apareamiento de traza}\footnote{En la primera
    versión de estos apuntes decía ``emparejamiento'' y luego me di cuenta de
    que en México es más común el término ``apareamiento''.}  es la forma
  $A$-bilineal simétrica
  \[ \langle\cdot,\cdot\rangle\colon B\times B\to A, \quad
     (x,y) \mapsto T_{B/A} (xy). \]
  Para una base $e_1,\ldots,e_n$ de $B$ sobre $A$, el \textbf{discriminante}
  viene dado por
  \[ \Delta (e_1,\ldots,e_n) =
     \det (\langle e_i,e_j\rangle)_{i,j}. \]
\end{definicion}

Si $f_1, \ldots, f_n$ son otros elementos que se expresan en términos de los
$e_i$ mediante $f_i = \sum_j a_{ij} e_j$, entonces los mismos cálculos que vimos
arriba nos dan la relación
\[ \Delta (f_1,\ldots,f_n) =
   \det (a_{ij})_{i,j}^2 \cdot \Delta (e_1,\ldots,e_n). \]
Ahora $f_1,\ldots,f_n$ es una base si y solamente si $(a_{ij})_{i,j}$ es una
matriz invertible, lo que equivale a $\det (a_{ij})_{i,j} \in A^\times$.
Entonces, si no queremos fijar una base particular, el discriminante está bien
definido solamente salvo un factor de $(A^\times)^2$, como un elemento de
$A^\times/(A^\times)^2$.

Sin embargo, en el caso particular cuando $A = \ZZ$, tenemos $(A^\times)^2 = 1$,
así que el discriminante es un número entero bien definido. Vale la pena
recordar esto como una definición. Como siempre nos interesan anillos de
números $R \subset K$.

\begin{definicion}
  Sea $R$ un anillo de números que es finitamente generado (y luego libre) como
  $\ZZ$-módulo. Entonces, \textbf{el~discriminante} de $R$ viene dado por
  $$\Delta (R) = \det (\langle \alpha_i, \alpha_j\rangle)_{i,j},$$
  donde $\alpha_1,\ldots,\alpha_n$ es alguna base de $R$ sobre $\ZZ$.
  (Como acabamos de notar, el resultado no depende de la base.)
\end{definicion}

\begin{lema}
  \label{lema:indice-de-Z-submodulo-como-determinante}
  Sea $R$ un $\ZZ$-módulo libre de rango $n$ con una base
  $\alpha_1,\ldots,\alpha_n$. Para $\beta_1,\ldots,\beta_n \in R$
  consideremos el $\ZZ$-submódulo generado por $\beta_1,\ldots,\beta_n$:
  $$M = \ZZ \langle\beta_1,\ldots,\beta_n\rangle.$$
  Tenemos $\beta_i = \sum_j a_{ij} \alpha_j$ para $a_{ij} \in \ZZ$.
  Entonces,
  \[ [R : M] = \begin{cases}
    \infty, & \text{si }\det (a_{ij})_{i,j} = 0, \\
    |\det (a_{ij})_{i,j}|, & \text{si }\det (a_{ij})_{i,j} \ne 0.
    \end{cases} \]

  \begin{proof}
    Podemos identificar $R$ con $\ZZ^n$ y el submódulo $M \subset R$
    con la imagen de una aplicación $\ZZ$-lineal $A\colon\ZZ^n \to \ZZ^n$
    (multiplicación por la matriz $A$).

    Primero, si $\det A = 0$, esto significa que hay una dependencia
    $\ZZ$-lineal entre los vectores de $M$, así que $\rk M < n$,
    y el índice de $M$ es infinito.

    Podemos poner $A$ en la \textbf{forma normal de Smith} (véase
    por ejemplo \cite[Chapter 2]{Cohen-GTM138})
    \[ B = \begin{pmatrix}
      b_1 \\
      & \ddots \\
      & & b_n
      \end{pmatrix} = U A V, \]
    donde $B$ es una matriz diagonal y $U, V \in \GL_n (\ZZ)$.
    Las aplicaciones $\ZZ$-lineales $U, V\colon \ZZ^n\to \ZZ^n$ son
    isomorfismos, así que $[\ZZ^n : A (\ZZ^n)] = [\ZZ^n : B (\ZZ^n)]$.
    Tenemos
    $$\det B = \det (U A V) = \pm\det (A),$$
    y luego
    \[ [\ZZ^n : B (\ZZ^n)] = \# (\ZZ/b_1\ZZ \times \cdots \times \ZZ/b_n\ZZ)
       = |\det B|. \qedhere \]
  \end{proof}
\end{lema}

\begin{ejemplo}
  Consideremos el subgrupo de $R = \ZZ^2$ generado por los vectores
  $\beta_1 = (2,3)$ y $\beta_2 = (-2,1)$. Estos corresponden a la matriz
  \[ A = \begin{pmatrix}
    2 & -2 \\
    3 & 1
  \end{pmatrix}. \]
  La forma normal de Smith en este caso
  será
  \[ \begin{pmatrix}
    1 & -6 \\
    0 & 1
  \end{pmatrix} \, \begin{pmatrix}
    2 & -2 \\
    3 & 1
  \end{pmatrix} \, \begin{pmatrix}
    1 & 1 \\
    -3 & -2
  \end{pmatrix} = \begin{pmatrix}
    8 & 0 \\
    0 & 1
  \end{pmatrix}. \]
  Entonces, el cociente de $\ZZ^2$ por $A (\ZZ^2)$ tiene $8$ elementos.
  Aquí están dibujados los vectores $\beta_1$ y $\beta_2$ y ocho representantes
  del cociente $\ZZ^2 / A (\ZZ^2)$.

  \begin{center}
    \begin{tikzpicture}[x=0.5cm,y=0.5cm]
        \fill[blue!20] (0,0) -- (2,3) -- (0,4) -- (-2,1) -- cycle;

        \foreach \i in {-5, ..., 5}
        \draw[black!40] (-5,\i) -- (5,\i);
        \foreach \i in {-5, ..., 5}
        \draw[black!40] (\i,-5) -- (\i,5);

        \draw[->] (-6,0) -- (6,0) node[right] {$e_1$};
        \draw[->] (0,-6) -- (0,6) node[above] {$e_2$};

        \draw[->] (0,0) -- (2,3) node [label={above right:$\beta_1$}] {};
        \draw[->] (0,0) -- (-2,1) node [label={above left:$\beta_2$}] {};

        \draw (-1,1) node[circle,fill,inner sep=1pt] {};
        \draw (-1,2) node[circle,fill,inner sep=1pt] {};
        \draw (0,0) node[circle,fill,inner sep=1pt] {};
        \draw (0,1) node[circle,fill,inner sep=1pt] {};
        \draw (0,2) node[circle,fill,inner sep=1pt] {};
        \draw (0,3) node[circle,fill,inner sep=1pt] {};
        \draw (1,2) node[circle,fill,inner sep=1pt] {};
        \draw (1,3) node[circle,fill,inner sep=1pt] {};
    \end{tikzpicture}
  \end{center}
\end{ejemplo}

Esto nos lleva al siguiente resultado.

\begin{proposicion}
  \label{prop:discriminantes-e-indice}
  Sea $R$ un anillo de números que es un $\ZZ$-módulo libre de rango $n$
  y $M \subseteq R$ un submódulo de rango $n$ generado por algunos elementos
  $\beta_1,\ldots,\beta_n$. Luego,
  $$\Delta (M) = [R : M]^2 \cdot \Delta (R).$$

  \begin{proof}
    $\Delta (M) = \Delta (\beta_1,\ldots,\beta_n) = \det (a_{ij})_{i,j}^2 \cdot \Delta (R)$,
    donde $|\det (a_{ij})| = [R : M]$.
  \end{proof}
\end{proposicion}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Generación finita del anillo de enteros}

Nuestro próximo objetivo es probar que para un campo de números
el apareamiento de traza no es degenerado y sacar algunas consecuencias
importantes de este resultado.
Primero necesitamos un lema bien conocido de la teoría de campos.

\begin{lema}[Dedekind; independencia lineal de caracteres]
  Dado un grupo abeliano $G$ y un campo $F$, consideremos diferentes caracteres
  multiplicativos $\chi_1,\ldots,\chi_n\colon G\to F^\times$. Estos son
  necesariamente linealmente independientes sobre $F$: si para algunos
  $c_1,\ldots,c_n \in F$ se cumple
  $$c_1 \chi_1 (g) + \cdots + \chi_n (g) = 0 \quad\text{para todo }g\in G,$$
  entonces $c_1 = \cdots = c_n = 0$.

  \begin{proof}
    Inducción sobre $n$, el caso base siendo $n = 1$. Supongamos que
    el resultado es válido para $n-1$ caracteres.
    Consideremos una dependencia lineal
    \[ \tag{*} c_1 \chi_1 (g) + \cdots + c_{n-1} \chi_{n-1} (g) + c_n \chi_n (g)
       = 0 \quad\text{para todo }g\in G. \]
    Dado que los caracteres son diferentes, existe $g_0 \in G$ tal que $\chi_1
    (g_0) \ne \chi_n (g_0)$. Sustituyendo $g_0 g$ en lugar de $g$, se obtiene
    \[ \tag{**} c_1 \chi_1 (g_0) \chi_1 (g) + \cdots +
       c_{n-1} \chi_{n-1} (g_0) \chi_{n-1} (g) + c_n \chi_n (g_0) \chi_n (g) = 0. \]
    Ahora si multiplicamos (*) por $\chi_n (g_0)$ y luego restamos el resultado
    de (**), nos queda
    \[ c_1 (\chi_1 (g_0) - \chi_n (g_0)) \chi_1 (g) + \cdots +
       c_{n-1} (\chi_{n-1} (g_0) - \chi_n (g_0)) \chi_{n-1} (g) = 0. \]
    Entonces, por la hipótesis de inducción,
    $c_1 (\chi_1 (g_0) - \chi_n (g_0)) = 0$, pero dado que
    $\chi_1 (g_0) \ne \chi_n (g_0)$, tenemos que concluir que $c_1 = 0$.
    El mismo razonamiento nos dice que $c_2 = \cdots = c_{n-1} = 0$, pero luego
    también $c_n = 0$.
  \end{proof}
\end{lema}

\begin{lema}
  \label{lema:discriminante-en-terminos-de-encajes}
  Sea $K/\QQ$ un campo de números y
  $\sigma_1,\ldots,\sigma_n\colon K \hookrightarrow \CC$ sus diferentes encajes.
  Para una base $\alpha_1,\ldots,\alpha_n \in K$, el discriminante
  correspondiente del apareamiento de traza viene dado por
  $$\Delta (\alpha_1,\ldots,\alpha_n) = \det (\sigma_i (\alpha_j))_{i,j}^2.$$

  \begin{proof}
    Cálculo directo:
    \[ \langle\alpha_i,\alpha_j\rangle = T_{K/\QQ} (\alpha_i \alpha_j) =
       \sum_k \sigma_k (\alpha_i)\,\sigma_k (\alpha_j). \]
    Luego,
    \[ (\langle\alpha_i,\alpha_j\rangle)_{i,j} =
       (\sigma_i (\alpha_j))_{i,j}^t\,(\sigma_i (\alpha_j))_{i,j}. \]
    Tomando los determinantes, se obtiene
    $\Delta (\alpha_1,\ldots,\alpha_n) = \det (\sigma_i (\alpha_j))_{i,j}^2$.
  \end{proof}
\end{lema}

\begin{proposicion}
  Para un campo de números $K/\QQ$ el apareamiento de traza
  \[ \langle\cdot,\cdot\rangle\colon K\times K \to \QQ, \quad
     (\alpha,\beta) \mapsto T_{K/\QQ} (\alpha\beta) \]
  es no degenerado.

  \begin{proof}
    Si $\alpha_1,\ldots,\alpha_n$ es alguna base de $K$ sobre $\QQ$,
    sería suficiente ver que
    \[ \Delta (\alpha_1,\ldots,\alpha_n) =
       \det (\sigma_i (\alpha_j))_{i,j}^2 \ne 0. \]
    Esto es lo mismo que probar que los vectores de la matriz correspondiente
    son linealmente independientes. Lo último se sigue de la independencia
    lineal de los caracteres $\sigma_i\colon K^\times \to \CC^\times$.

    A saber, una combinación lineal no trivial de las filas de
    $(\sigma_i (\alpha_j))_{i,j}$ sería
    $$c_1 \sigma_1 (\alpha_j) + \cdots + c_n \sigma_n (\alpha_j) = 0$$
    para todo $j = 1,\ldots,n$. Por la linealidad, esto implica que
    $$c_1 \sigma_1 (\alpha) + \cdots + c_n \sigma_n (\alpha) = 0$$
    para todo $\alpha \in K^\times$, pero luego
    $c_1 = \cdots = c_n = 0$.
  \end{proof}
\end{proposicion}

\begin{teorema}
  Sea $K/\QQ$ un campo de números. Entonces, el anillo de enteros $\O_K$
  es un $\ZZ$-módulo libre de rango $n = [K : \QQ]$.

  \[ \begin{tikzcd}
    \O_K \ar[-]{d}{n} &[-3em] \subset &[-3em] K \ar[-]{d}{n} \\
    \ZZ & \subset & \QQ
  \end{tikzcd} \]

  \begin{proof}
    Sea $\alpha_1,\ldots,\alpha_n \in K$ una base de $K$ sobre $\QQ$.
    Al multiplicar los $\alpha_i$ por un entero racional $N \in \ZZ$
    suficientemente grande, podemos asumir que
    $\alpha_1,\ldots,\alpha_n \in \O_K$ (véase \ref{lema:N-alpha-esta-en-OK}).
    Dado que el apareamiento de traza $\langle\cdot,\cdot\rangle$
    es no degenerado, podemos tomar la base dual
    $\alpha_1',\ldots,\alpha_n' \in K$ tal que
    $$\langle \alpha_i, \alpha_j'\rangle = \delta_{ij}.$$
    Todo $\alpha \in \O_K$ puede ser expresado como
    $$\alpha = \sum_i a_i \alpha_i',$$
    donde $a_i \in \QQ$. En realidad, estos coeficientes son enteros:
    \[ a_i = \sum_j a_j \delta_{ij} =
       \sum_j a_j \langle\alpha_i, \alpha_j'\rangle =
       \langle\alpha_i, \sum_j a_j \alpha_j'\rangle =
       \langle\alpha_i, \alpha\rangle \in \ZZ \]
    (usando que $\alpha,\alpha_i \in \O_K$. Entonces, tenemos
    \[ \alpha_1 \ZZ \oplus \cdots \oplus \alpha_n \ZZ \subseteq \O_K \subseteq
       \alpha_1' \ZZ \oplus \cdots \oplus \alpha_n' \ZZ. \]
    Esto demuestra que $\O_K$ está entre dos $\ZZ$-módulos libres de rango $n$,
    y por lo tanto el mismo $\O_K$ es libre de rango $n$.
  \end{proof}
\end{teorema}

\begin{comentario}
  El argumento de arriba usa de manera implícita la estructura de $\ZZ$-módulos
  finitamente generados. Si tenemos una extensión de campos de números $L/K$,
  entonces $\O_K \subset \O_L$, pero $\O_L$ no tiene por qué ser un
  $\O_K$-módulo libre: esto puede fallar si $\O_K$ no es un dominio de ideales
  principales. En general, un submódulo de un módulo libre no es necesariamente
  libre.
\end{comentario}

\begin{corolario}
  El anillo de enteros $\O_K$ es el subanillo más grande de $K$ que es
  finitamente generado como $\ZZ$-módulo.

  \begin{proof}
    Ya vimos que el mismo $\O_K$ es finitamente generado. Por otra parte, si
    un subanillo $R \subset K$ es finitamente generado como $\ZZ$-módulo,
    entonces por nuestra caracterización de integridad
    (véase \ref{lema:caracterizacion-de-integralidad}), todos elementos de $R$
    son enteros sobre $\ZZ$, y luego $R \subseteq \O_K$.
  \end{proof}
\end{corolario}

Un subanillo $R \subset K$ que es finitamente generado como $\ZZ$-módulo y tiene
rango $n = [K : \QQ]$ se llama un \textbf{orden}. El anillo de enteros $\O_K$ es
entonces el \textbf{orden maximal}. La letra $\O$ viene del alemán
\emph{Ordnung}.

\vspace{1em}

Ahora sabiendo que $\O_K$ es un $\ZZ$-módulo libre, tiene sentido dar
la siguiente definición.

\begin{definicion}
  Dado un campo de números $K/\QQ$, su \textbf{discriminante} es el
  discriminante del anillo de enteros $\O_K$:
  $$\Delta_K = \Delta (\O_K).$$
\end{definicion}

\begin{ejemplo}
  Consideremos un campo cuadrático $K = \QQ (\sqrt{d})$, donde como siempre $d$
  es un entero libre de cuadrados. Si $d \equiv 2,3\pmod{4}$, entonces
  $\O_K = \ZZ [\sqrt{d}]$. Tomemos $1, \sqrt{d}$ como su base sobre
  $\ZZ$ y calculamos
  \[ \Delta (\ZZ [\sqrt{d}]) = \det \begin{pmatrix}
    T (1) & T (\sqrt{d}) \\
    T (\sqrt{d}) & T (d)
  \end{pmatrix} = \det \begin{pmatrix}
    2 & 0 \\
    0 & 2d
  \end{pmatrix} = 4d. \]

  Si $d \equiv 1 \pmod{4}$, entonces
  $\O_K = \ZZ \Bigl[\frac{1+\sqrt{d}}{2}\Bigr]$, y tomando como base
  $1$, $\frac{1+\sqrt{d}}{2}$, calculamos
  \[ T \left(\left(\frac{1+\sqrt{d}}{2}\right)\right) =
     \frac{1+\sqrt{d}}{2} + \frac{1-\sqrt{d}}{2} = 1 \]
  y
  \[ T \left(\left(\frac{1+\sqrt{d}}{2}\right)^2\right) =
     T \left(\frac{1 + 2\sqrt{d} + d}{4}\right) = \frac{1+d}{2}. \]
  Se obtiene
  \[ \Delta \Bigl(\ZZ\Bigl[\frac{1+\sqrt{d}}{2}\Bigr]\Bigr) =
  \det \begin{pmatrix}
    2 & 1 \\
    1 & \frac{1+d}{2}
  \end{pmatrix} = d. \]

  Entonces, para un campo cuadrático $K = \QQ (\sqrt{d})$ se tiene
  \[ \Delta_K = \begin{cases}
    d, & d \equiv 1 \pmod{4}, \\
    4d, & d \equiv 2,3 \pmod{4}.
  \end{cases} \qedhere \]
\end{ejemplo}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\pdfbookmark{Clase 10 (09/09/20)}{clase-10}
\section{Cálculos del discriminante y anillo de enteros}
\marginpar{\small Clase 10 \\ 09/09/20}

El discriminante puede ser calculado en términos de encajes
$\sigma_i\colon K \hookrightarrow \CC$. Ya hicimos este cálculo en
\ref{lema:discriminante-en-terminos-de-encajes}: sustituyendo la fórmula
$$T_{K/\QQ} (\alpha) = \sigma_1 (\alpha) + \cdots + \sigma_n (\alpha)$$
en la definición del discriminante, se obtiene lo siguiente.

\begin{proposicion}
  Dado un anillo de números $R \subset K$ que es un $\ZZ$-módulo de rango
  $n = [K : \QQ]$, sea $\alpha_1, \ldots, \alpha_n$ una base de $R$ sobre
  $\ZZ$. Entonces, el discriminante viene dado por
  $$\Delta (R) = \det (\sigma_i (\alpha_j))_{i,j}^2.$$
\end{proposicion}

Ahora consideremos la siguiente situación particular: dado un campo de números
$K/\QQ$, podemos escribir $K = \QQ (\alpha)$, donde $\alpha$ es un entero
algebraico (use el teorema del elemento primitivo y el hecho de que para un
número algebraico $\alpha$ existe un entero racional no nulo $N \in \ZZ$ tal que
$N\alpha$ es un entero algebraico). En este caso $R = \ZZ [\alpha]$ es un
$\ZZ$-submódulo de rango $n$ con una base $1, \alpha, \ldots, \alpha^{n-1}$.
Si $\alpha_1, \ldots, \alpha_n$ son diferentes raíces del polinomio mínimo
de $\alpha$ sobre $\QQ$, entonces $\sigma_i (\alpha) = \alpha_i$.

Tenemos
\[ \Delta (\ZZ [\alpha]) = \det (\sigma_i (\alpha_j))_{i,j}^2 =
   \det \begin{pmatrix}
     1 & \alpha_1 & \alpha_1^2 & \cdots & \alpha_1^{n-1} \\
     1 & \alpha_2 & \alpha_2^2 & \cdots & \alpha_2^{n-1} \\
     \vdots & \vdots & \vdots & \ddots & \vdots \\
     1 & \alpha_n & \alpha_n^2 & \cdots & \alpha_n^{n-1} \\
   \end{pmatrix}^2. \]
Nos salió un determinante de Vandermonde:
$$\Delta (\ZZ [\alpha]) = \prod_{1 \le i < j \le n} (\alpha_i - \alpha_j)^2.$$
Esta expresión es precisamente el discriminante del polinomio mínimo de
$\alpha$.

\begin{definicion}
  Para un polinomio mónico $f \in \QQ [x]$ con raíces complejas
  $\alpha_1, \ldots, \alpha_n$ el \textbf{discriminante} viene dado por
  $$\Delta (f) = \prod_{1 \le i < j \le n} (\alpha_i - \alpha_j)^2.$$
\end{definicion}

Entonces, hemos probado el siguiente resultado.

\begin{proposicion}
  Dado un anillo de números $\ZZ [\alpha] \subset K$ que es un $\ZZ$-módulo
  de rango $n$, se tiene
  $$\Delta (\ZZ [\alpha]) = \Delta (f^\alpha_\QQ).$$
\end{proposicion}

Aunque el discriminante de polinomio está definido en términos de sus raíces
complejas, la expresión
$$\Delta (f) = \prod_{1 \le i < j \le n} (\alpha_i - \alpha_j)^2.$$
es invariante respecto a cualquier permutación de las raíces $\alpha_i$, así que
la teoría de Galois implica que $\Delta (f) \in \QQ$. Además, los $\alpha_i$
son enteros algebraicos si $f$ es mónico, así que $\Delta (f) \in \ZZ$.
Hay una manera de calcular el discriminante usando álgebra lineal, sin calcular
las raíces de $f$. Para esto se ocupa el resultante.

\begin{definicion}
  Dados dos polinomios
  \[ f = a\,(x - \alpha_1)\cdots (x - \alpha_m), \quad
     g = b\,(x - \beta_1)\cdots (x - \beta_n), \]
  el \textbf{resultante} de $f$ y $g$ viene dado por una de las siguientes
  fórmulas equivalentes:
  \[ \Res (f,g) = a^n\,g (\alpha_1) \cdots g (\alpha_m)
      = (-1)^{mn}\,b^m\,f (\beta_1) \cdots f (\beta_n)
      = a^n b^m \prod_{\substack{1 \le i \le m \\ 1 \le j \le n}} (\alpha_i - \beta_j). \]
\end{definicion}

\begin{proposicion}
  Para un polinomio mónico
  $$f = (x - \alpha_1)\cdots (x - \alpha_n)$$
  se tiene
  $$\Delta (f) = (-1)^{\frac{n\,(n-1)}{2}} \, \Res (f,f').$$

  \begin{proof}
    Si $f$ tiene raíces múltiples, entonces $\Delta (f) = \Res (f,f') = 0$
    (note que si $\alpha_i$ es una raíz múltiple, entonces esta es también una
    raíz de $f'$). Supongamos que las raíces de $f$ son distintas. Tenemos
    $$f' (x) = \sum_{1 \le i \le n} \prod_{j\ne i} (x - \alpha_j),$$
    y luego
    $$f' (\alpha_i) = \prod_{j \ne i} (\alpha_i - \alpha_j).$$
    Ahora por la definición,
    \[ \Res (f,f') = f' (\alpha_1) \cdots f' (\alpha_n) =
       \prod_i \prod_{j \ne i} (\alpha_i - \alpha_j) =
       (-1)^{n \choose 2} \prod_{1 \le i < j \le n} (\alpha_i - \alpha_j)^2 =
       (-1)^{\frac{n\,(n-1)}{2}} \Delta (f). \qedhere \]
  \end{proof}
\end{proposicion}

\begin{corolario}
  Para $K = \QQ (\alpha)$, donde $\alpha$ es un entero algebraico y
  $f \in \ZZ [x]$ es el polinomio mínimo de $\alpha$ se tiene
  \[ \Delta (\ZZ [\alpha]) = \Delta (f)
     = (-1)^{\frac{n\,(n-1)}{2}}\,N_{K/\QQ} (f' (\alpha)). \]

  \begin{proof}
    Tenemos
    $$\Res (f,f') = f' (\alpha_1) \cdots f' (\alpha_n),$$
    donde $\alpha_1,\ldots,\alpha_n$ son las raíces de $f$. En términos de
    encajes $\sigma_i\colon K\hookrightarrow \CC$, tenemos
    $\alpha_i = \sigma_i (\alpha)$. Dado que $f \in \ZZ [x]$, tenemos
    $f' \in \ZZ [x]$, y luego $f' (\sigma_i (\alpha)) = \sigma_i (f' (\alpha))$.
    Entonces,
    \[ \Res (f,f') = \sigma_1 (f' (\alpha)) \cdots \sigma_n (f' (\alpha)) =
       N_{K/\QQ} (f' (\alpha)). \qedhere \]
  \end{proof}
\end{corolario}

\begin{ejemplo}
  \label{ejemplo:discriminante-de-Q-zeta-p}
  Consideremos el campo ciclotómico $K = \QQ (\zeta_p)$, donde $p$ es un primo
  impar. En este caso $\O_K = \ZZ [\zeta_p]$. El discriminante entonces viene
  dado por
  $$\Delta_K = (-1)^{{n \choose 2}}\,N_{K/\QQ} (\Phi_p' (\zeta_p)).$$
  Aquí $n = p-1$, pero ${n \choose 2} \equiv \frac{p-1}{2} \pmod{2}$.
  Escribamos
  $$x^p - 1 = (x-1)\,\Phi_p (x),$$
  y entonces
  $$p\,x^{p-1} = \Phi_p (x) + (x-1)\,\Phi_p' (x).$$
  Sustituyendo $x = \zeta_p$, se obtiene
  $$p\,\zeta_p^{p-1} = (\zeta_p - 1)\,\Phi_p' (\zeta_p).$$
  Ahora
  \[ N_{K/\QQ} (\Phi_p' (\zeta_p)) =
     \frac{p^{p-1} \, N_{K/\QQ} (\zeta_p)^{p-1}}{N_{K/\QQ} (\zeta_p - 1)}. \]
  Aquí $\zeta_p \in \O_K^\times$, y por lo tanto
  $N_{K/\QQ} (\zeta_p)^{p-1} = (\pm 1)^{p-1} = 1$
  (de hecho, la norma de $\zeta_p$ es igual a 1), y se ve que
  $$N_{K/\QQ} (\zeta_p - 1) = \Phi_p (1) = p.$$
  Entonces,
  \[ \Delta_K = (-1)^{\frac{p-1}{2}} \, p^{p-2}. \qedhere \]
\end{ejemplo}

El resultante puede ser calculado de la siguiente manera.

\begin{proposicion}
  \label{prop:determinante-de-sylvester}
  Dados dos polinomios
  \[ f = a_m x^m + \cdots + a_1 x + a_0, \quad
     g = b_n x^n + \cdots + b_1 x + b_0, \]
  el resultante $\Res (f,g)$ es igual al determinante de la siguiente matriz
  de $(n+m) \times (n+m)$:
  \[ \begin{pmatrix}
    a_m & a_{m-1} & a_{m-2} & \cdots & a_1 & a_0 & 0 & 0 & \cdots & 0 \\
    0 & a_m & a_{m-1} & a_{m-2} & \cdots & a_1 & a_0 & 0 & \cdots & 0 \\
    0 & 0 & a_m & a_{m-1} & a_{m-2} & \cdots & a_1 & a_0 & \cdots & 0 \\
    \vdots & \vdots & \ddots & \ddots & \ddots & \ddots & \ddots & \ddots & \ddots & \vdots \\
    0 & 0 & \cdots & 0 & a_m & a_{m-1} & a_{m-2} & \cdots & a_1 & a_0 \\
    b_n & b_{n-1} & \cdots & b_2 & b_1 & b_0 & 0 & 0 & \cdots & 0 \\
    0 & b_n & b_{n-1} & \cdots & b_2 & b_1 & b_0 & 0 & \cdots & 0 \\
    0 & 0 & b_n & b_{n-1} & \cdots & b_2 & b_1 & b_0 & \cdots & 0 \\
    \vdots & \vdots & \ddots & \ddots & \ddots & \ddots & \ddots & \ddots & \ddots & \vdots \\
    0 & 0 & \cdots & 0 & b_n & b_{n-1} & \cdots & b_2 & b_1 & b_0 \\
  \end{pmatrix} \]
  (esta se conoce como la \textbf{matriz de Sylvester}). Aquí los coeficientes
  de $f$ se repiten en $n = \deg (g)$ filas y los coeficientes de $g$
  se repiten en $m = \deg (f)$ filas.
\end{proposicion}

A continuación no vamos a usar esta interpretación del resultante y la menciono
solo para ser completo: a veces esto aparece como la definición del resultante.
Para una prueba, véase por ejemplo \cite[\S 3.3]{Cohen-GTM138}.

\begin{ejemplo}
  Para el polinomio $f = x^2 + bx + c$ tenemos $f' = 2x + b$, y luego
  \[ \Delta (f) = -\det \begin{pmatrix}
    1 & b & c \\
    2 & b & 0 \\
    0 & 2 & b
  \end{pmatrix} = b^2 - 4c. \]
  Para el polinomio cúbico $f = x^3 + ax + b$ tenemos $f' = 3x^2 + a$ y
  \[ \Delta (f) = -\det \begin{pmatrix}
    1 & 0 & a & b & 0 \\
    0 & 1 & 0 & a & b \\
    3 & 0 & a & 0 & 0 \\
    0 & 3 & 0 & a & 0 \\
    0 & 0 & 3 & 0 & a
  \end{pmatrix} = \cdots = - (4a^3 + 27b^2). \qedhere \]
\end{ejemplo}

\begin{ejemplo}
  Si $d$ es un entero libre de cuadrados, entonces
  $$\Delta (\ZZ [\sqrt{d}]) = \Delta (x^2 - d) = 4d.$$
  Si $d \equiv 1 \pmod{4}$, entonces
  \[ \Delta \Bigl(\ZZ \Bigl[\frac{1 + \sqrt{d}}{2}\Bigr]\Bigr)
   = \Delta \Bigl(x^2 - x - \frac{d-1}{4}\Bigr) = d. \qedhere \]
\end{ejemplo}

En PARI/GP, la función \texttt{poldisc($f$)} calcula el discriminante de $f$,
y \texttt{polresultant($f$,$g$)} calcula el resultante.

\vspace{1em}

Como un caso particular de \ref{prop:discriminantes-e-indice} tenemos
el siguiente resultado.

\begin{proposicion}
  \label{prop:discriminante-de-Z-alpha-en-OK}
  Sea $K/\QQ$ un campo de números y $\alpha \in \O_K$ un entero algebraico de
  grado $n = [K : \QQ]$. Entonces,
  \[ \Delta (\ZZ [\alpha]) = \Delta (f^\alpha_\QQ) =
     [\O_K : \ZZ [\alpha]]^2 \cdot \Delta_K. \]
\end{proposicion}

\begin{ejemplo}
  Si $d$ es un entero libre de cuadrados tal que $d \equiv 1 \pmod{4}$,
  consideremos el campo cuadrático $K = \QQ (\sqrt{d})$. En este caso
  $$\O_K = \ZZ \Bigl[\frac{1+\sqrt{d}}{2}\Bigr].$$
  Notamos que
  $$\ZZ [\sqrt{d}] = \ZZ \oplus 2\cdot \frac{1+\sqrt{d}}{2}\ZZ,$$
  así que
  $$[\O_K : \ZZ [\sqrt{d}]] = 2.$$
  Tenemos
  \[ \underbrace{\Delta (\ZZ [\sqrt{d}])}_{= 4d} =
  \Bigl[\ZZ \Bigl[\frac{1+\sqrt{d}}{2}\Bigr] : \ZZ [\sqrt{d}] \Bigr]^2 \cdot
  \underbrace{\Delta_K}_{=d}. \qedhere \]
\end{ejemplo}

La fórmula de \ref{prop:discriminante-de-Z-alpha-en-OK} ayuda a calcular
el anillo de enteros en ciertos casos.

\begin{ejemplo}
  Consideremos el campo de números $K = \QQ (\alpha)$, donde $\alpha$
  es el entero algebraico tal que $\alpha^3 + \alpha - 1 = 0$. Calculamos
  $$\Delta (\ZZ [\alpha]) = \Delta (x^3 + x - 1) = -31.$$
  Tenemos
  $$\Delta (\ZZ [\alpha]) = [\O_K : \ZZ [\alpha]] \cdot \Delta_K,$$
  pero $-31$ es libre de cuadrados, y entonces $\O_K = \ZZ [\alpha]$.
\end{ejemplo}

\begin{ejemplo}
  Calculamos que
  $$\Delta (x^2 - x + 6) = \Delta (x^3 - x + 1) = -23.$$
  Este número es libre de cuadrados, así que para los campos
  $$K = \QQ [\alpha]/(\alpha^2 - \alpha + 6) \cong \QQ (\sqrt{-23})$$
  y
  $$K' = \QQ [\beta]/(\beta^3 - \beta + 1)$$
  tenemos
  \[ \O_K = \ZZ [\alpha], \quad \O_{K'} = \ZZ [\beta]. \qedhere \]
\end{ejemplo}

\begin{comentario}
  El último ejemplo también demuestra que el discriminante de dos campos
  de números no isomorfos puede coincidir. Obviamente, si $K \cong K'$, entonces
  $\O_K \cong \O_{K'}$, y luego $\Delta_K = \Delta_{K'}$.
  Sin embargo, muy a menudo sucede que $\Delta_K = \Delta_{K'}$, pero
  $K \not\cong K'$. El discriminante no es un invariante muy fino, pero este
  ayuda a enumerar los campos de números: más adelante veremos que hay solamente
  un número finito de campos de números (salvo isomorfismo) tales que
  $|\Delta_K| < C$ para alguna constante $C$.
\end{comentario}

\begin{ejemplo}[Dedekind]
  Consideremos el campo de números $K = \QQ (\alpha)$, donde
  \[ \tag{*} \alpha^3 + \alpha^2 - 2\alpha + 8 = 0. \]
  Calculamos (con ayuda de computadora) que
  $$\Delta (\ZZ [\alpha]) = \Delta (x^3 + x^2 - 2x + 8) = -2^2 \cdot 503.$$
  Aquí el número $503$ es primo. Entonces, hay dos posibilidades: o tenemos
  $\O_K = \ZZ [\alpha]$, o $[\O_K : \ZZ [\alpha]] = 2$.
  En realidad, estamos en el segundo caso.

  Primero, multiplicando (*) por $(2/\alpha)^3$, se obtiene
  $$\frac{64}{\alpha^3} - \frac{16}{\alpha^2} + \frac{8}{\alpha} + 8 = 0.$$
  Esto significa que
  $$\beta = \frac{4}{\alpha} = -\frac{1}{2} \alpha^2 - \frac{1}{2} \alpha + 1$$
  es un entero algebraico. Sin embargo, $\beta \notin \ZZ [\alpha]$. Esto
  demuestra que $\O_K \ne \ZZ [\alpha]$, pero luego tenemos
  \[ \begin{tikzcd}
    \O_K \ar[-]{d}\ar[-,bend left=45]{dd}{2} \\
    \ZZ [\alpha,\beta] \ar[-]{d}{> 1} \\
    \ZZ [\alpha]
  \end{tikzcd} \]
  y entonces
  $$\O_K = \ZZ [\alpha,\beta] = \ZZ \oplus \alpha\ZZ \oplus \beta\ZZ.$$
  En efecto, $\alpha\beta = 4$, y se calcula que
  $$\alpha^2 = 2 - \alpha - 2\beta, \quad \beta^2 = -2 - 2\alpha + \beta.$$
  Dejo al lector confirmar que
  $$\Delta (\ZZ [\alpha,\beta]) = -503.$$

  De hecho, se puede ver que $\O_K$ no es de la forma $\ZZ [\gamma]$ para ningún
  entero algebraico $\gamma$. Primero, se puede ver (con ayuda de PARI/GP)
  que en $\O_K = \ZZ [\alpha,\beta]$ se tiene factorización en ideales primos
  $$2\O_K = \mathfrak{p}_1 \, \mathfrak{p}_2 \, \mathfrak{p}_3,$$
  donde
  \[ \mathfrak{p}_1 = (2 - \alpha - \beta), \quad
     \mathfrak{p}_2 = (5 - 3\alpha - 2\beta), \quad
     \mathfrak{p}_3 = (7 - 4\alpha - 3\beta). \]
  Ahora supongamos que $\O_K = \ZZ [\gamma] = \ZZ [x] / (f)$ para algún
  polinomio mónico irreducible $f$ de grado $3$. El~teorema de Kummer--Dedekind
  (\ref{teorema:kummer-dedekind}) nos dice que para factorizar $2\O_K$ en
  ideales primos, hay que factorizar el polinomio $f$ en $\FF_2 [x]$. Los
  polinomios irreducibles en $\FF_2 [x]$ son los siguientes:
  \begin{align*}
    \deg = 1\colon & x, ~ x+1, \\
    \deg = 2\colon & x^2 + x + 1, \\
    \deg = 3\colon & x^2 + x + 1, ~ x^3 + x^2 + 1.
  \end{align*}
  Esto significa que $f$ no puede ser expresado como producto de tres diferentes
  polinomios irreducibles. En términos de factorización del ideal $2\O_K$, esto
  excluye la factorización de la forma
  $2\O_K = \mathfrak{p}_1 \, \mathfrak{p}_2 \, \mathfrak{p}_3$.
\end{ejemplo}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\pdfbookmark{Clase 11 (14/09/20)}{clase-11}
\marginpar{\small Clase 11 \\ 14/09/20}
En general, para encontrar el anillo de enteros $\O_K$, puede servir
la siguiente observación.

\begin{proposicion}
  \label{prop:OK-y-orden-no-maximal}
  Para un campo de números $K/\QQ$, sea $R \subset K$ un $\ZZ$-submódulo libre
  de rango $n = [K : \QQ]$. Luego, se tiene
  \[ R \subseteq \O_K \subseteq \frac{1}{d}\,R,
     \quad\text{donde }d = \Delta (R). \]

  \begin{proof}
    Sea $\beta_1, \ldots, \beta_n \in R$ una base de $R$ sobre $\ZZ$.
    Expresamos un elemento arbitrario $\alpha \in \O_K$ como
    $$\alpha = x_1 \beta_1 + \cdots + x_n \beta_n,$$
    donde $x_i \in \QQ$. Aplicamos a esta expresión los encajes
    $$\sigma_1, \ldots, \sigma_n\colon K \hookrightarrow \CC.$$
    Se obtiene un sistema de ecuaciones lineales
    \begin{align*}
      \sigma_1 (\alpha) & =
      x_1 \sigma_1 (\beta_1) + \cdots + x_n \sigma_1 (\beta_n), \\
      & \cdots \\
      \sigma_n (\alpha) & =
      x_1 \sigma_n (\beta_1) + \cdots + x_n \sigma_n (\beta_n).
    \end{align*}
    Podemos expresar los $x_i$ usando la \textbf{regla de Cramer}:
    $$x_i = \frac{\gamma_i}{\delta},$$
    donde
    \[ \delta = \det \begin{pmatrix}
      \sigma_1 (\beta_1) & \cdots & \sigma_1 (\beta_n) \\
      \vdots & \ddots & \vdots \\
      \sigma_n (\beta_1) & \cdots & \sigma_n (\beta_n)
    \end{pmatrix}, \]
    y $\gamma_i$ es el determinante de la misma matriz, donde en lugar de
    la $i$-ésima columna está
    $(\sigma_1 (\alpha), \ldots, \sigma_n (\alpha))^t$.

    Como ya sabemos, $d = \Delta (R) = \delta^2$. Entonces, podemos escribir
    $x_i = \frac{\gamma_i \delta}{d}$. Aquí $\gamma_i \delta = d x_i \in \QQ$,
    pero al mismo tiempo $\gamma_i \delta$ es un entero algebraico, así que
    $\gamma_i \delta \in \ZZ$. Entonces, hemos probado que
    \[ \alpha \in
       \frac{\beta_1}{d}\ZZ \oplus \cdots \oplus \frac{\beta_n}{d}\ZZ
       = \frac{1}{d} R. \qedhere \]
  \end{proof}
\end{proposicion}

\begin{comentario}
  He aquí algunas observaciones al respecto.

  \begin{enumerate}
  \item Dado que $R \subseteq \O_K$, toda clase lateral en $\frac{1}{d}R/R$
    consiste en enteros algebraicos o no contiene ningún entero algebraico.

  \item Tenemos $d = [\O_K : R]^2\cdot \Delta_K$, así que para ver cuáles
    elementos de $\O_K$ no están en $R$, es suficiente considerar las clases
    laterales en $\frac{1}{m}R/R$, donde $m^2 \mid d$.

  \item Se tiene $[\frac{1}{m}R : R] = m^n$, y por lo tanto este método es útil
    solo cuando el discriminante es relativamente pequeño.
  \end{enumerate}

  La proposición de arriba solo nos dice que $\O_K$ es calculable; en realidad
  para calcular $\O_K$ se usan métodos más sofisticados. Véase por ejemplo
  \cite[\S 6.1]{Cohen-GTM138}. También recomiendo el artículo panorámico
  de Lenstra \cite{Lenstra-1992}.
\end{comentario}

\begin{ejemplo}
  \label{ejemplo:raiz-cubica-de-19}
  Consideremos el campo cúbico $K = \QQ (\sqrt[3]{19})$. Primero para
  $\alpha = \sqrt[3]{19}$ calculamos
  \[ \Delta (\ZZ [\alpha]) = \Delta (x^3 - 19)
     = -27\cdot 19^2 = -3^3\cdot 19^2. \]
  Entonces,
  $$[\O_K : \ZZ [\alpha]] = m = 1, 3, 19, 3\cdot 19.$$
  Vamos a ver si algunos elementos de la forma
  $$\frac{a}{m} + \frac{b}{m}\alpha + \frac{c}{m}\alpha^2,$$
  donde $0 \le a,b,c < m$ son enteros algebraicos.

\begin{shaded}
\begin{verbatim}
polisintegral (f) = denominator(content(f)) == 1;

test (m) = {
  for (a=0,m-1,
    for (b=0,m-1,
      for (c=0,m-1,
        local (elt = (a + b*x + c*x^2)/m);
        if (polisintegral (minpoly (Mod(elt, x^3 - 19))),
          print (elt)
        )
      )
    )
  )
};

? test(3)
0
1/3*x^2 + 1/3*x + 1/3
2/3*x^2 + 2/3*x + 2/3

? test(19)
0

? test(3*19)
0
1/3*x^2 + 1/3*x + 1/3
2/3*x^2 + 2/3*x + 2/3
\end{verbatim}
\end{shaded}
  Los únicos elementos integrales que nos salieron son
  $$\beta = \frac{1}{3} (1 + \alpha + \alpha^2), \quad 2\beta,$$
  y luego $\O_K = \ZZ [\alpha,\beta]$. Tenemos entonces
  \[ [\O_K : \ZZ [\alpha]] = 3, \quad \Delta_K = -3\cdot 19^2. \qedhere \]
\end{ejemplo}

Este ejemplo solamente demuestra el procedimiento general. En realidad, si $d$
es libre de cuadrados, no es difícil probar que para $K = \QQ (\sqrt[3]{d})$ se
tiene $\O_K \subseteq \frac{1}{3}\ZZ [\sqrt[3]{d}]$. Véase el ejercicio
\ref{ejerc:anillo-de-enteros-cubico}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Versión más general de Kummer--Dedekind}

Hemos visto en \S\ref{sec:kummer-dedekind} que para un anillo
$R = \ZZ [\alpha] \cong \ZZ[x]/(f)$, donde $\alpha$ es un entero algebraico,
la factorización de un ideal $p R$ en ideales primos corresponde
a la factorización del polinomio $f$ en $\FF_p [x]$:
\[ p R = \mathfrak{p}_1^{e_1} \cdots \mathfrak{p}_s^{e_s}
   \longleftrightarrow
   \overline{f} = \overline{g}_1^{e_1} \cdots \overline{g}_s^{e_s}
   \text{ en }\FF_p [x]. \]
Pero esto funciona solamente cuando los ideales $\mathfrak{p}_i$ son
invertibles. En particular, esto funciona si $\ZZ [\alpha] = \O_K$ es el anillo
de enteros de $K = \QQ (\alpha)$. ¿Qué hacer si $\O_K$ no es de la forma
$\ZZ [\alpha]$?

Resulta que los primos problemáticos son solamente los que dividen al índice
$[\O_K : \ZZ [\alpha]]$.

\begin{proposicion}
  Sea $K$ un campo de números tal que $K = \QQ (\alpha)$, donde $\alpha$ es un
  entero algebraico. Para un primo racional $p$ tal que
  $p \nmid [\O_K : \ZZ [\alpha]]$ el homomorfismo natural
  $$\ZZ [\alpha]/(p) \to \O_K/(p)$$
  inducido por la inclusión $\ZZ [\alpha] \subseteq \O_K$ es un isomorfismo.

  \begin{proof}
    Pongamos $m = [\O_K : \ZZ [\alpha]]$ y consideremos el siguiente diagrama:
    \[ \begin{tikzcd}
      m \O_K \ar[hookrightarrow]{r}\ar[->>]{d} & \ZZ [\alpha]\ar[->>]{d} \ar[hookrightarrow]{r} & \O_K\ar[->>]{d} \\
      m \O_K/(p) \ar{r} & \ZZ [\alpha]/(p) \ar{r} & \O_K/(p)
    \end{tikzcd} \]
    Aquí el homomorfismo $m \O_K/(p) \to \O_K/(p)$ es sobreyectivo: por nuestra
    hipótesis $m$ es invertible módulo $p$: tenemos $m m' \equiv 1 \pmod{p}$
    para algún $m'$. Luego, dado $x + (p) \in \O_K/(p)$, podemos escribirlo
    como
    $$x + (p) = x m m' + (p) \in m\O_K/(p).$$
    Entonces, $\ZZ [\alpha]/(p) \to \O_K/(p)$ es un homomorfismo sobreyectivo.
    Pero $\ZZ [\alpha]$ y $\O_K$ son $\ZZ$-módulos libres de rango
    $n = [K:\QQ]$, así que
    $$\# (\ZZ [\alpha]/(p)) = \# (\O_K/(p)) = p^n,$$
    y se trata de un isomorfismo.
  \end{proof}
\end{proposicion}

\begin{ejemplo}
  \label{ejemplo:raiz-cubica-de-19-factorizacion}
  Volvamos al ejemplo \ref{ejemplo:raiz-cubica-de-19}.
  Consideremos el campo $K = \QQ (\sqrt[3]{19})$. Tenemos
  \[ \O_K = \ZZ [\alpha,\beta], \quad
     \alpha = \sqrt[3]{19}, \quad
     \beta = \frac{1}{3} (\alpha^2 + \alpha + 1). \]
  Hemos calculado que
  \[ \Delta_K = - 3\cdot 19^2, \quad
     \Delta (\ZZ [\alpha]) = - 3^3\cdot 19^2. \]
  El polinomio mínimo de $\beta$ viene dado por
  $$x^3 - x^2 - 6x - 12,$$
  de donde se calcula
  \[ \Delta (\ZZ [\beta]) = - 2^2 \cdot 3 \cdot 19^2. \]

  \begin{shaded}
\begin{verbatim}
? minpoly (Mod(1/3*(x^2+x+1), x^3-19))
% = x^3 - x^2 - 6*x - 12
? poldisc(%)
% = -4332
? factor(%)
% =
[-1 1]

[ 2 2]

[ 3 1]

[19 2]
\end{verbatim}
\end{shaded}

  Tenemos entonces
  $$[\O_K : \ZZ [\alpha]] = 3, \quad [\O_K : \ZZ [\beta]] = 2.$$
  Esto significa que para factorizar $3\O_K$, podemos ocupar el anillo
  $\ZZ [\beta]$. Se tiene
  $$x^3 - x^2 - 6x - 12 = x^2\,(x - 1) \quad\text{en }\FF_3[x].$$

  Para cualquier otro primo racional $p \ne 3$, podemos ocupar el anillo
  $\ZZ [\alpha]$; es decir, factorizar el polinomio $f = x^3 - 19$.
  Por ejemplo,
  $$\overline{f} = (x+1)\,(x^2 + x + 1) \quad\text{en }\FF_2[x].$$
  He aquí algunas observaciones.

  \begin{itemize}
  \item Si $p = 19$, entonces $\overline{f} = x^3$. Supongamos ahora que
    $p \ne 19$.

  \item Si $p \equiv 2 \pmod{3}$, entonces $x \mapsto x^3$ es un automorfismo de
    $\FF_p^\times$, así que existe único $x \in \FF_p$ tal que $x^3 = 19$. Esto
    significa que $\overline{f}$ tiene un factor lineal y otro cuadrático.

  \item Si $p \equiv 1 \pmod{3}$, entonces $\FF_p^\times$ contiene un elemento
    $\zeta \ne 1$ tal que $\zeta^3 = 1$. Hay dos posibilidades: o $19$ no es un
    cubo módulo $p$, y en este caso $f$ es irreducible, o
    $19 \equiv a^3 \pmod{p}$, y luego
    $$\overline{f} = (x - a)\,(x - \zeta a)\,(x - \zeta^2 a).$$
  \end{itemize}

  Entonces, la factorización de primos racionales en $\O_K$ es la siguiente

  \begin{itemize}
  \item $3\O_K = \mathfrak{p}_1^2 \, \mathfrak{p}_2$, donde $f_1 = f_2 = 1$.

  \item $19\O_K = \mathfrak{p}^3$, donde $\mathfrak{p} = \sqrt[3]{19}\O_K$ y
    $f = 1$.

  \item Si $p \equiv 2 \pmod{3}$, entonces
    $p\O_K = \mathfrak{p}_1 \, \mathfrak{p}_2$, donde $f_1 = 1$, $f_2 = 2$.

  \item Si $p \ne 19$ y $p \equiv 1 \pmod{3}$, entonces hay dos opciones.

    Si $19$ no es un cubo módulo $p$, entonces $\mathfrak{p} = p\O_K$ es un
    ideal primo.

    Si $19$ es un cubo módulo $p$, entonces
    $p\O_K = \mathfrak{p}_1 \, \mathfrak{p}_2 \, \mathfrak{p}_3$, donde
    $f_1 = f_2 = f_3 = 1$.
  \end{itemize}

  Para ver de manera eficaz si $19$ es un cubo módulo $p \equiv 1 \pmod{3}$,
  podemos factorizar $p = \pi \overline{\pi}$ en $\ZZ [\zeta_3]$.
  Aquí $\ZZ [\zeta_3]/(\pi) \cong \FF_p$, así que la respuesta depende del
  símbolo de Legendre $\legendre{19}{\pi}_3$ que puede ser calculado usando
  la reciprocidad cúbica. Notamos que $19 = \rho\,\overline{\rho}$ en
  $\ZZ [\zeta_3]$, donde $\rho = 3\zeta_3 + 5$ y
  $\overline{\rho} = -3\zeta_3 + 2$.
\end{ejemplo}

\begin{figure}
\begin{center}
\renewcommand{\arraystretch}{1.5}
\begin{tabular}{x{1.25cm}x{1.25cm}x{1.25cm}x{1.25cm}x{1.25cm}x{1.25cm}x{1.25cm}x{1.25cm}}
$p$ & $p\O_K$ & $f$ & $p~(3)$ & $p$ & $p\O_K$ & $f$ & $p~(3)$ \tabularnewline
\hline
$2$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $(1,2)$ & $2$ & $127$ & $\mathfrak{p}_1\,\mathfrak{p}_2\,\mathfrak{p}_3$ & $(1,1,1)$ & $1$ \tabularnewline
\hline
$3$ & $\mathfrak{p}_1\,\mathfrak{p}_2^2$ & $(1,1)$ & $0$ & $131$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $(1,2)$ & $2$ \tabularnewline
\hline
$5$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $(1,2)$ & $2$ & $137$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $(1,2)$ & $2$ \tabularnewline
\hline
$7$ & $\mathfrak{p}$ & $3$ & $1$ & $139$ & $\mathfrak{p}$ & $3$ & $1$ \tabularnewline
\hline
$11$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $(1,2)$ & $2$ & $149$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $(1,2)$ & $2$ \tabularnewline
\hline
$13$ & $\mathfrak{p}$ & $3$ & $1$ & $151$ & $\mathfrak{p}_1\,\mathfrak{p}_2\,\mathfrak{p}_3$ & $(1,1,1)$ & $1$ \tabularnewline
\hline
$17$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $(1,2)$ & $2$ & $157$ & $\mathfrak{p}$ & $3$ & $1$ \tabularnewline
\hline
$19$ & $\mathfrak{p}^3$ & $1$ & $1$ & $163$ & $\mathfrak{p}$ & $3$ & $1$ \tabularnewline
\hline
$23$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $(1,2)$ & $2$ & $167$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $(1,2)$ & $2$ \tabularnewline
\hline
$29$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $(1,2)$ & $2$ & $173$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $(1,2)$ & $2$ \tabularnewline
\hline
$31$ & $\mathfrak{p}$ & $3$ & $1$ & $179$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $(1,2)$ & $2$ \tabularnewline
\hline
$37$ & $\mathfrak{p}$ & $3$ & $1$ & $181$ & $\mathfrak{p}_1\,\mathfrak{p}_2\,\mathfrak{p}_3$ & $(1,1,1)$ & $1$ \tabularnewline
\hline
$41$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $(1,2)$ & $2$ & $191$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $(1,2)$ & $2$ \tabularnewline
\hline
$43$ & $\mathfrak{p}$ & $3$ & $1$ & $193$ & $\mathfrak{p}$ & $3$ & $1$ \tabularnewline
\hline
$47$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $(1,2)$ & $2$ & $197$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $(1,2)$ & $2$ \tabularnewline
\hline
$53$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $(1,2)$ & $2$ & $199$ & $\mathfrak{p}$ & $3$ & $1$ \tabularnewline
\hline
$59$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $(1,2)$ & $2$ & $211$ & $\mathfrak{p}$ & $3$ & $1$ \tabularnewline
\hline
$61$ & $\mathfrak{p}$ & $3$ & $1$ & $223$ & $\mathfrak{p}$ & $3$ & $1$ \tabularnewline
\hline
$67$ & $\mathfrak{p}$ & $3$ & $1$ & $227$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $(1,2)$ & $2$ \tabularnewline
\hline
$71$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $(1,2)$ & $2$ & $229$ & $\mathfrak{p}$ & $3$ & $1$ \tabularnewline
\hline
$73$ & $\mathfrak{p}$ & $3$ & $1$ & $233$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $(1,2)$ & $2$ \tabularnewline
\hline
$79$ & $\mathfrak{p}$ & $3$ & $1$ & $239$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $(1,2)$ & $2$ \tabularnewline
\hline
$83$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $(1,2)$ & $2$ & $241$ & $\mathfrak{p}$ & $3$ & $1$ \tabularnewline
\hline
$89$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $(1,2)$ & $2$ & $251$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $(1,2)$ & $2$ \tabularnewline
\hline
$97$ & $\mathfrak{p}_1\,\mathfrak{p}_2\,\mathfrak{p}_3$ & $(1,1,1)$ & $1$ & $257$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $(1,2)$ & $2$ \tabularnewline
\hline
$101$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $(1,2)$ & $2$ & $263$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $(1,2)$ & $2$ \tabularnewline
\hline
$103$ & $\mathfrak{p}$ & $3$ & $1$ & $269$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $(1,2)$ & $2$ \tabularnewline
\hline
$107$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $(1,2)$ & $2$ & $271$ & $\mathfrak{p}_1\,\mathfrak{p}_2\,\mathfrak{p}_3$ & $(1,1,1)$ & $1$ \tabularnewline
\hline
$109$ & $\mathfrak{p}_1\,\mathfrak{p}_2\,\mathfrak{p}_3$ & $(1,1,1)$ & $1$ & $277$ & $\mathfrak{p}_1\,\mathfrak{p}_2\,\mathfrak{p}_3$ & $(1,1,1)$ & $1$ \tabularnewline
\hline
$113$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $(1,2)$ & $2$ & $281$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $(1,2)$ & $2$ \tabularnewline
\hline
\end{tabular}
\end{center}

\caption{Factorización de $p\O_K$ para $K = \QQ (\sqrt[3]{19})$}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Ramificación}

\begin{definicion}
  Sea $K/\QQ$ un campo de números. Para un primo racional $p\in\ZZ$ consideremos
  su factorización en ideales primos en $\O_K$:
  $$p\O_K = \mathfrak{p}_1^{e_1} \cdots \mathfrak{p}_s^{e_s},$$
  donde $e_i \ge 1$. En este caso
  $\O_K/\mathfrak{p}_i \cong \FF_{p^{f_i}}$, y los números $f_i$ se llaman los
  \textbf{grados de campos residuales}. Los números $e_i$ se llaman
  los \textbf{índices de ramificación}. Si $e_i > 1$ para algún $i$,
  se dice que $p$ \textbf{se ramifica} en $K$.
\end{definicion}

\begin{teorema}
  \label{teorema:ei-fi}
  En la situación de arriba se tiene
  $$\sum_i e_i f_i = [K : \QQ].$$
\end{teorema}

Antes de probar este resultado, sería oportuno introducir las normas de ideales.

\begin{definicion}
  Sea $K$ un campo de números. Para un ideal no nulo $I \subset \O_K$
  su \textbf{norma} se define mediante
  $$N_{K/\QQ} (I) = \# (\O_K / I).$$
  Para el ideal nulo, se puede poner $N_{K/\QQ} (I) = 0$.
\end{definicion}

\begin{lema}
  \begin{enumerate}
  \item[1)] La norma es multiplicativa:
  $$N_{K/\QQ} (IJ) = N_{K/\QQ} (I)\,N_{K/\QQ} (J).$$

  \item[2)] La norma de un ideal principal es el valor absoluto de la norma
  habitual de su generador:
  $$N_{K/\QQ} (\alpha \O_K) = |N_{K/\QQ} (\alpha)|.$$
  \end{enumerate}

  \begin{proof}
    Todo ideal no nulo en $\O_K$ se descompone de manera única en ideales
    primos, así que para la parte 1) basta ver que
    \[ N (\mathfrak{p}_1^{e_1}\cdots\mathfrak{p}_s^{e_s}) =
       N (\mathfrak{p}_1)^{e_1}\cdots N (\mathfrak{p}_s)^{e_s}. \]
    Primero, por el teorema chino del resto se tiene
    \[ N (\mathfrak{p}_1^{e_1}\cdots\mathfrak{p}_s^{e_s}) =
       N (\mathfrak{p}_1^{e_1})\cdots N (\mathfrak{p}_s^{e_s}). \]
    Luego, hemos visto en \ref{lema:R/(p-e)} que para cualquier anillo de
    números $R$ y un ideal primo invertible $\mathfrak{p} \subset R$ se cumple
    $$N (\mathfrak{p}^e) = N (\mathfrak{p})^e,$$
    y en $\O_K$ todo ideal no nulo es invertible. Esto establece la parte 1).

    Para la parte 2), notamos que $\alpha \O_K$ es la imagen de la aplicación
    $\ZZ$-lineal de multiplicación por $\alpha$:
    $$\mu_\alpha\colon \O_K \to \O_K, \quad x \mapsto \alpha x.$$
    Entonces, como fue observado en
    \ref{lema:indice-de-Z-submodulo-como-determinante}, se tiene
    $$[\O_K : \alpha\O_K] = |\det (\mu_\alpha)|.$$
    Por la definición,
    \[ \det (\mu_\alpha)
       = N_{\O_K/\ZZ} (\alpha) = N_{K/\QQ} (\alpha). \qedhere \]
  \end{proof}
\end{lema}

\begin{ejemplo}
  Consideremos el anillo $\ZZ [i]$. Para $\alpha = a + bi \in \ZZ[i]$ no es
  difícil ver que el ideal generado por $\alpha$ está generado como $\ZZ$-módulo
  por $a + bi$ y $a - bi$:
  \[ \alpha\ZZ[i] = \{ (c+di)\,(a+bi) \mid c,d \in \ZZ \} =
                    \{ c\cdot(a+bi) + d\cdot(-b + ai) \mid c,d\in \ZZ \}. \]
  Ahora el número de elementos en el cociente de $\ZZ^2$ por el $\ZZ$-submódulo
  generado por $(a,b)$ y $(-b,a)$ viene dado por
  \[ \det \begin{pmatrix}
    a & -b \\
    b & a
  \end{pmatrix} = a^2 + b^2 = N (a + bi). \qedhere \]
\end{ejemplo}

\begin{proof}[Demostración de \label{ref:ei-fi}]
  Sacando las normas, tenemos
  $$N (p\O_K) = N (\mathfrak{p}_1)^{e_1} \cdots N (\mathfrak{p}_s)^{e_s},$$
  donde $N (p\O_K) = |N_{K/\QQ} (p)| = p^n$ y $N (\mathfrak{p}_i) = p^{f_i}$.
\end{proof}

Más adelante veremos que si $K/\QQ$ es una extensión de Galois, entonces
$f_1 = \cdots = f_s$ y $e_1 = \cdots = e_s$.

\subsection{Discriminante y ramificación}

Ahora sea $\alpha$ un entero algebraico y $f \in \ZZ [x]$ su polinomio mínimo.
Ahora si para un primo racional $p$ se tiene
$$p \mid \Delta (f) = \prod_{1 \le i \le n} (\alpha_i - \alpha_j)^2,$$
esto significa que el polinomio $\overline{f} \in \FF_p [x]$ tiene una raíz
múltiple en $\overline{\FF}_p$, y por lo tanto un factor múltiple módulo $p$:
\[ \overline{f} = \overline{g}_1^{e_1} \cdots \overline{g}_s^{e_s}
   \quad \text{en }\FF_p[x], \]
donde $e_i > 1$ para algún $i$. En vista del teorema de Kummer--Dedekind,
estas consideraciones sugieren el siguiente resultado.

\begin{teorema}
  \label{thm:discriminante-y-ramificacion}
  Para un campo de números $K/\QQ$, un primo racional $p$ se ramifica en $K$
  si solamente si $p \mid \Delta_K$.
\end{teorema}

Sin embargo, no todos los anillos de enteros tienen forma $\ZZ [\alpha]$, así
que necesitamos trabajar más para la prueba. Primero vamos a formular algunos
lemas sobre discriminantes de álgebras sobre campos. En este caso el
discriminante depende de una base particular, pero por abuso de lenguaje
hablaremos \emph{del} discriminante, porque al final nos interesará solo si este
es nulo o no.

\begin{lema}
  Se tiene
  $$\Delta_K \operatorname{\text{mód}} p = \Delta (\O_K/(p)/\FF_p),$$
  donde a la derecha está el discriminante de la $\FF_p$-álgebra $\O_K/(p)$.

  \begin{proof}
    La reducción módulo $p$ nos da una $\FF_p$-álgebra
    ${\O_K/(p) \cong \O_K \otimes_\ZZ \FF_p}$. Los determinantes y trazas
    conmutan con productos tensoriales, y en particular, el siguiente diagrama
    conmuta:
    \[ \begin{tikzcd}
      \O_K \ar[->>]{r}\ar[shift right=0.25em]{d}[swap]{N}\ar[shift left=0.25em]{d}{T} & \O_K/(p) \ar[shift right=0.25em]{d}[swap]{N}\ar[shift left=0.25em]{d}{T} \\
      \ZZ \ar[->>]{r} & \FF_p
    \end{tikzcd} \]
    Ahora si $\alpha_1, \ldots, \alpha_n$ es una base de $\O_K$ sobre $\ZZ$,
    entonces $\overline{\alpha_1}, \ldots, \overline{\alpha_n}$ es una base de
    $\O_K/(p)$ sobre $\FF_p$. Tenemos
    $$\Delta_K = \det (T_{\O_K/\ZZ} (\alpha_i \alpha_j)),$$
    y la reducción módulo $p$ nos da
    \[ \overline{\Delta_K} =
       \det (T_{\O_K/(p)/\FF_p} (\overline{\alpha_i} \overline{\alpha_j})). \]
    Lo que está a la derecha, es el discriminante de $\O_K/(p)$ respecto
    a la base particular $\overline{\alpha_1}, \ldots, \overline{\alpha_n}$.
  \end{proof}
\end{lema}

\begin{lema}
  Para un campo $k$, sean $A$ y $B$ dos $k$-álgebras de dimensión finita. Luego,
  para el producto de $A$ y $B$ se tiene
  $$\Delta (A\times B/k) = \Delta (A/k) \times \Delta (B/k).$$

  \begin{proof}
    Si $a_1,\ldots,a_m$ es una base de $A$ sobre $k$ y $b_1,\ldots,b_n$ es una
    base de $B$ sobre $k$, entonces
    $$(a_1, 0), \ldots, (a_m, 0), \quad (0, b_1), \ldots, (0, b_n)$$
    es una base de $A\times B$. Ahora el discriminante de $A\times B$
    respecto a esta base es
    \[ \det \begin{pmatrix}
      (T (a_i a_j))_{i,j} & O \\
      O & (T (b_k b_\ell))_{k, \ell}
    \end{pmatrix} = \Delta (A/k) \times \Delta (B/k). \qedhere \]
  \end{proof}
\end{lema}

\begin{lema}
  Para un ideal primo $\mathfrak{p} \subset \O_K$ se tiene
  $\Delta (\O_K/\mathfrak{p}^e/\FF_p) = 0$ si y solamente si $e > 1$.

  \begin{proof}
    Denotemos $A = \O_K/\mathfrak{p}^e$.
    Si $e = 1$, entonces $A \cong \FF_{p^f}$ es una extensión finita de
    $\FF_p$. Estas extensiones son separables y tienen forma $\FF_p [x]/(g)$,
    donde $f$ es un polinomio irreducible, y sus raíces $\alpha_i$ en la
    cerradura algebraica $\overline{\FF_p}$ son distintas:
    $$g = (x - \alpha_1) \cdots (x - \alpha_f), \quad \alpha_i \ne \alpha_j.$$
    Los cálculos parecidos a los que vimos arriba\footnote{
      Tal vez tenía que formular algunos lemas en la generalidad adecuada,
      para extensiones separables de campos\dots} nos dicen que
    \[ \Delta (A/\FF_p) = \Delta (g) =
       \prod_{i < j} (\alpha_i - \alpha_j)^2 \ne 0. \]

    Supongamos ahora que $e > 1$. Podemos escoger una base de $A$ que contiene
    un elemento representado por
    $\alpha \in \mathfrak{p}\setminus\mathfrak{p}^2$. En este caso
    $\overline{\alpha} \ne 0$, pero $\overline{\alpha}^n = 0$, así que tenemos
    un nilpotente. Para cualquier otro elemento $\overline{\beta} \in A$,
    se obtiene un operador lineal nilpotente
    $\mu_{\overline{\alpha\beta}}\colon A\to A$, y su traza es nula\footnote{
      Ejercicio: para un operador lineal nilpotente $f\colon V\to V$ todos los
      valores propios en $\overline{\FF_p}$ son nulos.}. Entonces,
    $T_{A/\FF_p} (\overline{\alpha\beta}) = 0$ para todo
    $\overline{\beta} \in A$, así que $\Delta (A/\FF_p) = 0$.
  \end{proof}
\end{lema}

\begin{proof}[Demostración del teorema \ref{thm:discriminante-y-ramificacion}]
  Consideremos la factorización
  $$p\O_K = \mathfrak{p}_1^{e_1} \cdots \mathfrak{p}_s^{e_s}.$$
  Ocupando el teorema chino del resto, se obtiene un isomorfismo de
  $\FF_p$-álgebras
  \[ \O_K/(p) \cong
     \O_K/\mathfrak{p}_1^{e_1}\times\cdots\times\O_K/\mathfrak{p}_s^{e_s}. \]
  Gracias a los lemas de arriba,
  \[ \Delta_K \operatorname{\text{mód}} p =
     \prod_i \Delta (\O_K/\mathfrak{p}_i^{e_i}/\FF_p), \]
  y el producto es nulo si y solamente si $e_i > 1$ para algún $i$.
\end{proof}

\begin{corolario}
  Para un campo de números $K/\QQ$ hay solamente un número finito de primos
  $p \in \ZZ$ que se ramifican en $K$.
\end{corolario}

Más adelante también veremos que para toda extensión no trivial $K/\QQ$ se tiene
$|\Delta_K| > 1$, así que algún primo siempre se ramifica.

\begin{ejemplo}
  Consideremos un campo cuadrático $K = \QQ (\sqrt{d})$, donde $d$ es libre de
  cuadrados. Los primos impares que se ramifican en $K$ son precisamente
  $p \mid d$. Además, si $d \equiv 2,3\pmod{4}$, entonces $2$ también se
  ramifica. Si $d \equiv 1\pmod{4}$, entonces $2$ no se ramifica. Toda está
  información está contenida en el discriminante
  \[ \Delta_K = \begin{cases}
    d, & d \equiv 1 \pmod{4}, \\
    4d, & d \equiv 2,3 \pmod{4}.
  \end{cases} \qedhere \]
\end{ejemplo}

\begin{ejemplo}
  Para el campo ciclotómico $K = \QQ (\zeta_p)$ el único primo que se ramifica
  es el mismo $p$ (véase \ref{prop:factorizacion-en-Q-zeta-p}). Por otra parte,
  calculamos en \ref{ejemplo:discriminante-de-Q-zeta-p} que el discriminante
  es igual a
  $$\Delta_K = (-1)^{\frac{p-1}{2}}\,p^{p-2}.$$
  Este es un número bastante grande, pero su único divisor primo es $p$.
\end{ejemplo}

\begin{ejemplo}
  Como vimos en \ref{ejemplo:raiz-cubica-de-19-factorizacion}, para el campo
  $K = \QQ (\sqrt[3]{19})$ tenemos $\Delta_K = -3\cdot 19^2$, y los únicos
  primos que se ramifican en $K$ son $3$ y $19$.
\end{ejemplo}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\pdfbookmark{Clase 12 (21/09/20)}{clase-12}
\section{Teoremas de Brill y Stickelberger}
\marginpar{\small Clase 12 \\ 21/09/20}

Hemos explicado el significado de los divisores primos del discriminante
$\Delta_K$. El discriminante también tiene signo, y no es difícil entender su
significado. Será oportuno primero dar una definición.

\begin{definicion}
  Para un campo de números $K/\QQ$, consideremos sus encajes
  $$\sigma_1, \ldots, \sigma_n\colon K \hookrightarrow \QQ.$$
  Si $\sigma_i (K) \subset \RR$, se dice que $\sigma_i$ es un encaje
  \textbf{real}. En el caso contrario, se dice que $\sigma_i$ es un encaje
  \textbf{complejo}. Notamos que para cada encaje complejo $\sigma_i$
  su conjugado $\overline{\sigma_i} \ne \sigma_i$ es también un encaje.
  Entonces, tenemos
  $$r_1 + 2 r_2 = n = [K : \QQ],$$
  donde $r_1$ es el número de encajes reales y $2 r_2$ es el número de encajes
  complejos. Se dice que $(r_1, r_2)$ es la \textbf{signatura} de $K$.
\end{definicion}

En términos sencillos, si $K = \QQ (\alpha)$ y $f = f^\alpha_\QQ$ es
el polinomio mínimo de $\alpha$, entonces $r_1$ es el número de raíces reales
de $f$, mientras que $2 r_2$ es el número de sus raíces complejas.

\begin{proposicion}[Brill\footnote{Alexander von Brill (1842--1935)}]
  El signo de $\Delta_K$ es $(-1)^{r_2}$.

  \begin{proof}
    Escribamos $K = \QQ (\alpha)$, donde $\alpha$ es un entero algebraico,
    $f \in \ZZ [x]$ su polinomio mínimo y $\alpha_i$ las raíces complejas
    de $f$. Tenemos
    $$\Delta (\ZZ [\alpha]) = [\O_K : \ZZ [\alpha]]^2 \cdot \Delta_K,$$
    así que el signo de $\Delta_K$ coincide con el signo de
    \[ \Delta (\ZZ [\alpha]) = \Delta (f) =
       \prod_{1 \le i < j \le n} (\alpha_i - \alpha_j)^2, \]
    Dejo como un ejercicio verificar que el signo de la última expresión será
    precisamente $(-1)^{r_2}$, donde $2 r_2$ es el número de raíces complejas.
  \end{proof}
\end{proposicion}

\begin{ejemplo}
  He aquí una pequeña lista de campos con sus signaturas y discriminantes.

  \renewcommand{\arraystretch}{1.5}
  \begin{center}
    \begin{tabular}{cx{2cm}x{2cm}x{3cm}}
      \hline
      $K$ & $r_1$ & $r_2$ & $\Delta_K$ \tabularnewline
      \hline
      \begin{tabular}{@{}c@{}}$\QQ (\sqrt{d})$ \\ {\small donde $d > 1$}\end{tabular} & $2$ & $0$ & $d$\quad o\quad $4d$ \tabularnewline
      \hline
      \begin{tabular}{@{}c@{}}$\QQ (\sqrt{d})$ \\ {\small donde $d < 0$}\end{tabular} & $0$ & $1$ & $d$\quad o\quad $4d$ \tabularnewline
      \hline
      $\QQ (\sqrt[3]{2})$ & $1$ & $1$ & $-2^2\cdot 3^3$ \tabularnewline
      \hline
      \begin{tabular}{@{}c@{}}$\QQ (\alpha)$ \\ {\small donde $\alpha^3 - 3\alpha + 1 = 0$}\end{tabular} & $3$ & $0$ & $+3^4$ \tabularnewline
      \hline
      $\QQ (\zeta_p)$ & $0$ & $(p-1)/2$ & $(-1)^{\frac{p-1}{2}}\,p^{p-2}$ \tabularnewline
      \hline
    \end{tabular}
  \end{center}
  \renewcommand{\arraystretch}{1}

  En el caso de $f (x) = x^3 - 3x + 1$, notamos que el polinomio tiene tres
  raíces reales:
  \[ f (-2) = -1, \quad
     f (-1) = 3, \quad
     f (1) = -1, \quad
     f (2) = 3. \]

  \begin{center}
    \includegraphics{pic/x3-3x+1.pdf}
  \end{center}

  Cabe mencionar que para encontrar el número de raíces reales de
  $f^\alpha_\QQ$, y como consecuencia la signatura de $K = \QQ (\alpha)$, no hay
  que calcular las mismas raíces; se puede usar algo como la
  \textbf{regla de los signos de Descartes}.
\end{ejemplo}

El siguiente resultado también nos dice cuál es el resto de $\Delta_K$ módulo
$4$.

\begin{proposicion}[Stickelberger\footnote{Ludwig Stickelberger (1850--1936)}]
  Se tiene $\Delta_K \equiv 0 \text{ o }1 \pmod{4}$.

  \begin{proof}
    Si $\alpha_1, \ldots, \alpha_n$ es una base de $\O_K$ sobre $\ZZ$
    y $\sigma_1, \ldots, \sigma_n\colon K \hookrightarrow \CC$ son los encajes,
    entonces
    $$\Delta_K = \det (\sigma_i (\alpha_j))^2.$$
    Escribamos
    \[ \det (\sigma_i (\alpha_j)) =
       \sum_{\rho \in S_n} \sgn (\rho)\cdot\sigma_{\rho (1)} (\alpha_1)\cdots
                                         \sigma_{\rho (n)} (\alpha_n). \]
    Denotemos por $P$ los términos con $\sgn (\rho) = +1$
    y por $N$ los términos con $\sgn (\rho) = -1$. Ahora
    $$\Delta_K = (P-N)^2 = (P+N)^2 - 4PN.$$
    Notamos que las expresiones $P+N$ y $PN$ son invariantes respecto a
    cualquier permutación de raíces, así que la teoría de Galois implica que son
    números racionales. Además, son enteros algebraicos, y por lo tanto
    $P+N, PN \in \ZZ$. Entonces, $\Delta_K$ es un cuadrado módulo $4$.
  \end{proof}
\end{proposicion}

\begin{ejemplo}
  Consideremos un campo cuadrático $K = \QQ (\sqrt{d})$ donde $d$ es libre de
  cuadrados. Tomamos $\ZZ [\sqrt{d}] = \ZZ \oplus \sqrt{d}\ZZ$ y calculamos
  $$\Delta (\ZZ [\sqrt{d}]) = 4d = [\O_K : \ZZ [\sqrt{d}]]^2 \cdot \Delta_K.$$
  Dado que $d$ es libre de cuadrados, hay solo dos opciones:
  $\Delta_K = d$ o $4d$. Si $d \equiv 2,3 \pmod{4}$, entonces
  Stickelberger nos dice que necesariamente $\Delta_K = 4d$, y luego
  $\O_K = \ZZ [\sqrt{d}]$.

  Si $d \equiv 1 \pmod{4}$, entonces Stickelberger no nos ayuda, pero basta
  calcular que $\frac{1 + \sqrt{d}}{2}$ es entero y luego
  \[ \Delta (\ZZ \Bigl[\frac{1+\sqrt{d}}{2}\Bigr]) = d
     = [\O_K : \ZZ [\sqrt{d}]]^2 \cdot \Delta_K, \]
  de donde $\O_K = \ZZ [\sqrt{d}]$, dado que $d$ es libre de cuadrados.
\end{ejemplo}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Campos linealmente disjuntos}

Nuestro próximo objetivo será, como fue prometido, calcular que el anillo de
enteros del $n$-ésimo campo ciclotómico $\QQ (\zeta_n)$ es
$\ZZ [\zeta_n]$. Primero, tenemos que hacer una digresión sobre campos
linealmente disjuntos.

\begin{definicion}
  Para dos extensiones finitas $K/\QQ$ y $K'/\QQ$ adentro de un campo común
  (por ejemplo, adentro de una cerradura algebraica fija $\overline{\QQ}$),
  el subcampo más pequeño que contiene a $K$ y $K'$ se llama el
  \textbf{compositum}\footnote{En español a veces se usa el término
    \textbf{compuesto}, pero voy a decir ``compositum''; estrictamente hablando,
    es una palabra latín.} de $K$ y $K'$ y se denota por $K K'$.
  \[ \begin{tikzcd}[row sep=1em,column sep=1em]
    & \overline{\QQ}\ar[-]{d} \\
    & KK'\ar[-]{dl}\ar[-]{dr} \\
    K\ar[-]{dr} & & K'\ar[-]{dl} \\
    & \QQ
  \end{tikzcd} \]

  Se dice que $K$ y $K'$ son \textbf{linealmente disjuntos} si se cumple una
  de las siguientes condiciones equivalentes:
  \begin{enumerate}
  \item[a)] el homomorfismo de $k$-álgebras
    $$K\otimes_\QQ K'\to K K', \quad x\otimes y \mapsto xy$$
    es inyectivo;

  \item[b)] si $\alpha_1, \ldots, \alpha_n$ es una base de $K$ sobre $\QQ$, esta
    es linealmente independiente sobre $K'$;

  \item[c)] si $\alpha_i$ y $\alpha'_j$ son bases de $K$ y $K'$ respectivamente,
    entonces $\alpha_i \alpha'_j$ es una base de $K K'$;

  \item[d)] $[KK' : \QQ] = [K : \QQ]\cdot [K' : \QQ]$.
  \end{enumerate}
\end{definicion}

Para más detalles, véase por ejemplo \cite[Chapter~V, \S~20]{Morandi-GTM167}.

\begin{comentario}
  Un criterio útil para ver si dos campos son linealmente disjuntos es
  el siguiente: si $K/\QQ$ y $K'/\QQ$ son extensiones finitas de Galois y
  $K \cap K' = \QQ$, entonces $K$ y $K'$ son linealmente disjuntos.
  Esto se sigue del \textbf{teorema de irracionalidades naturales}
  (véase \cite[Chapter~I, Theorem~5.5]{Morandi-GTM167}).
\end{comentario}

Para calcular el anillo de enteros del compositum de campos, ocuparemos
el siguiente resultado.

\begin{proposicion}
  \label{prop:OK-del-compositum}
  Sean $K$ y $K'$ dos campos de números linealmente disjuntos y sean
  \[ \O_K = \alpha_1 \ZZ \oplus \cdots \oplus \alpha_n \ZZ, \quad
     \O_{K'} = \alpha_1' \ZZ \oplus \cdots \oplus \alpha_{n'}' \ZZ \]
  bases de sus anillos de enteros. Supongamos que los discriminantes $\Delta_K$
  y $\Delta_{K'}$ son coprimos. Entonces, $\alpha_i \alpha_j'$ es una
  $\ZZ$-base de $KK'$ y
  $$\Delta_{KK'} = \Delta_K^{[K' : \QQ]} \cdot \Delta_{K'}^{[K : \QQ]}.$$

  \begin{proof}
    Pongamos $n = [K : \QQ]$ y $n' = [K' : \QQ]$.
    Bajo nuestra hipótesis, $[KK' : \QQ] = nn'$, y los elementos
    $\alpha_i \alpha_j'$ forman una base del compositum $KK'$ sobre $\QQ$.
    \[ \begin{tikzcd}[row sep=1em,column sep=1em]
      & KK'\ar[-]{dl}[swap]{n'} \ar[-]{dr}{n} \\
      K\ar[-]{dr}[swap]{n} & & K'\ar[-]{dl}{n'} \\
      & \QQ
    \end{tikzcd} \]

    Dado un elemento $\alpha \in \O_{KK'}$, escribamos
    $$\alpha = \sum_{i,j} a_{ij} \alpha_i \alpha_j',$$
    donde $a_{ij} \in \QQ$. Vamos a ver que en realidad $a_{ij} \in \ZZ$.
    Pongamos
    $$\beta_j = \sum_i a_{ij} \alpha_i.$$

    Para calcular los discriminantes, consideremos los encajes
    \[ \sigma_1, \ldots, \sigma_n\colon K \hookrightarrow \CC, \quad
       \sigma'_1, \ldots, \sigma'_{n'}\colon K' \hookrightarrow \CC. \]
    Denotemos por brevedad $d = \Delta_K$ y $d' = \Delta_{K'}$.
    Recordemos que
    \[ d = \det (X)^2, ~ d' = \det (Y)^2,
       \quad \text{donde }
       X = (\sigma_i (\alpha_j)), ~
       Y = (\sigma'_k (\alpha'_\ell)). \]

    Escribamos
    \[ \vec{a} = (\sigma_1' (\alpha), \ldots, \sigma_{n'}')^t, \quad
       \vec{b} = (\beta_1, \ldots, \beta_{n'})^t. \]
    Se tiene
    $$\vec{a} = Y \vec{b}.$$
    Ahora si $Y^*$ es la matriz adjunta (compuesta por menores), entonces
    $$Y\,Y^* = Y^*\,Y = \det (Y)\,I_{n'}.$$
    Entonces,
    $$\det (Y)\,\vec{b} = Y^*\,\vec{a}.$$
    Dado que las matrices $Y$ y $Y^*$ y el vector $\vec{a}$ tienen entradas
    enteras sobre $\ZZ$, podemos concluir que
    $$d' \beta_j = \sum_i d' a_{ij} \alpha_i \in \O_K,$$
    y luego $d' a_{ij} \in \ZZ$. El argumento simétrico (intercambiando
    $\alpha_i$ con $\alpha_j'$) demuestra que $d a_{ij} \in \ZZ$. Pero
    $d$ y $d'$ son coprimos, así que $a_{ij} \in \ZZ$. Esto
    demuestra que $\alpha_i \alpha_j'$ es una $\ZZ$-base de $\O_{K K'}$.

    Bajo nuestra hipótesis de que los campos $K$ y $K'$ son linealmente disjuntos,
    los encajes del compositum $K K'$ vienen dados por
    \[ \sigma_k \sigma'_\ell\colon K K' \hookrightarrow \CC, \quad
       1 \le k \le n, ~ 1 \le \ell \le n', \]
    y luego se puede ver que $\Delta_{K K'}$ es el discriminante de la matriz
    de $nn'\times nn'$ que consiste en bloques
    \[ \begin{pmatrix}
      \sigma_1 (\alpha_1) Y & \cdots & \sigma_1 (\alpha_n) Y \\
      \vdots & \ddots & \vdots \\
      \sigma_n (\alpha_1) Y & \cdots & \sigma_n (\alpha_n) Y
    \end{pmatrix}, \quad
    Y = \begin{pmatrix}
      \sigma'_1 (\alpha'_1) & \cdots & \sigma'_1 (\alpha'_{n'}) \\
      \vdots & \ddots & \vdots \\
      \sigma'_{n'} (\alpha'_1) & \cdots & \sigma'_{n'} (\alpha'_{n'})
    \end{pmatrix}. \]
    Este es precisamente el \textbf{producto de Kronecker} $X\otimes Y$,
    y su determinante viene dado por
    $$\det (X\otimes Y) = \det (X)^{n'} \cdot \det (Y)^n$$
    (ejercicio \ref{ejerc:producto-de-kronecker}). Entonces,
    \[ \Delta_{K K'} = \det (X \otimes Y)^2
       = \det (X)^{2n'} \cdot \det (Y)^{2n} = d^{n'}\cdot d'^n. \qedhere \]
  \end{proof}
\end{proposicion}

\begin{ejemplo}
  Los campos $K = \QQ (\sqrt{3})$ y $K' = \QQ (\sqrt{5})$ son linealmente
  disjuntos. Su compositum es $K K' = \QQ (\sqrt{3},\sqrt{5})$. Ahora
  $\Delta_K = 12$ y $\Delta_{K'} = 5$, así que la proposición de arriba nos dice
  que
  \[ \O_{K K'} =
     \ZZ \oplus \sqrt{3} \ZZ \oplus \frac{1+\sqrt{5}}{2} \ZZ \oplus \frac{\sqrt{3}+\sqrt{15}}{2} \ZZ =
     \ZZ \Bigl[\sqrt{3}, \frac{1 + \sqrt{5}}{2}\Bigr] \]
  y
  $$\Delta_{K K'} = \Delta_K^2\cdot \Delta_{K'}^2 = 2^4\cdot 3^2\cdot 5^2.$$
  Solo para ilustrar la segunda parte del argumento de arriba, tenemos
  \[ \Delta_K = \det \begin{pmatrix}
    1 & +\sqrt{3} \\
    1 & -\sqrt{3}
    \end{pmatrix}^2, \quad \Delta_{K'} = \det \begin{pmatrix}
    1 & (1+\sqrt{5})/2 \\
    1 & (1-\sqrt{5})/2
    \end{pmatrix}^2, \]
  y luego
  \[ \Delta_{K K'} = \det \begin{pmatrix}
    1 & +\sqrt{3} & (1+\sqrt{5})/2 & (+\sqrt{3}+\sqrt{15})/2 \\
    1 & -\sqrt{3} & (1+\sqrt{5})/2 & (-\sqrt{3}-\sqrt{15})/2 \\
    1 & +\sqrt{3} & (1-\sqrt{5})/2 & (+\sqrt{3}-\sqrt{15})/2 \\
    1 & -\sqrt{3} & (1-\sqrt{5})/2 & (-\sqrt{3}+\sqrt{15})/2 \\
  \end{pmatrix}^2 = \det \left(\begin{pmatrix}
    1 & +\sqrt{3} \\
    1 & -\sqrt{3}
  \end{pmatrix}\otimes \begin{pmatrix}
    1 & (1+\sqrt{5})/2 \\
    1 & (1-\sqrt{5})/2
  \end{pmatrix}\right)^2. \qedhere \]
\end{ejemplo}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Anillo de enteros de \texorpdfstring{$\QQ (\zeta_n)$}{ℚ(ζₙ)}}

Para el $n$-ésimo campo ciclotómico $\QQ (\zeta_n)$ podemos factorizar
$n = p_1^{e_1} \cdots p_s^{e_s}$,
y en este caso
$\QQ (\zeta_n) = \QQ (\zeta_{p_1^{e_1}}) \cdots \QQ (\zeta_{p_s^{e_s}})$,
donde los campos $\QQ (\zeta_{p_i^{e_i}})$ son linealmente disjuntos. De esta
manera vamos a calcular el anillo de enteros de $\QQ (\zeta_n)$ mediante
la proposición \label{prop:OK-del-compositum}, por inducción sobre el número de
divisores primos de $n$. Primero necesitamos calcular el anillo de enteros de
$\QQ (\zeta_{p^e})$ y ver que los discriminantes son coprimos para diferentes
$p$.

\begin{lema}
  Consideremos el campo ciclotómico $K = \QQ (\zeta_{p^e})$.

  \begin{enumerate}
  \item[1)] Se tiene
    \[ \Delta (\ZZ [\zeta_{p^e}]) = \pm\,p^s,
       \quad \text{donde } s = p^{e-1}\,(pe - e - 1). \]

  \item[2)] El ideal principal $\mathfrak{p} = (1 - \zeta_{p^e}) \O_K$ es primo
    y se tiene $p \O_K = \mathfrak{p}^{\phi (p^e)}$ y
    $\O_K/\mathfrak{p} \cong \FF_p$.
  \end{enumerate}
\end{lema}

Note que si $e = 1$, ya sabemos que $\Delta_K = \pm\,p^{p-2}$. El signo del
discriminante no nos interesará porque este se determina fácilmente por
el teorema de Brill.

\begin{proof}
  El cálculo del discriminante en la parte 1) es muy similar al que hicimos en
  \ref{ejemplo:discriminante-de-Q-zeta-p} para el caso de $e = 1$, y lo dejo
  como un ejercicio para el lector.

  Pongamos por brevedad $\zeta = \zeta_{p^e}$. Notamos que
  $$\Phi_{p^e} (1) = \prod_{(k, p^e) = 1} (1 - \zeta^k) = p.$$
  Aquí $1 - \zeta^k = \frac{1 - \zeta^k}{1-\zeta}\,(1-\zeta)$, donde
  \[ N_{K/\QQ} \left(\frac{1 - \zeta^k}{1-\zeta}\right) =
     \frac{N_{K/\QQ} (1-\zeta^k)}{N_{K/\QQ} (1-\zeta)} = \pm 1, \]
  así que $1 - \zeta^k = \epsilon_k \, (1 - \zeta)$, donde
  $\epsilon_k \in \O_K^\times$ es una unidad. Entonces, tenemos
  $(1 - \zeta)^{\phi (p^e)} = \epsilon p$, donde $\epsilon \in \O_K^\times$.
  De aquí se sigue que $p \O_K = \mathfrak{p}^{\phi (p^e)}$, donde
  $\mathfrak{p} = (1 - \zeta) \O_K$.
  Ahora tomando las normas de ideales,
  \[ N_{K/\QQ} (\mathfrak{p})^{\phi (p^e)} =
     N_{K/\QQ} (\mathfrak{p}^{\phi (p^e)}) =
     N_{K/\QQ} (p \O_K) = p^{\phi (p^e)}, \]
  así que $N_{K/\QQ} (\mathfrak{p}) = p$, lo que implica que
  $\O_K/\mathfrak{p} \cong \FF_p$.
\end{proof}

\begin{proposicion}
  Para el campo ciclotómico $K = \QQ (\zeta_{p^e})$ se tiene
  $\O_K = \ZZ [\zeta_{p^e}]$.

  \begin{proof}
    Primero, si $d = \Delta (\ZZ [\zeta_{p^e}]) = \pm p^s$, entonces según
    \ref{prop:OK-y-orden-no-maximal} se tiene
    $$\ZZ [\zeta_{p^e}] \subseteq \O_K \subseteq \frac{1}{d} \ZZ [\zeta_{p^e}],$$
    lo que podemos escribir también como
    $$p^s \O_K \subseteq \ZZ [\zeta_{p^e}] \subseteq \O_K.$$
    Pongamos $\mathfrak{p} = (1 - \zeta_{p^e})\O_K$. El lema anterior nos dice
    que $\O_K/\mathfrak{p} \cong \ZZ/p\ZZ$, así que
    $\O_K = \ZZ + \mathfrak{p}$, y luego
    \[ \tag{*} \O_K = \ZZ [\zeta_{p^e}] + \mathfrak{p}. \]
    Multiplicando esta identidad por $\mathfrak{p}$, se obtiene
    $$\mathfrak{p} = \mathfrak{p}\ZZ [\zeta_{p^e}] + \mathfrak{p}^2.$$
    Al sustituirlo a (*), tenemos
    $$\O_K = \ZZ [\zeta_{p^e}] + \mathfrak{p}^2.$$
    Procediendo de esta manera, tenemos
    $$\O_K = \ZZ [\zeta_{p^e}] + \mathfrak{p}^t\quad\text{para todo }t \ge 1.$$
    Ahora si $t = s \, \phi (p^e)$, entonces por el lema anterior,
    $$\mathfrak{p}^t = (\mathfrak{p}^{\phi (p^e)})^s = p^s \O_K.$$
    Pero $p^s \O_K \subseteq \ZZ [\zeta_{p^e}]$, así que
    podemos concluir que $\O_K = \ZZ [\zeta_{p^e}]$.
  \end{proof}
\end{proposicion}

\begin{teorema}
  Para el campo ciclotómico $K = \QQ (\zeta_n)$ se tiene $\O_K = \ZZ [\zeta_n]$
  y
  $$\Delta_K = (-1)^{\phi(n)/2}\,\frac{n^{\phi (n)}}{\prod_{p\mid n} p^{\phi (n)/(p-1)}}.$$

  \begin{proof}
    Inducción sobre el número de divisores primos de $n$. Acabamos de probar
    el caso cuando $n = p^e$. La fórmula del discriminante es también correcta:
    calculamos que en este caso
    $$\Delta = \pm p^s, \quad s = p^{e-1}\,(pe - e - 1).$$

    Ahora para el paso inductivo, si $n = p_1^{e_1}\cdots p_s^{e_s}$,
    consideremos los campos
    \[ K_1 = \QQ (\zeta_{p_1^{e_1}}), ~
       K_2 = \QQ (\zeta_{p_2^{e_2}}), \ldots,
       K_s = \QQ (\zeta_{p_s^{e_s}}). \]
    Tenemos
    $$\QQ (\zeta_n) = K_1\cdots K_s.$$
    Los campos $K_1\cdots K_{s-1}$ y $K_s$ son linealmente disjuntos y tienen
    discriminantes coprimos, así que se aplica la proposición
    \ref{prop:OK-del-compositum}. Por la hipótesis de inducción, tenemos
    $$\O_{K_1\cdots K_{s-1}} = \ZZ [\zeta_{p_1^{e_1}}\cdots \zeta_{p_{s-1}^{e_{s-1}}}].$$
    Luego, la proposición \ref{prop:OK-del-compositum} nos dice que
    \[ \O_{K_1\cdots K_s} =
       \ZZ [\zeta_{p_1^{e_1}}\cdots \zeta_{p_{s-1}^{e_{s-1}}}] \cdot \ZZ [\zeta_{p_s^{e_s}}] =
       \ZZ [\zeta_n]. \]
    El discriminante se calcula mediante
    \[ \Delta_{K_1\cdots K_s} =
       \Delta_{K_1\cdots K_{s-1}}^{[K_s : \QQ]} \cdot \Delta_{K_s}^{[K_1\cdots K_{s-1}:\QQ]}, \]
    y se ve que se obtiene la fórmula enunciada. El signo del discriminante
    viene dado por el teorema de Brill.
  \end{proof}
\end{teorema}

\begin{ejemplo}
  Consideremos el campo ciclotómico $K = \QQ (\zeta_{20})$. Tenemos
  $K = K_1 K_2$, donde $K_1 = \QQ (\zeta_4) = \QQ (i)$ y $K_2 = \QQ (\zeta_5)$.
  El teorema nos dice que $K = \ZZ [\zeta_{20}]$. Calculamos
  $\phi (20) = \phi (4) \, \phi (5) = 8$. Una posible base de $\O_K$ es
  \[ 1, \zeta_{20}, \zeta_{20}^2, \zeta_{20}^3,
     \zeta_{20}^4, \zeta_{20}^5, \zeta_{20}^6, \zeta_{20}^7, \]
  pero también podríamos tomar el producto de las bases $\{ 1, i \}$ y
  $\{ 1, \zeta_5, \zeta_5^2, \zeta_5^3, \zeta_5^4 \}$.
  El discriminante viene dado por
  \[ \Delta_K = \Delta_{K_1}^4 \cdot \Delta_{K_2}^2 = 2^8\cdot 5^6. \qedhere \]
\end{ejemplo}

\vspace{1em}

\pdfbookmark{Clase 13 (23/09/20)}{clase-13}
\marginpar{\small Clase 13 \\ 23/09/20}

Ahora, dado que nos salió $\O_K = \ZZ [\zeta_n]$, no podemos resistir
la tentación de aplicar el Kummer--Dedekind para factorizar $p \O_K$.
Para esto tenemos que factorizar el $n$-ésimo polinomio ciclotómico
$\Phi_n (x) \in \ZZ [x]$ módulo diferentes primos $p$.

\begin{lema}
  Factoricemos $n = \prod_p p^{v_p}$. Para un número primo $p$, sea $f$
  el orden de $p$ módulo $n/p^{v_p}$, i.e. el número más pequeño tal que
  $p^f \equiv 1 \pmod{n/p^{v_p}}$.
  Luego, se tiene
  \[ \overline{\Phi_n} (x) = (\overline{g_1} \cdots \overline{g_s})^{\phi (p^{v_p})}
     \quad\text{en } \FF_p [x], \]
  donde $\overline{g_1},\ldots,\overline{g_s} \in \FF_p [x]$ son distintos
  polinomios irreducibles de grado $f$.

  \begin{proof}
    Ya hemos visto algo parecido para el caso de $n$ primo
    (véase \ref{lema:factorizacion-de-Phi-p-mod-q}), y esta es una
    generalización.

    Primero supongamos que $p \nmid n$, así que $v_p = 0$. En este caso
    $f = x^n - 1$ es un polinomio separable en $\FF_p [x]$, como demuestra
    el cálculo de $\gcd (f,f') = 1$. Por nuestra elección, $f$ es el número
    más pequeño tal que el grupo multiplicativo $\FF_{p^f}^\times$ contiene
    elementos de orden $n$, así que $\FF_{p^f}$ es precisamente el campo de
    descomposición del polinomio $\overline{\Phi_n} \in \FF_p [x]$.
    La factorización en polinomios irreducibles será
    $$\overline{\Phi_n} = \overline{g_1} \cdots \overline{g_s},$$
    donde cada $\overline{g_i}$ es el polinomio mínimo sobre $\FF_p$ de alguna
    raíz $n$-ésima $\zeta \in \FF_{p^f}^\times$, y como consecuencia,
    $$\deg \overline{g_i} = [\FF_{p^f} : \FF_p] = f.$$
    (Como fue explicado en la prueba de \ref{lema:factorizacion-de-Phi-p-mod-q},
    es instructivo ver cómo los factores $\overline{g_i}$ vienen de las órbitas
    del Frobenius.)

    En el caso cuando $p \mid n$, escribamos $n = m\,p^e$, donde $e = v_p$
    (y entonces $p \nmid m$). Este caso se reduce al anterior observando
    que
    $$\Phi_n (x) \equiv \Phi_m (x)^{\phi (p^e)} \pmod{p}.$$
    (¡Ejercicio!)
  \end{proof}
\end{lema}

Ahora aplicando Kummer--Dedekind, se obtiene el siguiente resultado.

\begin{teorema}
  Consideremos el campo ciclotómico $K = \QQ (\zeta_n)$. Factoricemos
  $n = \prod_p p^{v_p}$. Para un número primo $p$, sea $f$ el orden
  de $p$ módulo $n/p^{v_p}$. Luego, se tiene factorización
  $$p \O_K = \mathfrak{p}_1^e \cdots \mathfrak{p}_s^e,$$
  donde los índices de ramificación son $e = \phi (p^{v_p})$,
  y los grados del campo residual son $f$.
\end{teorema}

En particular, los primos que se ramifican son los divisores de $n$, excepto
el caso de $p = 2$ cuando ${v_2 (n) = 1}$. Esto no es muy interesante, dado que
en esta situación $\QQ (\zeta_n) = \QQ (\zeta_{n/2})$. Notamos que
la información sobre los primos que se ramifican también está en
el discriminante que hemos calculado.

\begin{ejemplo}
  En el campo ciclotómico $K = \QQ (\zeta_{15})$ la factorización de $p \O_K$
  depende de los restos de $p$ módulo $3$ y $5$.

  Para $p = 3$ hay ramificación con $e = \phi (3) = 2$ y para $p = 5$ hay
  ramificación con $e = \phi (5) = 4$. Para $p$ distintos de $3$ y $5$, tenemos
  las siguientes posibilidades (véase también la figura \ref{fig:Q-zeta-15}).

  \begin{center}
    \renewcommand{\arraystretch}{2}
    \begin{tabular}{|c|x{2.5cm}|x{2.5cm}|x{2.5cm}|x{2.5cm}|}
      \hline
      \backslashbox{$p$ $(3)$}{$p$ $(5)$} & $1$ & $2$ & $3$ & $4$ \tabularnewline
      \hline
      $1$ & $\mathfrak{p}_1 \mathfrak{p}_2\cdots \mathfrak{p}_8$ & $\mathfrak{p}_1 \mathfrak{p}_2$ & $\mathfrak{p}_1 \mathfrak{p}_2$ & $\mathfrak{p}_1 \mathfrak{p}_2 \mathfrak{p}_3 \mathfrak{p}_4$ \tabularnewline
      \hline
      $2$ & $\mathfrak{p}_1 \mathfrak{p}_2 \mathfrak{p}_3 \mathfrak{p}_4$ & $\mathfrak{p}_1 \mathfrak{p}_2$ & $\mathfrak{p}_1 \mathfrak{p}_2$ & $\mathfrak{p}_1 \mathfrak{p}_2 \mathfrak{p}_3 \mathfrak{p}_4$ \tabularnewline
      \hline
    \end{tabular}
  \end{center}

  Por ejemplo, si $p \equiv 2 \pmod{3}$ y $p \equiv 2 \pmod{5}$, entonces
  el orden de $p$ módulo $3$ es $2$ y el orden de $p$ módulo $5$ es $4$.
  Entonces, el orden de $p$ módulo $15$ es igual a $4$. Esto nos da ideales
  $\mathfrak{p}_i$ con el grado del campo residual $4$. Se cumple necesariamente
  $s\cdot 4 = \phi (15) = 8$, entonces hay $s = 2$ ideales primos en
  la factorización. Notamos que no hay primos inertes.
\end{ejemplo}

\begin{figure}
  \begin{center}
    \renewcommand{\arraystretch}{1.5}
      \begin{tabular}{x{0.75cm}x{1.75cm}x{0.75cm}x{0.9cm}x{0.75cm}x{1.75cm}x{0.75cm}x{0.9cm}x{0.75cm}x{1.75cm}x{0.75cm}x{0.9cm}}
      $p$ & $p\O_K$ & $f$ & $p~(15)$ & $p$ & $p\O_K$ & $f$ & $p~(15)$ & $p$ & $p\O_K$ & $f$ & $p~(15)$ \tabularnewline
      \hline
      $2$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $4$ & $2$ & $127$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $4$ & $7$ & $283$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $4$ & $13$ \tabularnewline
      \hline
      $3$ & $\mathfrak{p}^2$ & $4$ & $3$ & $131$ & $\mathfrak{p}_1\,\mathfrak{p}_2\,\mathfrak{p}_3\,\mathfrak{p}_4$ & $2$ & $11$ & $293$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $4$ & $8$ \tabularnewline
      \hline
      $5$ & $\mathfrak{p}^4$ & $2$ & $5$ & $137$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $4$ & $2$ & $307$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $4$ & $7$ \tabularnewline
      \hline
      $7$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $4$ & $7$ & $139$ & $\mathfrak{p}_1\,\mathfrak{p}_2\,\mathfrak{p}_3\,\mathfrak{p}_4$ & $2$ & $4$ & $311$ & $\mathfrak{p}_1\,\mathfrak{p}_2\,\mathfrak{p}_3\,\mathfrak{p}_4$ & $2$ & $11$ \tabularnewline
      \hline
      $11$ & $\mathfrak{p}_1\,\mathfrak{p}_2\,\mathfrak{p}_3\,\mathfrak{p}_4$ & $2$ & $11$ & $149$ & $\mathfrak{p}_1\,\mathfrak{p}_2\,\mathfrak{p}_3\,\mathfrak{p}_4$ & $2$ & $14$ & $313$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $4$ & $13$ \tabularnewline
      \hline
      $13$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $4$ & $13$ & $151$ & $\mathfrak{p}_1\,\mathfrak{p}_2\cdots\mathfrak{p}_8$ & $1$ & $1$ & $317$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $4$ & $2$ \tabularnewline
      \hline
      $17$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $4$ & $2$ & $157$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $4$ & $7$ & $331$ & $\mathfrak{p}_1\,\mathfrak{p}_2\cdots\mathfrak{p}_8$ & $1$ & $1$ \tabularnewline
      \hline
      $19$ & $\mathfrak{p}_1\,\mathfrak{p}_2\,\mathfrak{p}_3\,\mathfrak{p}_4$ & $2$ & $4$ & $163$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $4$ & $13$ & $337$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $4$ & $7$ \tabularnewline
      \hline
      $23$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $4$ & $8$ & $167$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $4$ & $2$ & $347$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $4$ & $2$ \tabularnewline
      \hline
      $29$ & $\mathfrak{p}_1\,\mathfrak{p}_2\,\mathfrak{p}_3\,\mathfrak{p}_4$ & $2$ & $14$ & $173$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $4$ & $8$ & $349$ & $\mathfrak{p}_1\,\mathfrak{p}_2\,\mathfrak{p}_3\,\mathfrak{p}_4$ & $2$ & $4$ \tabularnewline
      \hline
      $31$ & $\mathfrak{p}_1\,\mathfrak{p}_2\cdots\mathfrak{p}_8$ & $1$ & $1$ & $179$ & $\mathfrak{p}_1\,\mathfrak{p}_2\,\mathfrak{p}_3\,\mathfrak{p}_4$ & $2$ & $14$ & $353$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $4$ & $8$ \tabularnewline
      \hline
      $37$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $4$ & $7$ & $181$ & $\mathfrak{p}_1\,\mathfrak{p}_2\cdots\mathfrak{p}_8$ & $1$ & $1$ & $359$ & $\mathfrak{p}_1\,\mathfrak{p}_2\,\mathfrak{p}_3\,\mathfrak{p}_4$ & $2$ & $14$ \tabularnewline
      \hline
      $41$ & $\mathfrak{p}_1\,\mathfrak{p}_2\,\mathfrak{p}_3\,\mathfrak{p}_4$ & $2$ & $11$ & $191$ & $\mathfrak{p}_1\,\mathfrak{p}_2\,\mathfrak{p}_3\,\mathfrak{p}_4$ & $2$ & $11$ & $367$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $4$ & $7$ \tabularnewline
      \hline
      $43$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $4$ & $13$ & $193$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $4$ & $13$ & $373$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $4$ & $13$ \tabularnewline
      \hline
      $47$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $4$ & $2$ & $197$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $4$ & $2$ & $379$ & $\mathfrak{p}_1\,\mathfrak{p}_2\,\mathfrak{p}_3\,\mathfrak{p}_4$ & $2$ & $4$ \tabularnewline
      \hline
      $53$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $4$ & $8$ & $199$ & $\mathfrak{p}_1\,\mathfrak{p}_2\,\mathfrak{p}_3\,\mathfrak{p}_4$ & $2$ & $4$ & $383$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $4$ & $8$ \tabularnewline
      \hline
      $59$ & $\mathfrak{p}_1\,\mathfrak{p}_2\,\mathfrak{p}_3\,\mathfrak{p}_4$ & $2$ & $14$ & $211$ & $\mathfrak{p}_1\,\mathfrak{p}_2\cdots\mathfrak{p}_8$ & $1$ & $1$ & $389$ & $\mathfrak{p}_1\,\mathfrak{p}_2\,\mathfrak{p}_3\,\mathfrak{p}_4$ & $2$ & $14$ \tabularnewline
      \hline
      $61$ & $\mathfrak{p}_1\,\mathfrak{p}_2\cdots\mathfrak{p}_8$ & $1$ & $1$ & $223$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $4$ & $13$ & $397$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $4$ & $7$ \tabularnewline
      \hline
      $67$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $4$ & $7$ & $227$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $4$ & $2$ & $401$ & $\mathfrak{p}_1\,\mathfrak{p}_2\,\mathfrak{p}_3\,\mathfrak{p}_4$ & $2$ & $11$ \tabularnewline
      \hline
      $71$ & $\mathfrak{p}_1\,\mathfrak{p}_2\,\mathfrak{p}_3\,\mathfrak{p}_4$ & $2$ & $11$ & $229$ & $\mathfrak{p}_1\,\mathfrak{p}_2\,\mathfrak{p}_3\,\mathfrak{p}_4$ & $2$ & $4$ & $409$ & $\mathfrak{p}_1\,\mathfrak{p}_2\,\mathfrak{p}_3\,\mathfrak{p}_4$ & $2$ & $4$ \tabularnewline
      \hline
      $73$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $4$ & $13$ & $233$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $4$ & $8$ & $419$ & $\mathfrak{p}_1\,\mathfrak{p}_2\,\mathfrak{p}_3\,\mathfrak{p}_4$ & $2$ & $14$ \tabularnewline
      \hline
      $79$ & $\mathfrak{p}_1\,\mathfrak{p}_2\,\mathfrak{p}_3\,\mathfrak{p}_4$ & $2$ & $4$ & $239$ & $\mathfrak{p}_1\,\mathfrak{p}_2\,\mathfrak{p}_3\,\mathfrak{p}_4$ & $2$ & $14$ & $421$ & $\mathfrak{p}_1\,\mathfrak{p}_2\cdots\mathfrak{p}_8$ & $1$ & $1$ \tabularnewline
      \hline
      $83$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $4$ & $8$ & $241$ & $\mathfrak{p}_1\,\mathfrak{p}_2\cdots\mathfrak{p}_8$ & $1$ & $1$ & $431$ & $\mathfrak{p}_1\,\mathfrak{p}_2\,\mathfrak{p}_3\,\mathfrak{p}_4$ & $2$ & $11$ \tabularnewline
      \hline
      $89$ & $\mathfrak{p}_1\,\mathfrak{p}_2\,\mathfrak{p}_3\,\mathfrak{p}_4$ & $2$ & $14$ & $251$ & $\mathfrak{p}_1\,\mathfrak{p}_2\,\mathfrak{p}_3\,\mathfrak{p}_4$ & $2$ & $11$ & $433$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $4$ & $13$ \tabularnewline
      \hline
      $97$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $4$ & $7$ & $257$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $4$ & $2$ & $439$ & $\mathfrak{p}_1\,\mathfrak{p}_2\,\mathfrak{p}_3\,\mathfrak{p}_4$ & $2$ & $4$ \tabularnewline
      \hline
      $101$ & $\mathfrak{p}_1\,\mathfrak{p}_2\,\mathfrak{p}_3\,\mathfrak{p}_4$ & $2$ & $11$ & $263$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $4$ & $8$ & $443$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $4$ & $8$ \tabularnewline
      \hline
      $103$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $4$ & $13$ & $269$ & $\mathfrak{p}_1\,\mathfrak{p}_2\,\mathfrak{p}_3\,\mathfrak{p}_4$ & $2$ & $14$ & $449$ & $\mathfrak{p}_1\,\mathfrak{p}_2\,\mathfrak{p}_3\,\mathfrak{p}_4$ & $2$ & $14$ \tabularnewline
      \hline
      $107$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $4$ & $2$ & $271$ & $\mathfrak{p}_1\,\mathfrak{p}_2\cdots\mathfrak{p}_8$ & $1$ & $1$ & $457$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $4$ & $7$ \tabularnewline
      \hline
      $109$ & $\mathfrak{p}_1\,\mathfrak{p}_2\,\mathfrak{p}_3\,\mathfrak{p}_4$ & $2$ & $4$ & $277$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $4$ & $7$ & $461$ & $\mathfrak{p}_1\,\mathfrak{p}_2\,\mathfrak{p}_3\,\mathfrak{p}_4$ & $2$ & $11$ \tabularnewline
      \hline
      $113$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $4$ & $8$ & $281$ & $\mathfrak{p}_1\,\mathfrak{p}_2\,\mathfrak{p}_3\,\mathfrak{p}_4$ & $2$ & $11$ & $463$ & $\mathfrak{p}_1\,\mathfrak{p}_2$ & $4$ & $13$ \tabularnewline
      \hline
    \end{tabular}
  \end{center}

  \caption{Factorización de $p\O_K$ para $K = \QQ (\zeta_{15})$}
  \label{fig:Q-zeta-15}
\end{figure}

\begin{ejemplo}[Kummer]
  Consideremos el campo ciclotómico $K = \QQ (\zeta_{23})$. El primer primo
  tal que $p\equiv 1\pmod{23}$ es $47$, lo que implica que
  $$47 \O_K = \mathfrak{p}_1 \mathfrak{p}_2 \cdots \mathfrak{p}_{22},$$
  donde $N_{K/\QQ} (\mathfrak{p}_i) = 47$. Los ideales primos $\mathfrak{p}_i$
  no son principales. En efecto, si $\mathfrak{p}_i = \alpha \O_K$, entonces
  $|N_{K/\QQ} (\alpha)| = 47$. Sin embargo, se puede ver que en $\O_K$ no hay
  elementos de norma $47$\footnote{
    He aquí un cálculo en PARI/GP que lo confirma:\\
\texttt{? K = bnfinit(polcyclo(23));\\
? bnfisintnorm(K,47)\\
\% = []}\\
Sin embargo, lo explicaré más tarde.}.

  A saber, para $\alpha \in \O_K$ se tiene
  $$N_{K/\QQ} (\alpha) = \prod_{\sigma \in \Gal (K/\QQ)} \sigma (\alpha).$$
  El grupo de Galois $\Gal (K/\QQ) \cong (\ZZ/23\ZZ)^\times$ es cíclico de orden
  $22$. Sea $\sigma$ su generador. La teoría de Galois implica que en
  $\QQ (\zeta_{23})$ hay único subcampo cuadrático, y este es el subcampo fijo
  por $\sigma^2$.  Por razones de ramificación (véase ejercicio
  \ref{ejerc:subcampo-cuadratico-en-ciclotomico}) se puede deducir que este
  subcampo cuadrático es $F = \QQ (\sqrt{-23})$.

  Escribamos
  \[ N_{K/\QQ} (\alpha) =
     \Bigl(\alpha\,\sigma^2(\alpha)\,\sigma^4(\alpha)\cdots\sigma^{20}(\alpha)\Bigr) \,
     \Bigl(\sigma(\alpha)\,\sigma^3(\alpha)\,\sigma^5(\alpha)\cdots\sigma^{21}(\alpha)\Bigr). \]
  Aquí cada uno de los dos múltiplos está en $F$, y además, se ve que uno es
  el conjugado complejo del otro: tenemos $\overline{\alpha} = \sigma^{11} (\alpha)$,
  y de esta manera,
  \[ \overline{\alpha\,\sigma^2(\alpha)\,\sigma^4(\alpha)\cdots\sigma^{20}(\alpha)} =
     \sigma^{11} (\alpha)\,\sigma^{2+11}(\alpha)\,\sigma^{4+11}(\alpha)\cdots\sigma^{20+11}(\alpha) =
     \sigma(\alpha)\,\sigma^3(\alpha)\,\sigma^5(\alpha)\cdots\sigma^{21}(\alpha). \]

  Podemos entonces escribir
  $$N_{K/\QQ} (\alpha) = (a + b\sqrt{-23})\,(a - b\sqrt{-23}) = a^2 + 23\,b^2$$
  para algunos $a,b \in \QQ$. Dado que $\alpha$ es un elemento entero, tenemos
  también $a + b\sqrt{-23} \in \ZZ \Bigl[\frac{1+\sqrt{-23}}{2}\Bigr]$, así que
  $a = \frac{a'}{2}$ y $b = \frac{b'}{2}$, donde $a',b' \in \ZZ$ y $a' \equiv b'
  \pmod{2}$. Entonces,
  $$N_{K/\QQ} (\alpha) = \frac{a'^2 + 23\,b'^2}{4}.$$

  Ahora si en $\ZZ [\zeta_{23}]$ hay un elemento de norma $47$, esto implicaría
  que para algunos $a',b' \in \ZZ$ se cumple
  $$a'^2 + 23b'^2 = 4\cdot 47.$$
  Sin embargo, no es difícil ver que esto es imposible\footnote{Tenemos
    necesariamente $23 b'^2 \le 4\cdot 47$, y luego $|b'| \le 2$. Basta
    entonces sustituir $b' = 1,2$ y ver que la ecuación no tiene soluciones
    enteras.}.

  Podemos concluir que los ideales primos $\mathfrak{p}_i$ que están sobre $47$
  en el campo ciclotómico $K = \QQ (\zeta_{23})$ no son principales. Como
  consecuencia, el anillo $\O_K = \ZZ [\zeta_{23}]$ no es un dominio de
  factorización única.

  Tenemos $\legendre{-23}{47} = +1$, y entonces en el anillo
  $\ZZ \Bigl[\frac{1 + \sqrt{-23}}{2}\Bigr]$ el ideal generado por $p = 47$
  se factoriza como $\mathfrak{p}\,\overline{\mathfrak{p}}$, y lo que acabamos
  de ver demuestra que estos ideales primos tampoco son principales.
  (Al pasar a $\QQ (\zeta_{23})$, cada uno de estos ideales se escinde en $11$
  ideales primos no principales.)

  \[ \begin{tikzcd}
    \mathfrak{p}_1 \cdots \mathfrak{p}_{22} \ar[-]{d} &[-3em] \subset &[-3em] \ZZ [\zeta_{23}]\ar[-]{d} &[-3em] \subset &[-3em] \QQ (\zeta_{23}) \ar[-]{d}{11} \\
    \mathfrak{p} \overline{\mathfrak{p}} \ar[-]{d} & \subset & \ZZ \Bigl[\frac{1 + \sqrt{-23}}{2}\Bigr]\ar[-]{d} & \subset & \QQ (\sqrt{-23}) \ar[-]{d}{2} \\
    47 & \subset & \ZZ & \subset & \QQ
    \end{tikzcd} \]
\end{ejemplo}

De hecho, $K = \QQ (\zeta_n)$ para $n = 23$ es el primer campo ciclotómico
tal que $\O_K = \ZZ [\zeta_n]$ no tiene factorización única, o de manera
equivalente, tal que el grupo de clases $\Cl (K)$ no es trivial. Esto fue
descubierto por Kummer.

Hay una anécdota bien conocida relacionada con este resultado de Kummer.
En 1847 el matemático francés Gabriel Lamé anunció ante la Academia de Ciencias
de Paris una supuesta prueba del último teorema de Fermat basada en
la factorización única en el anillo $\ZZ [\zeta_n]$. Liouville puso en duda esta
afirmación y se comunicó con Kummer quien aparentemente ya tenía
contraejemplos. Para los detalles históricos, véase por ejemplo
\cite{Edwards-1975} y \cite{Edwards-1977}. El libro \cite{Edwards-1996}
también contiene detalles sobre los cálculos de Kummer.

Véase también \url{https://en.wikipedia.org/wiki/23_enigma}
sobre la numerología detrás de 23.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\pagebreak
\section{Cálculos en PARI/GP}

Ya he mencionado PARI/GP (\url{https://pari.math.u-bordeaux.fr/}) en varias
ocasiones, y ahora veremos de manera un poco más sistemática cómo hacer cálculos
con los campos de números en este programa. Si todavía no lo han descargado, es
hora de hacerlo y probar los ejemplos de abajo.

\vspace{1em}

He aquí algunos comandos útiles:
\begin{itemize}
\item \texttt{\textbackslash{}l "log.txt"} --- guardar toda la sesión en el archivo \texttt{log.txt} (otra vez \texttt{\textbackslash{}l} deja de hacerlo),

\item \texttt{?xxxxx} --- ayuda sobre \texttt{xxxxx}, por ejemplo,

\begin{shaded}
\begin{verbatim}
? ?idealprimedec
idealprimedec(nf,p,{f=0}): prime ideal decomposition of the prime number p
in the number field nf as a vector of prime ideals. If f is present and
non-zero, restrict the result to primes of residue degree <= f.
\end{verbatim}
\end{shaded}

\item \texttt{??xxxxx} --- ayuda detallada sobre \texttt{xxxxx},

\item \texttt{\%} --- el resultado del cálculo anterior:
  
\begin{shaded}
\begin{verbatim}
? 2^2
%1 = 4
? %^2
%2 = 16
? %^2
%3 = 256
? %1 + %2
%4 = 20
\end{verbatim}
\end{shaded}

\item \texttt{\textbackslash{}quit} --- salir del programa.
\end{itemize}

Cuando ocurre algún error, el programa entra en el ``ciclo break'' y nos
recomienda escribir \texttt{break} para salir de allí. Esto sirve para encontrar
errores en código más complejo y probablemente no será relevante para nuestros
pequeños cálculos.

\begin{shaded}
\begin{verbatim}
? mcd(2,3)
  ***   at top-level: mcd(2,3)
  ***                 ^--------
  ***   not a function in function call
  ***   Break loop: type 'break' to go back to GP prompt
break> break

? gcd(2,3)
% = 1
\end{verbatim}
\end{shaded}

\pagebreak

\subsection{Polinomios}

Un campo de números se especifica por un polinomio irreducible $f$ tal que $K
\cong \QQ [x]/(f)$. Para ver si un polinomio es irreducible, sirve la función
\texttt{polisirreducible($f$)}.

\begin{shaded}
\begin{verbatim}
? polisirreducible(x^3 - 3*x + 1)
% = 1
? polisirreducible(x^3-1)
% = 0
\end{verbatim}
\end{shaded}

Si queremos factorizar un polinomio, podemos ocupar la función
\texttt{factor($f$)}.

\begin{shaded}
\begin{verbatim}
? factor (x^8-1)
% = 
[  x - 1 1]

[  x + 1 1]

[x^2 + 1 1]

[x^4 + 1 1]
\end{verbatim}
\end{shaded}

El resultado es una matriz de $s\times 2$, donde en la primera columna se
encuentran los factores irreducibles y en la segunda columna las potencias
correspondientes:
\[ f = g_1^{e_1} \cdots g_s^{e_s} \longleftrightarrow
\begin{pmatrix}
  g_1 & e_1 \\
  \vdots & \vdots \\
  g_s & e_s
  \end{pmatrix}. \]

La factorización módulo $p$ (que ocupamos para el Kummer--Dedekind) puede ser
obtenida mediante \texttt{factor($f$*Mod(1,$p$))}.

\begin{shaded}
\begin{verbatim}
? factor (polcyclo(8)*Mod(1,2))
% = 
[Mod(1, 2)*x + Mod(1, 2) 4]

? factor (polcyclo(8)*Mod(1,3))
% = 
[Mod(1, 3)*x^2 + Mod(1, 3)*x + Mod(2, 3) 1]
[Mod(1, 3)*x^2 + Mod(2, 3)*x + Mod(2, 3) 1]

? factor (polcyclo(8)*Mod(1,5))
% = 
[Mod(1, 5)*x^2 + Mod(2, 5) 1]
[Mod(1, 5)*x^2 + Mod(3, 5) 1]
\end{verbatim}
\end{shaded}

El discriminante de un polinomio se calcula mediante \texttt{poldisc($f$)}.

\begin{shaded}
\begin{verbatim}
? poldisc (polcyclo(7))
% = -16807
? factor(%)
% = 
[-1 1]
[ 7 5]
\end{verbatim}
\end{shaded}

\subsection{Campos de números}

Para especificar un campo de números $K = \QQ[x]/(f)$, hay que escribir
\texttt{$K$=nfinit($f$)}. Esta función calcula los invariantes básicos de $K$.
\begin{itemize}
\item \texttt{$K$.pol} --- el polinomio usado para definir $K$,
\item \texttt{$K$.zk} --- el anillo de enteros $\O_K$,
\item \texttt{$K$.disc} --- el discriminante $\Delta_K$,
\item \texttt{$K$.sign} --- la signatura \texttt{[$r_1$,$r_2$]},
\item \dots
\end{itemize}

\begin{shaded}
\begin{verbatim}
? K = nfinit(x^3-19);
? K.pol
% = x^3 - 19
? K.disc 
% = -1083
? factor (%)
% = 
[-1 1]
[ 3 1]
[19 2]

? K.zk
% = [1, 1/3*x^2 + 1/3*x + 1/3, x]
? K.r1
% = 1
? K.r2
% = 1
? K.sign
% = [1, 1]
\end{verbatim}
\end{shaded}

Aquí escribí \texttt{$K$=nfinit(x\textasciicircum{}3-19);} con punto y coma para
suprimir la salida. De todas maneras, el resultado será guardado en $K$. Pueden
ejecutar el mismo comando sin punto y coma, y PARI/GP imprimirá toda
la estructura de datos asociada con $K$.

Lo que se encuentra en \texttt{$K$.zk} es una base de $\O_K$ sobre $\ZZ$ en
términos de $x$ mód $f$. En este caso particular el resultado significa que
para $\QQ [\alpha]/(\alpha^3 - 19)$ se tiene
$$\O_K = \ZZ \oplus \frac{1}{3} (\alpha^2 + \alpha + 1) \ZZ \oplus \alpha \ZZ.$$

Por supuesto, el mismo campo de números puede ser especificado por diferentes
polinomios irreducibles. Para ver si dos campos de números son isomorfos, sirve
la función \texttt{nfisisom($f$,$g$)}. Como entrada podemos especificar
polinomios irreducibles o las estructuras \texttt{nfinit}.

\begin{shaded}
\begin{verbatim}
? nfisisom(x^4 + 2*x^2 + 4*x + 2, polcyclo(8))
% = [x^2 - x, x^2 + x, -x^3 - x^2, x^3 - x^2]

? nfisisom(x^4 + 2, polcyclo(8))
% = 0
\end{verbatim}
\end{shaded}

Si la salida es \texttt{0}, esto significa que no hay isomorfismo; en el caso
contrario, se devuelve una lista de posibles isomorfismos. En el ejemplo de
arriba vimos entonces que
$$\QQ [\alpha]/(\alpha^4 + 2 \alpha^2 + 4 \alpha + 2) \cong \QQ (\zeta_8),$$
y además que uno de los isomorfismos viene dado por
$$\alpha \mapsto \zeta_8^2 - \zeta_8.$$

La función \texttt{nfisincl($f$,$g$)} verifica si $\QQ[x]/(f)$ es isomorfo a un
subcampo de $\QQ[x]/(g)$ y encuentra los isomorfismos. He aquí un ejemplo
particular.

\begin{shaded}
\begin{verbatim}
? nfisincl(x^2-7, polcyclo(7))
% = 0
? nfisincl(x^2+7, polcyclo(7))
% = [-2*x^4 - 2*x^2 - 2*x - 1, 2*x^4 + 2*x^2 + 2*x + 1]
\end{verbatim}
\end{shaded}

Los resultados nos dicen que $\QQ (\sqrt{7}) \not\subset \QQ (\zeta_7)$
y $\QQ (\sqrt{-7}) \subset \QQ (\zeta_7)$. También hay modos de encontrar todos
los posibles subcampos, pero los veremos cuando hablaremos de la teoría de
Galois.

\vspace{1em}

Una función muy útil es \texttt{polredbest($f$)}. Esta a partir de un polinomio
$f$ nos da otro polinomio $g$ tal que $\QQ[x]/(f) \cong \QQ[x]/(g)$, pero los
coeficientes de $g$ son relativamente pequeños. He aquí un ejemplo particular
para qué sirve esta reducción.

Para ver un ejemplo particular, supongamos que nos interesa el campo
bicuadrático $K = \QQ (\sqrt{2},\sqrt{3})$.  Este se genera por
$\alpha = \sqrt{2} + \sqrt{3}$, cuyo polinomio mínimo viene dado por
$x^4 - 10 x^2 + 1$. Ahora
$$\ZZ [\alpha] = 2^{14}\cdot 3^2, \quad \Delta_K = 2^8\cdot 3^2,$$
lo que significa que
$$[\O_K : \ZZ [\alpha]] = 8.$$

\begin{shaded}
\begin{verbatim}
? f = x^4 - 10*x^2 + 1;
? poldisc(f)
% = 147456
? factor(%)
% = 
[2 14]

[3  2]

? K = nfinit(f);
? K.disc 
% = 2304
? factor(%)
% = 
[2 8]
[3 2]

? sqrtint(poldisc(f)/K.disc)
% = 8
\end{verbatim}
\end{shaded}

¿Podemos encontrar un mejor subanillo cuyo índice en $\O_K$ sea menor?
Con ayuda de PARI/GP encontramos $\ZZ [\beta]$, donde
$\beta^4 - 4\beta^2 + 1 = 0$, y resulta que $\O_K = \ZZ [\beta]$.
De hecho, $\beta = \sqrt{2 + \sqrt{3}}$.

\begin{shaded}
\begin{verbatim}
? g = polredbest(f)
% = x^4 - 4*x^2 + 1
? poldisc(g)
% = 2304
? % == K.disc 
% = 1
\end{verbatim}
\end{shaded}

Otro ejemplo parecido: para $K = \QQ (\alpha)$, donde $\alpha = \sqrt[3]{19}$
tenemos
$$[\O_K : \ZZ [\alpha]] = 3.$$
Con ayuda de PARI/GP encontramos el subanillo $\ZZ [\beta]$, donde
$\beta^3 - \beta^2 - 6\beta - 12 = 0$ y
$$[\O_K : \ZZ [\beta]] = 2.$$

\begin{shaded}
\begin{verbatim}
? f = x^3-19;
? K = nfinit(f);
? sqrtint(poldisc(f)/K.disc)
% = 3
? g = polredbest(f)
% = x^3 - x^2 - 6*x - 12
? sqrtint(poldisc(g)/K.disc)
% = 2
\end{verbatim}
\end{shaded}

Si queremos saber cómo $\alpha$ se expresa en términos de $\beta$ (para trabajar
en el nuevo anillo $\ZZ [\beta]$), hay que escribir \texttt{polredbest($f$,1)}

\begin{shaded}
\begin{verbatim}
? polredbest(f,1)
% = [x^3 - x^2 - 6*x - 12,
     Mod(1/2*x^2 - 1/2*x - 2, x^3 - x^2 - 6*x - 12)]
? %[2]^3
% = Mod(19, x^3 - x^2 - 6*x - 12)
\end{verbatim}
\end{shaded}

La salida significa que
$$\alpha = \frac{1}{2}\beta^2 - \frac{1}{2}\beta - 2.$$

\subsection{Operaciones con elementos de $K/\QQ$}

Hay varias maneras de especificar un elemento de un campo de números
$\QQ[x]/(f)$. Podemos trabajar con elementos módulo $f$.

\begin{shaded}
\begin{verbatim}
? a = Mod(x^4 - x^3 - x^2 + x, polcyclo(5))
% = Mod(-2*x^3 - 2*x^2 - 1, x^4 + x^3 + x^2 + x + 1)
? a^2
% = Mod(5, x^4 + x^3 + x^2 + x + 1)
\end{verbatim}
\end{shaded}

Otra opción es expresar los elementos en términos de la base de $\O_K$.
La conversión se hace mediante \texttt{nfalgtobasis($K$,$\alpha$)}
y \texttt{nfbasistoalg($K$,[$a_1$, \ldots, $a_n$]\textasciitilde)}.

\begin{shaded}
\begin{verbatim}
? K = nfinit(polcyclo(5));
? K.zk
% = [1, x, x^2, x^3]

? nfalgtobasis(K, -2*x^3 - 2*x^2 - 1)
% = [-1, 0, -2, -2]~
% = [-1, 0, -2, -2]~
? K.zk * %
% = -2*x^3 - 2*x^2 - 1

? nfbasistoalg(K,%)
% = Mod(-2*x^3 - 2*x^2 - 1, x^4 + x^3 + x^2 + x + 1)
\end{verbatim}
\end{shaded}

Aquí \texttt{[-1, 0, -2, -2]\textasciitilde} representa el vector columna
$(-1,0,-2,-2)^t$. Las funciones que trabajan con elementos de un campo de
números empiezan por ``\texttt{nfelt}''. Por ejemplo,
\begin{center}
\texttt{nfeltadd($K$,$\alpha$,$\beta$)}, ~
\texttt{nfeltmul($K$,$\alpha$,$\beta$)}, ~
\texttt{nfeltdiv($K$,$\alpha$,$\beta$)}.
\end{center}
Si los números algebraicos están especificados como polinomios módulo $f$, basta
usar los operadores habituales \texttt{+}, \texttt{-}, \texttt{*}, \texttt{/},
etc. Otras funciones útiles son
\begin{itemize}
\item \texttt{nfeltnorm($K$,$\alpha$)} o \texttt{norm(Mod($g$,$f$))} --- norma;
\item \texttt{nfelttrace($K$,$\alpha$)} o \texttt{trace(Mod($g$,$f$))} --- traza;
\item \texttt{charpoly(Mod($g$,$f$))} --- polinomio característico;
\item \texttt{minpoly(Mod($g$,$f$))} --- polinomio mínimo.
\end{itemize}
Trate de escribir \texttt{nfelt} y digitar $\boxed{\to}$ para ver la lista
completa de funciones cuyo nombre empieza por \texttt{nfelt}.

\begin{shaded}
\begin{verbatim}
? K = nfinit(polcyclo(7));
? nfelttrace(K,x)
% = -1
? trace(Mod(x,K.pol))
% = -1
? nfeltnorm(K, 1-x)
% = 7
? norm(Mod(1-x, K.pol))
% = 7

? charpoly(Mod(x + x^-1, K.pol))
% = x^6 + 2*x^5 - 3*x^4 - 6*x^3 + 2*x^2 + 4*x + 1
? minpoly(Mod(x + x^-1, K.pol))
% = x^3 + x^2 - 2*x - 1
\end{verbatim}
\end{shaded}

\subsection{Extensiones de campos de números}

PARI/GP también trabaja con campos de números \emph{relativos}, es decir,
extensiones $\QQ \subset K \subset L$. Las funciones correspondientes empiezan
por ``\texttt{rnf}'' que es una abreviación de ``\emph{relative number field}''.
Para mayor información, les invito a consultar la documentación. He aquí un
pequeño ejemplo donde calculamos el campo $\QQ (\sqrt[3]{2},\zeta_3)$.

\begin{shaded}
\begin{verbatim}
? K = nfinit(t^3-2);
? L = rnfinit(K, polcyclo(3));
? L.polabs
% = x^6 + 3*x^5 + 6*x^4 + 11*x^3 + 12*x^2 - 3*x + 1
? rnfeltreltoabs(L,x+t)
% = Mod(-4/9*x^5 - 14/9*x^4 - 28/9*x^3 - 52/9*x^2 - 65/9*x - 4/9,
        x^6 + 3*x^5 + 6*x^4 + 11*x^3 + 12*x^2 - 3*x + 1)
? minpoly(%)
% = x^6 + 3*x^5 + 6*x^4 + 3*x^3 + 9*x + 9
? nfisisom(%, L.polabs)
% = [-x - 1, .....]
\end{verbatim}
\end{shaded}

Es importante que las variables de los polinomios que definen $K$ y $L$ sean
distintas, por esto pusimos $t^3 - 2$. El programa calculó que
$$L \cong \QQ[x]/(x^6 + 3 x^5 + 6 x^4 + 11 x^3 + 12 x^2 - 3 x + 1)$$
y que $\sqrt[3]{2} + \zeta_3$ tiene polinomio mínimo sobre $\QQ$
$$x^6 + 3 x^5 + 6 x^4 + 3 x^3 + 9 x + 9.$$

Aunque en este curso no vamos a hablar mucho de la situación relativa
$L/K$\footnote{Los libros de texto avanzados empiezan en esta generalidad, pero
  no lo hago a propósito para simplificar la exposición.}, PARI/GP sabe calcular
varios invariantes relativos, como el discriminante $\Delta_{L/K}$ que será un
ideal en $\O_K$, los generadores de $\O_L$ como $\O_K$-módulo, etc. Para obtener
un campo ``absoluto'', podemos escribir \texttt{nfinit($L$)}.

\begin{shaded}
\begin{verbatim}
? L.zk
% = [[1, x - 1], [1, [1, 0, 1/3; 0, 1, 2/3; 0, 0, 1/3]]]
? L.disc
% = [[3, 1, 2; 0, 1, 0; 0, 0, 1], -3]
? nfinit(L).disc
% = -34992

? factor(%)
% = 
[-1 1]

[ 2 4]

[ 3 7]
\end{verbatim}
\end{shaded}

\noindent\emph{Continuará\dots}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\pagebreak

\phantomsection

\addcontentsline{toc}{section}{Ejercicios}
\section*{Ejercicios}

\begin{ejercicio}
  Encuentre la fórmula para el discriminante del polinomio $x^n + ax + b$.
\end{ejercicio}

\begin{ejercicio}
  Para una extensión $K/\QQ$, sea $e_1,\ldots,e_n$ una base de $K$ sobre $\QQ$
  y $e_1', \ldots, e_n'$ la base dual respecto al apareamiento de traza.
  Demuestre que
  $$\Delta (e_1,\ldots,e_n) \cdot \Delta (e_1', \ldots, e_n') = 1.$$
\end{ejercicio}

\begin{ejercicio}
  Encuentre el anillo de enteros $\O_K$ y discriminante $\Delta_K$ para el campo
  $K = \QQ (\alpha)$ donde $\alpha$ cumple $\alpha^4 + \alpha + 1 = 0$.
\end{ejercicio}

\begin{ejercicio}
  Sea $K/\QQ$ un campo de números de grado $n = [K : \QQ]$. Supongamos que para
  algún primo racional $p < n$ se tiene factorización en $n$ diferentes primos
  $p\O_K = \mathfrak{p}_1 \cdots \mathfrak{p}_n$. Demuestre que en este caso
  $\O_K$ no es de la forma $\ZZ [\alpha]$.
\end{ejercicio}

\begin{ejercicio}
  Sea $K/\QQ$ un campo de números y $\alpha \in \O_K$ un elemento entero tal que
  $\alpha \notin m \O_K$ para $m > 1$. Demuestre que en este caso
  existe una base de $\O_K$ sobre $\ZZ$ que contiene $\alpha$. En particular,
  demuestre que $\O_K$ siempre admite una base que contiene $1$.
\end{ejercicio}

\begin{ejercicio}
  \label{ejerc:anillo-de-enteros-cubico}
  Sea $d$ un entero libre de cuadrados. Consideremos el campo cúbico
  $K = \QQ (\sqrt[3]{d})$. Denotemos $\alpha = \sqrt[3]{d}$ y consideremos
  un elemento
  $$\beta = a + b\alpha + c\alpha^2, \quad a,b,c \in \QQ.$$

  \begin{enumerate}
  \item[1)] Calcule las trazas
    $T_{K/\QQ} (\beta)$, $T_{K/\QQ} (\alpha\beta)$, $T_{K/\QQ} (\alpha^2\beta)$
    y la norma $N_{K/\QQ} (\beta)$.

  \item[2)] Si $\beta \in \O_K$, entonces las trazas y normas de arriba son
    números enteros. Use esto para concluir que
    $\O_K  \subseteq \frac{1}{3} \ZZ [\alpha]$.

  \item[3)] Use estas consideraciones para calcular el anillo de enteros $\O_K$
    y discriminante $\Delta_K$.
  \end{enumerate}
\end{ejercicio}

\begin{ejercicio}
  Encuentre el anillo de enteros $\O_K$ y discriminante $\Delta_K$ para
  los campos cúbicos $\QQ (\sqrt[3]{6})$ y $\QQ (\sqrt[3]{12})$.
\end{ejercicio}

\begin{ejercicio}
  Consideremos el campo cúbico $K = \QQ (\sqrt[3]{17})$.

  \begin{enumerate}
  \item[1)] Calcule el anillo de enteros $\O_K$ y discriminante $\Delta_K$.
  \item[2)] Describa las factorizaciones de primos racionales $p \in \ZZ$ en
    $\O_K$.
  \item[3)] Describa los ideales primos $\mathfrak{p} \subset \O_K$
    tales que $N_{K/\QQ} (\mathfrak{p}) \le 30$.
  \item[4)] Describa todos los ideales $I \subset \O_K$
    tales que $N_{K/\QQ} (I) \le 30$.
  \end{enumerate}
\end{ejercicio}

\begin{ejercicio}
  \label{ejerc:producto-de-kronecker}
  Sea $X$ una matriz de $n\times n$ e $Y$ una matriz de $n'\times n'$.
  El \textbf{producto de Kronecker} $X\otimes Y$ es la matriz de
  $nn' \times nn'$ que consiste en bloques
  \[ \begin{pmatrix}
    x_{11} Y & \cdots & x_{1n} Y \\
    \vdots & \ddots & \vdots \\
    x_{n1} Y & \cdots & x_{nn} Y
  \end{pmatrix}. \]
  (El significado de esta matriz: si $X$ e $Y$ corresponden a aplicaciones
  $R$-lineales $f\colon R^n \to R^n$ y $g\colon R^{n'}\to R^{n'}$, entonces
  $X\otimes Y$ corresponde a $f\otimes g\colon R^{nn'} \to R^{nn'}$
  respecto a la base estándar $e_i\otimes e_j'$.)

  Demuestre que
  $$\det (X\otimes Y) = \det (X)^{n'} \cdot \det (Y)^n.$$
\end{ejercicio}

\begin{ejercicio}
  Para el campo de números $K = \QQ (\sqrt{-3},\zeta_5)$ calcule
  $\O_K$ y $\Delta_K$. ¿Cuáles primos racionales se ramifican en $K$?
\end{ejercicio}

\begin{ejercicio}
  Consideremos los campos cuadráticos $K = \QQ (\sqrt{3})$ y
  $K' = \QQ (\sqrt{5})$ y su compositum $KK' = \QQ (\sqrt{3},\sqrt{5})$.
  Sea $\O = \ZZ \oplus \sqrt{3}\ZZ \oplus \sqrt{5}\ZZ \oplus \sqrt{15}\ZZ$.

  \begin{enumerate}
  \item[1)] Calcule el índice $[\O_K : \O]$.

  \item[2)] Calcule $\O_K$ y $\Delta_K$.
  \end{enumerate}
\end{ejercicio}

\begin{ejercicio}
  Calcule que
  \[ \Delta (\ZZ [\zeta_{p^e}]) = \Delta (\Phi_{p^e}) = \pm\,p^s,
     \quad \text{donde } s = p^{e-1}\,(pe - e - 1). \]
  (Indicación: generalice el cálculo de
  \ref{ejemplo:discriminante-de-Q-zeta-p}.)
\end{ejercicio}

\begin{ejercicio}
  Demuestre que si $n = m p^e$, donde $p \nmid m$, entonces se cumple
  la congruencia
  $$\Phi_n (x) \equiv \Phi_m (x)^{\phi (p^e)} \pmod{p}.$$
\end{ejercicio}
