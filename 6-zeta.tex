\chapter{Función zeta de Dedekind}

% \pdfbookmark{Clase 25 (11/11/20)}{clase-25}
\marginpar{\small Clase 25 \\ 11/11/20}

Para un campo de números $K/\QQ$, la \textbf{función zeta de Dedekind}
correspondiente es una especie de función generatriz definida por la serie
$$\zeta_K (s) = \sum_{I \ne 0} \frac{1}{N_{K/\QQ} (I)^s},$$
donde la suma se toma sobre los ideales enteros no nulos $I \subseteq \O_K$.
Resulta que la función zeta de Dedekind codifica mucha información aritmética
sobre $K$. Nos interesará $\zeta_K (s)$ como un objeto analítico, y en
particular hay que ver la convergencia de la serie.

Primero notamos que si $K = \QQ$, entonces los ideales no nulos en $\O_K = \ZZ$
tienen forma $n\ZZ$ para $n = 1,2,3,\ldots$, así que $\zeta_\QQ (s) = \zeta (s)$
es la función zeta de Riemann.

\begin{lema}
  \label{lema:convergencia-y-residuo-de-zeta-de-Riemann}
  La serie $\zeta (s) = \sum_{n\ge 1} \frac{1}{n^s}$ converge absolutamente para
  $\Re s > 1$, y se tiene
  $$\lim_{s \to 1^+} (s - 1)\,\zeta (s) = 1.$$

  \begin{proof}
    Primero, notamos que $|1/n^s| = 1/n^{\Re s}$, así que será suficiente
    establecer la convergencia para $s > 1$ real. Tenemos
    $$\int_n^{n+1} \frac{dx}{x^s} \le \frac{1}{n^s} \le \int_{n-1}^n \frac{dx}{x^s},$$
    donde la primera desigualdad se cumple para $n \ge 1$ y la segunda para
    $n \ge 2$
    (véase la figura~\ref{fig:convergencia-y-residuo-de-zeta-de-Riemann}).
    Tomando la suma sobre $n \ge 1$, nos sale la desigualdad
    $$\int_1^\infty \frac{dx}{x^s} \le \zeta (s) \le 1 + \int_1^\infty \frac{dx}{x^s}.$$
    Ahora, dado que $\int_1^\infty \frac{dx}{x^s} = \frac{1}{s - 1}$, tenemos
    $$\frac{1}{s - 1} \le \zeta (s) \le \frac{s}{s - 1},$$
    y luego
    $$1 \le (s-1)\,\zeta (s) \le s.$$
    Esto establece la convergencia y también calcula $(s-1)\,\zeta (s)$ para
    $s \to 1^+$.
  \end{proof}
\end{lema}

\begin{figure}
  \begin{center}
    \includegraphics{pic/xs-bounds.pdf}
  \end{center}

  \begin{center}
    \includegraphics{pic/riemann-zeta-bounds.pdf}
  \end{center}

  \caption{Demostración de \ref{lema:convergencia-y-residuo-de-zeta-de-Riemann}}
  \label{fig:convergencia-y-residuo-de-zeta-de-Riemann}
\end{figure}

Ahora podemos probar la convergencia de $\zeta_K (s)$.

\begin{proposicion}
  La serie $\zeta_K (s) = \sum_{I \ne 0} \frac{1}{N_{K/\QQ} (I)^s}$ converge
  absolutamente para $\Re s > 1$. Además, se cumple la
  \textbf{fórmula del producto de Euler}
  \[ \sum_{I \ne 0} \frac{1}{N_{K/\QQ} (I)^s} =
     \prod_{\mathfrak{p}} \frac{1}{1 - N_{K/\QQ} (\mathfrak{p})^{-s}}, \]
  donde el producto es sobre todos los ideales primos (no nulos)
  $\mathfrak{p} \subset \O_K$.

  \begin{proof}
    De nuevo, la convergencia absoluta para $\Re s > 1$ se sigue de la
    convergencia para $s > 1$ real. Será suficiente probar la convergencia
    absoluta del producto de Euler
    $$\prod_{\mathfrak{p}} \frac{1}{1 - N_{K/\QQ} (\mathfrak{p})^{-s}},$$
    y luego,
    \[ \prod_{\mathfrak{p}} \frac{1}{1 - N_{K/\QQ} (\mathfrak{p})^{-s}} =
       \prod_{\mathfrak{p}} \sum_{e \ge 0} \frac{1}{N_{K/\QQ} (\mathfrak{p}^e)^s} =
       \sum_{I\ne 0} \frac{1}{N_{K/\QQ} (I)^s}. \]
    Aquí hemos usado la serie geométrica, la multiplicatividad de la norma, y
    que todo ideal entero no nulo $I \subseteq \O_K$ tiene factorización única
    en ideales primos $I = \mathfrak{p}_1^{e_1}\cdots \mathfrak{p}_s^{e_s}$.

    Un producto $\prod_{n\ge 1} (1 + |x_n|)$ converge si y solamente si la serie
    $\sum_{n\ge 1} |x_n|$ converge. Entonces, la convergencia del producto de
    Euler se sigue de la convergencia de
    $\prod_{\mathfrak{p}} (1 - N_{K/\QQ} (\mathfrak{p})^{-s})$, y luego de
    $\sum_{\mathfrak{p}} \frac{1}{N_{K/\QQ} (\mathfrak{p})^s}$.

    Recordemos que para todo primo racional $p$, existen $\le [K:\QQ]$ ideales
    primos $\mathfrak{p} \mid p$, y luego para cada uno de estos se tiene
    $N_{K/\QQ} (\mathfrak{p}) = p^f \ge p$. Entonces,
    \[ \sum_{\mathfrak{p}} \frac{1}{N_{K/\QQ} (\mathfrak{p})^s} =
       \sum_p \sum_{\mathfrak{p} \mid p} \frac{1}{N_{K/\QQ} (\mathfrak{p})^s} \le
       \sum_p \frac{[K:\QQ]}{p^s} < [K : \QQ]\,\zeta (s). \]
    Aquí hemos usado la convergencia de la función zeta de Riemann.
  \end{proof}
\end{proposicion}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Ejemplo: la función zeta de \texorpdfstring{$\QQ (i)$}{ℚ(i)}}
\label{sec:funcion-zeta-de-Q(i)}

Tomemos $K = \QQ (i)$. Para entender cómo se ve la función zeta correspondiente
$\zeta_K (s)$, sería más fácil trabajar con el producto de Euler
$$\prod_{\mathfrak{p}} \frac{1}{1 - N_{K/\QQ} (\mathfrak{p})^{-s}}.$$
Los primos en $\O_K = \ZZ[i]$ son los siguientes.
\begin{itemize}
\item Al primo ramificado $p = 2$ corresponde un ideal primo $\mathfrak{p}_2$
  de norma $2$.

\item Si $p \equiv 1 \pmod{4}$, entonces $p$ se escinde en dos ideales primos
  $\mathfrak{p}$ y $\overline{\mathfrak{p}}$, cada uno de norma $p$.

\item Si $p \equiv 3 \pmod{4}$, entonces $p$ es inerte y corresponde a un ideal
  primo $\mathfrak{p}$ de norma $p^2$.
\end{itemize}

Entonces,
\[ \zeta_K (s) =
   \frac{1}{1 - 2^{-s}} \,
   \prod_{p \equiv 1 ~ (4)} \frac{1}{(1 - p^{-s})^2} \,
   \prod_{p \equiv 1 ~ (4)} \frac{1}{1 - p^{-2s}}. \]
Notamos que $\frac{1}{1 - p^{-2s}} = \frac{1}{1 - p^{-s}}\,\frac{1}{1 + p^{-s}}$,
así que
$$\zeta_K (s) = \prod_p \frac{1}{1 - p^{-s}}\,\prod_p \frac{1}{1 - \chi(p)\,p^{-s}},$$
donde
\[ \chi(p) = \begin{cases}
  +1, & p \equiv 1 \pmod{4},\\
  -1, & p \equiv 3 \pmod{4}.
\end{cases} \]
Este es un \textbf{carácter de Dirichlet} mód $4$, y a este se asocia la
\textbf{serie L de Dirichlet} correspondiente
\[ L (s,\chi) = \prod_p \frac{1}{1 - \chi(p)\,p^{-s}} =
   \sum_{n\ge 1} \frac{\chi (n)}{n^s}. \]
Entonces, se tiene
$$\zeta_K (s) = \zeta (s) \, L (s,\chi).$$
Invito que el lector revise el apéndice~\ref{ap:Dirichlet} para más detalles.

Recordamos que $\O_K = \ZZ [i]$ es un dominio de ideales principales y
$\O_K^\times = \{ \pm 1, \pm i \}$. Como consecuencia, todo ideal tiene forma
$I = (\alpha)$, y para $I \ne 0$ hay precisamente cuatro maneras de escoger un
generador $\alpha$. Si $\alpha = x + yi$, entonces $N_{K/\QQ} (I) = x^2 + y^2$.
Pongamos
$$C (n) = \# \{ (x,y) \in \ZZ^2 \mid x,y \ge 0, ~ x^2 + y^2 = n \}.$$

Tenemos entonces una identidad con series de Dirichlet
\[ \zeta_K (s) = \sum_{n\ge 1} \frac{C (n)}{n^s} =
\Bigl(\sum_{n\ge 1} \frac{1}{n^s}\Bigr)\,\Bigl(\sum_{n\ge 1} \frac{\chi (n)}{n^s}\Bigr). \]
Comparando los coeficientes, nos sale
$$C (n) = \sum_{d \mid n} \chi (d).$$
De la multiplicatividad del carácter $\chi$ se sigue también que
$C (mn) = C (m)\,C (n)$ si $m$ y $n$ son coprimos. Calculando ahora
\[ C (p^e) = \begin{cases}
  1, & \text{si } p = 2,\\
  e+1, & \text{si } p \equiv 1~(4),\\
  0, & \text{si } p \equiv 3~(4), ~ e\text{ impar},\\
  1, & \text{si } p \equiv 3~(4), ~ e\text{ par},\\
\end{cases} \]
se obtiene el siguiente curioso resultado que generaliza el teorema
de Fermat sobre los primos de la forma $x^2 + y^2$
(véase \ref{prop:fermat-primos-x2+y2}).

\begin{teorema}
  \label{thm:n-x2-y2}
  Supongamos que $n = p_1^{e_1}\cdots p_k^{e_k}$, donde los $p_i$ son diferentes
  primos.
  \begin{itemize}
  \item Si $p_i \equiv 3 \pmod{4}$ para algún $i$ y $e_i$ es impar, entonces
    $n$ no es una suma de dos cuadrados.

  \item En el caso contrario, hay precisamente
    $$C (n) = \prod_{p_i \equiv 1~(4)} (e_i + 1)$$
    representaciones de $n$ como una suma de dos cuadrados $x^2 + y^2$ con
    $x,y \in \NN$ (o $4\,C(n)$ si contamos $x,y\in \ZZ$ con diferentes signos).
  \end{itemize}
\end{teorema}

\begin{figure}
  \begin{center}
    \includegraphics{pic/circle-points.pdf}
  \end{center}

  \caption{$12$ puntos enteros en el círculo de radio $5$}
\end{figure}

\begin{comentario}
  Más adelante veremos que para cualquier extensión finita abeliana $K/\QQ$ se
  tiene una descomposición en ciertas series L de Dirichlet
  $$\zeta_K (s) = \prod_\chi L (s,\chi).$$
  En particular, para el carácter trivial sale el factor $\zeta (s)$.
  Más adelante veremos que $\zeta_K (s)$ determina la factorización de primos
  racionales en $\O_K$. La fórmula de arriba significa que
  \emph{en el caso abeliano} la factorización depende de $p$ mód $N$ para algún
  $N$. El caso no-abeliano es más complicado.
\end{comentario}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Fórmula analítica del número de clases}

Nuestro próximo gran objetivo será calcular el residuo en $s = 1$:
\[ \lim_{s \to 1^+} (s - 1)\,\zeta_K (s) =
   \frac{2^{r_1}\,(2\pi)^{r_2}\,\Reg_K\,h_k}{\#\mu_K\,\sqrt{|\Delta_K|}}. \]
Esta fórmula contiene todos los invariantes básicos de $K$ que hemos
considerado.
\begin{itemize}
\item El número de encajes reales $r_1$ y el número de pares de encajes
  complejos $r_2$.

\item El número de clases $h_K = \# \Cl (K)$.

\item El número de las raíces de la unidad $\# \mu_K = \# (\O_K^\times)_{tors}$.

\item El discriminante $\Delta_K$. Específicamente, aparece $\sqrt{|\Delta_K|}$
  que es el covolumen de $\O_K$ realizado como un retículo en el espacio
  $K_\RR$.

\item En fin, $\Reg_K$ es el \textbf{regulador} que, salvo una normalización,
  corresponde al covolumen de la parte libre del grupo de unidades
  $\O_K^\times$, realizada como un retículo en el espacio $H$ de dimensión
  $r_1 + r_2 - 1$. En la siguiente sección vamos a dar una definición más
  precisa.
\end{itemize}

Para $K = \QQ$ se pone $\Reg_\QQ = 1$, y la fórmula se reduce a
$\lim_{s \to 1^+} (s - 1)\,\zeta (s) = 1$.

\vspace{1em}

La fórmula del número de clases fue descubierta por Dirichlet para el caso de
campos cuadráticos, y la versión general es de Dedekind.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Regulador}

Vamos a ver con más detalle qué es el regulador y cómo calcularlo.
Recordemos nuestra prueba del teorema de unidades en
\S\ref{sec:teorema-de-unidades} con el encaje logarítmico de $\O_K^\times$.
Será conveniente numerar diferentes encajes $K\hookrightarrow \CC$ por
$$\sigma_1,\ldots,\sigma_{r_1},\sigma_{r_1+1},\overline{\sigma_{r_1+1}},\ldots,\sigma_{r_1+r_2},\overline{\sigma_{r_1+r_2}},$$
donde los primeros $r_1$ encajes son reales y el resto son complejos.

Tenemos la aplicación
\[ \Phi\colon K^\times \hookrightarrow K_\RR^\times, \quad
   \alpha \mapsto (\sigma_i (\alpha))_i, \]
y el encaje logarítmico
\[ \ell\colon K_\RR^\times \to \RR^{r_1 + r_2}, \quad
   (z_{\sigma_i}) \mapsto (n_i\,\log |z_{\sigma_i}|)_i, \]
donde
\[ n_i = \begin{cases}
  1, & \text{si }1 \le i \le r_1,\\
  2, & \text{si }r_1 < i \le r_1 + r_2.
  \end{cases} \]
Esto nos da el diagrama conmutativo
\[ \begin{tikzcd}
  \O_K^\times\ar[right hook->]{d}\ar{rr}{L} & & H\ar[right hook->]{d} \\
  K^\times \ar[right hook->]{r}{\Phi}\ar{d}[swap]{N_{K/\QQ}} & K_\RR^\times \ar{r}{\ell} & \RR^{r_1 + r_2} \ar{d}{\sum} \\
  \QQ^\times \ar{rr}{\log |\cdot|} & & \RR
\end{tikzcd} \]

Hemos probado que la aplicación $L$ realiza la parte libre de $\O_K^\times$ como
un retículo de rango completo $r = r_1 + r_2 - 1$ en el subespacio
$$H = \{ x \in \RR^{r_1 + r_2} \mid \sum_i x_i = 0 \}.$$
Como consecuencia, $L (u_1), \ldots, L (u_r)$ forman una base
de $H$, y podemos completarla a una base de $\RR^{r_1+r_2}$ añadiendo el vector
$$L = \frac{1}{\sqrt{r_1 + r_2}} \, (1,\ldots,1) \in \RR^{r_1 + r_2}.$$
El vector $(1,\ldots,1)$ es ortogonal a $H$, y con la normalización de
arriba, la longitud de $L$ es $1$. Esto significa que el covolumen de
$L (\O_K^\times)$ en $H$ es igual al volumen del paralelepípedo en
$\RR^{r_1+r_2}$ generado por los vectores $L, L (u_1), \ldots, L (u_r)$; es
decir,
\[ \covol L (\O_K^\times) = \pm \det \begin{pmatrix}
  L_1 & L_1 (u_1) & L_1 (u_2) & \cdots & L_1 (u_{r_1+r_2-1}) \\
  L_2 & L_2 (u_1) & L_2 (u_1) & \cdots & L_2 (u_{r_1+r_2-1}) \\
  \vdots & \vdots & \vdots & \ddots & \vdots \\ 
  L_{r_1 + r_2} & L_{r_1 + r_2} (u_1) & L_{r_1+r_2} (u_2) & \cdots & L_{r_1+r_2-1} (u_{r_1+r_2-1})
\end{pmatrix} \]
Ahora podemos sumar a la $i$-ésima fila de la matriz de arriba todas las filas.
Como resultado, en la $i$-ésima fila estará el vector
$$(\sqrt{r_1 + r_2}, 0, \ldots, 0)$$
---puesto que $L (u_j) \in H$, se tiene $\sum_i L_i (u_j) = 0$.
Esto nos lleva al siguiente resultado.

\begin{proposicion-definicion}
  El covolumen del retículo $L (\O_K^\times)$ en $H$ es igual a
  $$\sqrt{r_1 + r_2} \, \Reg_K,$$
  donde $\Reg_K$ es el valor absoluto del determinante de cualquier menor
  de rango $r_1 + r_2 - 1$ de la matriz
  \[ (L_i (u_j))_{\substack{1 \le i \le r_1 + r_2 \\ 1 \le j \le r_1 + r_2 - 1}} =
     (n_i \log |\sigma_i (u_j)|)_{\substack{1 \le i \le r_1 + r_2 \\ 1 \le j \le r_1 + r_2 - 1}}. \]
  El número $\Reg_K > 0$ se llama el \textbf{regulador} de $K$.
\end{proposicion-definicion}

Si $\O_K^\times = \mu_K$ es un grupo finito (lo que puede pasar solo si
$K = \QQ$ o $K = \QQ (\sqrt{-d})$ es un campo cuadrático imaginario),
entonces se pone $\Reg_K = 1$.

\begin{ejemplo}
  Si $K = \QQ (\sqrt{d})$ es un campo cuadrático real, entonces su regulador
  será $\log |u|$, donde $u$ es la unidad fundamental de $\O_K^\times$.
\end{ejemplo}

\begin{ejemplo}
  Para el campo $K = \QQ (\zeta_7)$ podemos calcular con ayuda de computadora
  que como unidades fundamentales, se pueden tomar
  $$u_1 = 1 + \zeta_7, \quad u_2 = \zeta_7 + \zeta_7^4.$$
  En este caso $r_1 = 0$ y $r_2 = 3$. Los encajes complejos, salvo conjugación,
  serán
  \[ \sigma_1\colon \zeta_7 \mapsto \zeta_7, \quad
     \sigma_2\colon \zeta_7 \mapsto \zeta_7^2, \quad
     \sigma_3\colon \zeta_7 \mapsto \zeta_7^3. \]
  Tenemos entonces
  \[ \Reg_K = \pm\det\begin{pmatrix}
    2\,\log |1 + \zeta_7| & 2\,\log |\zeta_7 + \zeta_7^4| \\
    2\,\log |1 + \zeta_7^2| & 2\,\log |\zeta_7^2 + \zeta_7| \\
  \end{pmatrix} = 2.101818\ldots \qedhere \]
\end{ejemplo}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% \pdfbookmark{Clase 26 (18/11/20)}{clase-26}
\section{Ejemplos de uso de la fórmula del número de clases}
\marginpar{\small Clase 26 \\ 18/11/20}

Antes de probar la fórmula, podemos ver algunos ejemplos de su uso. Consideremos
el campo cuadrático real $K = \QQ (\sqrt{5})$. Argumentando de la misma manera
que en \S\ref{sec:funcion-zeta-de-Q(i)}, se demuestra la identidad
$$\zeta_K (s) = \zeta (s) \, L (s,\chi),$$
donde $\chi (n) = \legendre{n}{5}$.
Ahora $L (s,\chi)$ converge en $s = 1$ a un valor no nulo, mientras que
$\lim_{s\to 1^+} (s - 1)\,\zeta (s) = 1$, así que
$$\lim_{s \to 1^+} (s - 1)\,\zeta_K (s) = L (1,\chi).$$

En general, para el carácter cuadrático $\chi (n) = \legendre{n}{p}$ mód $p$
se tiene
$$\exp (g (\chi)\,L (1,\chi)) = \prod_n (1 - \zeta_p^n)\,\prod_r (1 - \zeta_p)^{-1},$$
donde
$$g (\chi) = \sum_{1 \le a \le p-1} \chi (a)\,\zeta_p^a$$
es la \textbf{suma de Gauss}, y los productos son sobre los no-residuos y
residuos cuadráticos mód $p$ respectivamente. Para la prueba, véase
el ejercicio~\ref{ejerc:L-series-caracter-cuadratico-mod-p}.

En nuestro caso calculamos que
$$g (\chi) = \zeta_5 - \zeta_5^2 - \zeta_5^3 + \zeta_5^4 = \sqrt{5}$$
y
$$(1 - \zeta_p^2)\,(1 - \zeta_5^3)\,(1 - \zeta_5)^{-1}\,(1 - \zeta_5^4)^{-1} = \frac{3 + \sqrt{5}}{2}.$$
Entonces,
\begin{equation}
  \label{eq:formula-de-clases-sqrt5-1}
  \lim_{s \to 1^+} (s - 1)\,\zeta_K (s) =
  L (1, \chi) = \frac{1}{\sqrt{5}}\,\log\frac{3 + \sqrt{5}}{2}.
\end{equation}

El regulador en este caso será igual a $\log u$, donde
$u = \frac{1+\sqrt{5}}{2}$ es la unidad fundamental de $\O_K^\times$.
Tenemos $r_1 = 2$, $r_2 = 0$ y $\mu_K = \{ \pm 1 \}$, $\Delta_K = 5$, y la
fórmula del número de clases nos da entonces
\begin{equation}
  \label{eq:formula-de-clases-sqrt5-2}
  \lim_{s \to 1^+} (s - 1)\,\zeta_K (s) =
  \frac{2^{r_1}\,(2\pi)^{r_2}\,\Reg_K\,h_K}{\#\mu_K\,\sqrt{|\Delta_K|}} =
  \frac{1}{\sqrt{5}}\,h_K\cdot 2\,\log \frac{1+\sqrt{5}}{2}.
\end{equation}
En fin,
\[ 2\,\log \frac{1+\sqrt{5}}{2} =
   \log \left(\frac{1+\sqrt{5}}{2}\right)^2 =
   \log \frac{3+\sqrt{5}}{2}. \]
Comparando \eqref{eq:formula-de-clases-sqrt5-1} y
\eqref{eq:formula-de-clases-sqrt5-2}, podemos concluir que $h_K = 1$.

\vspace{1em}

Si $K = \QQ[x]/(f)$, entonces para calcular el residuo de $\zeta_K (s)$ en
$s = 1$ en PARI/GP, basta digitar \texttt{lfun($f$, 1)}. Calculamos el residuo
para $K = \QQ (\sqrt{10})$.
\begin{shaded}
\begin{verbatim}
? lfun (x^2 - 10, 1)
% = 1.1500865228483708943221826442284221318*x^-1 + O(x^0)
\end{verbatim}
\end{shaded}

La unidad fundamental en este caso es $u = 3 + \sqrt{10}$, el discriminante
es $\Delta_K = 40$, así que
\[ \lim_{s \to 1^+} (s - 1)\,\zeta_K (s) =
   \frac{2^{r_1}\,(2\pi)^{r_2}\,\Reg_K\,h_k}{\#\mu_K\,\sqrt{|\Delta_K|}} =
   \frac{2}{\sqrt{40}}\,\log (3 + \sqrt{10})\cdot h_K. \]
\begin{shaded}
\begin{verbatim}
? 2 / sqrt (40) * log (3 + sqrt(10))
% = 0.57504326142418544716109132211421106589
? polcoef (lfun (x^2 - 10, 1), -1) / %
% = 2.0000000000000000000000000000000000000
\end{verbatim}
\end{shaded}
Esto nos permite concluir que $h_K = 2$.

De hecho, en este caso también se puede ocupar una descomposición
$\zeta_K (s) = \zeta (s) \, L (s,\chi)$ para cierto carácter de Dirichlet $\chi$
(véase ejercicio~\ref{ejerc:caracter-para-campo-cuadratico}), y luego obtener
el valor de $L (1,\chi)$, pero no quiero entrar en los detalles de este cálculo.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Número de clases de \texorpdfstring{$\QQ (\sqrt{-p})$}{ℚ(√−p)}}

Ahora vamos a aplicar la fórmula del número de clases a campos cuadráticos
imaginarios $K = \QQ (\sqrt{-d})$. En particular, tomemos $d = p$ primo, $p > 3$
y $p \equiv 3 \pmod{4}$. En este caso $\Delta_K = -p$, $\O_K^\times = \mu_K = \{ \pm 1 \}$,
y $Reg_K = 1$. Tenemos entonces
\[ \lim_{s \to 1^+} (s - 1)\,\zeta_K (s) =
   \frac{2^{r_1}\,(2\pi)^{r_2}\,\Reg_K\,h_k}{\#\mu_K\,\sqrt{|\Delta_K|}} =
   \frac{\pi}{\sqrt{p}}\,h_K. \]

Notamos que bajo nuestra hipótesis de que $p \equiv 3\pmod{4}$, la factorización
de un primo racional $q$ en $\O_K$ depende del símbolo de Legendre
$\legendre{q}{p}$, y como en \S\ref{sec:funcion-zeta-de-Q(i)} se demuestra la
identidad
$$\zeta_K (s) = \zeta (s)\,L (s,\chi),$$
donde $\chi (n) = \legendre{n}{p}$. Esto implica que
$$\lim_{s \to 1^+} (s - 1)\,\zeta_K (s) = L (1,\chi),$$
y luego
$$h_K = \frac{\sqrt{p}}{\pi}\,L (1,\chi).$$

Podemos de nuevo ocupar la fórmula
$$\exp (g (\chi)\,L(1,\chi)) = \prod_n (1 - \zeta_p^n)\,\prod_r (1 - \zeta_p)^{-1}.$$

Usando el lema~\ref{lema:QR-3} sobre las sumas cuadráticas de Gauss, tenemos
\[ g (\chi) = \begin{cases}
  \pm\sqrt{p}, & p \equiv 1 \pmod{4},\\
  \pm i\sqrt{p}, & p \equiv 3 \pmod{4}.
\end{cases} \]
De hecho, el famoso cálculo de Gauss dice que el signo es $+1$ en ambos
casos. Para la prueba, véase por ejemplo \cite[Chapter~6]{Ireland-Rosen}.
De todos modos, estamos calculando $h_K$ que es un número positivo, así que
el signo no es tan relevante y podríamos determinarlo al final del cálculo.

Tomando los logaritmos, se obtiene (módulo $2\pi i\ZZ$)
$$L(1,\chi) = -\frac{1}{i\sqrt{p}}\,\sum_{1 \le a \le p-1} \chi (a)\,\log (1 - \zeta_p^a).$$
Nos interesa la suma
$$S_\chi = -\sum_{1 \le a \le p-1} \chi (a)\,\log (1 - \zeta_p^a).$$
Notamos que $\chi (-1) = -1$ (usando la hipótesis $p \equiv 3 \pmod{4}$),
así que podemos escribir
\[ 2 S_\chi = \sum_{1 \le a \le p-1} \chi (a)\,\Bigl(\log (1 - \zeta_p^{-a}) - \log (1 - \zeta_p^a)\Bigr) =
   \sum_{1 \le a \le p-1} \chi (a)\,\log \frac{1 - \zeta_p^{-a}}{1 - \zeta_p^a}. \]
Aquí
\[ \log \frac{1 - \zeta_p^{-a}}{1 - \zeta_p^a} =
   \log (-\zeta_p^{-a}) =
   \log \exp \left(\pi i - \frac{2\pi i a}{p}\right) =
   2\pi i\,\left(\frac{1}{2} - \frac{a}{p}\right). \]
Entonces,
$$S_\chi = -\frac{\pi i}{p}\,\sum_{1 \le a \le p-1} \chi (a)\,a,$$
y luego
\[ h_K = \frac{\sqrt{p}}{\pi}\,L(1,\chi) =
   \frac{\sqrt{p}}{\pi}\,\frac{1}{i\sqrt{p}}\,S_\chi =
   -\frac{1}{p}\,\sum_{1 \le a \le p-1} \chi (a)\,a. \]
Esta expresión todavía puede ser simplificada.

\begin{lema}
  Sea $p$ un primo, $p > 3$ tal que $p \equiv 3 \pmod{4}$. Entonces, para el
  carácter $\chi (a) = \legendre{a}{p}$ se tiene
  \[ \frac{1}{p}\sum_{1 \le a \le p-1} \chi (a)\,a =
  \begin{cases}
    -\frac{1}{3}\sum\limits_{1 \le a < p/2} \chi (a), & \text{si }p\equiv 3\pmod{8},\\
    -\sum\limits_{1 \le a < p/2} \chi (a), & \text{si }p\equiv 7\pmod{8}
  \end{cases} \]

  \begin{proof}
    Pongamos
    $$C = \frac{1}{p}\sum_{1 \le a \le p-1} \chi (a)\,a.$$
    Podemos escribir (recordamos que $p \equiv 3 \pmod{4}$, así que
    $\chi (-1) = -1$)
    \begin{multline}
      \label{eq:suma-de-caracteres-chi(a)-a-1}
      p C = \sum_{1 \le a \le p-1} \chi (a)\,a =
      \sum_{1 \le a < p/2} \chi (a)\,a + \sum_{1 \le a < p/2} \chi (p-a)\,(p-a) \\
      = 2\sum_{1 \le a < p/2} \chi (a)\,a - p\sum_{1 \le a < p/2} \chi (a).
    \end{multline}
    Por otra parte,
    \begin{multline}
      \label{eq:suma-de-caracteres-chi(a)-a-2}
      p C = \sum_{1 \le a \le p-1} \chi (a)\,a =
      \sum_{\substack{1 \le a \le p-1 \\ a \text{ par}}} \chi (a)\,a + \sum_{\substack{1 \le a \le p-1 \\ a \text{ par}}} \chi (p-a)\,(p-a) = \\
      \sum_{1 \le a < p/2} \chi (2a)\,2a + \sum_{1 \le a < p/2} \chi (p-2a)\,(p-2a) = \\
      = 4\,\chi(2)\,\sum_{1 \le a < p/2} \chi (a)\,a - p\,\chi(2)\,\sum_{1 \le a < p/2} \chi (a).
    \end{multline}

    Ahora comparando \eqref{eq:suma-de-caracteres-chi(a)-a-1}
    y \eqref{eq:suma-de-caracteres-chi(a)-a-2}, nos sale
    \[ C \, (2\chi (2) - 1) = -\chi(2)\sum_{1 \le a < p/2} \chi (a). \]
    Recordamos que
    \[ \chi (2) = \begin{cases}
      -1, & p \equiv 3 \pmod{8},\\
      +1, & p \equiv 7 \pmod{8}.
    \end{cases} \qedhere \]
  \end{proof}
\end{lema}

Nuestros cálculos nos llevan entonces al siguiente resultado
(que ya fue mencionado en \S\ref{sec:campos-cuadraticos-imaginarios}).

\begin{teorema}[Dirichlet]
  Sea $p > 3$ un primo tal que $p \equiv 3 \pmod{4}$. Consideremos el campo
  cuadrático imaginario $K = \QQ (\sqrt{-p})$. Si $p \equiv 7 \pmod{8}$,
  entonces
  $$h_K = \sum_{1 \le a < p/2} \legendre{a}{p},$$
  y si $p \equiv 3 \pmod{8}$, entonces
  $$h_K = \frac{1}{3}\,\sum_{1 \le a < p/2} \legendre{a}{p}.$$
\end{teorema}

\begin{corolario}
  Si $p \equiv 3 \pmod{4}$, entonces el intervalo $[1, (p-1)/2]$ contiene más
  residuos que no-residuos cuadráticos.
\end{corolario}

La fórmula de arriba implica una cota lineal sobre $h_K$ en términos de $p$.
De hecho, para las sumas de caracteres existen cotas mejores, no triviales.

\begin{proposicion}[Pólya--Vinogradov]
  Para el carácter $\chi = \legendre{\cdot}{p}$ tenemos
  $$\Bigl|\sum_{m \le t \le n} \chi (t)\Bigr| < \sqrt{p}\,\log p$$
  para cualesquiera $m$ y $n$.

  \begin{proof}
    Según el lema~\ref{lema:QR-2} se cumple
    $$\chi (t) \, g (\chi) = g_t (\chi),$$
    donde
    $$g_t (\chi) = \sum_{1 \le a \le p-1} \chi(t)\,\zeta_p^{at},$$
    y en particular $g (\chi) = g_1 (\chi)$. Ahora
    \[ \sum_{m \le t \le n} \chi(t) =
       \frac{1}{g (\chi)}\,\sum_{m \le t \le n} g_t (\chi) =
       \frac{1}{g (\chi)}\,\sum_{m \le t \le m+k} g_t (\chi), \]
    donde $k \le p$ (usando que $\sum_{1 \le t \le p-1} \chi(t) = 0$).
    Vamos a analizar la expresión
    \[ \Bigl|\sum_{m \le t \le m+k} g_t (\chi)\Bigr| =
       \Bigl|\sum_{m \le t \le m+k} \sum_{1 \le a \le p-1} \chi(a) \zeta_p^{at}\Bigr| =
       \Bigl|\sum_{1 \le a \le p-1} \chi(a) \sum_{m \le t \le m+k} \zeta_p^{at}\Bigr| =
       \left|\sum_{1 \le a \le p-1} \chi(a) \zeta_p^{am}\,\frac{\zeta_p^{a\,(k+1)} - 1}{\zeta_p^a - 1}\right|. \]
    Ocuparemos la cota
    \[ \Bigl|\sum_{m \le t \le m+k} g_t (\chi)\Bigr| \le
       \sum_{1 \le a \le p-1} \left|\frac{\zeta_p^{a\,(k+1)} - 1}{\zeta_p^a - 1}\right|. \]
    Notamos que
    \[ |\zeta_p^{a\,(k+1)} - 1| \le 2, \quad
       |\zeta_p^a - 1| = 2\,\left|\sin \left(\frac{a\pi}{p}\right)\right|. \]
    Además,
    \[ \left|\sin \left(\frac{a\pi}{p}\right)\right| =
       \left|\sin \left(\frac{(p-a)\,\pi}{p}\right)\right|. \]
    Juntando todo esto, se obtiene
    \[ \Bigl|\sum_{m \le t \le m+k} g_t (\chi)\Bigr| \le
       \sum_{1 \le a \le p-1} \left|\frac{1}{\sin \left(\frac{a\pi}{p}\right)}\right| =
       2\,\sum_{1 \le a \le \frac{p-1}{2}} \left|\frac{1}{\sin \left(\frac{a\pi}{p}\right)}\right|. \]
    Usando la desigualdad $\sin x \ge \frac{2}{\pi}\,x$ para un ángulo agudo
    $x$, obtenemos la cota
    \[ \Bigl|\sum_{m \le t \le m+k} g_t (\chi)\Bigr| \le
       2\sum_{1 \le a \le \frac{p-1}{2}} \frac{1}{\frac{2}{\pi}\,\frac{a \pi}{p}} =
       p\sum_{1 \le a \le \frac{p-1}{2}} \frac{1}{a} \le p\,\log p. \]
    Aquí la última desigualdad viene de $\log p = \int_1^p \frac{dx}{x}$.
    En fin,
    \[ \Bigl|\sum_{m \le t \le n} \chi (t)\Bigr| =
       \frac{1}{|g (\chi)|}\,\Bigl|\sum_{m \le t \le m+k} g_t (\chi)\Bigr| \le
       \frac{1}{\sqrt{p}}\,p\,\log p =
       \sqrt{p}\,\log p. \qedhere \]
  \end{proof}
\end{proposicion}

\begin{comentario}
  En general, para cualquier carácter de Dirichlet $\chi$ mód $N$ la suma de
  caracteres puede ser acotada como $O (\sqrt{N}\,\log N)$. Bajo la hipótesis
  de Riemann generalizada, esta cota se generaliza a
  $O (\sqrt{N}\,\log\log N)$.
\end{comentario}

\begin{comentario}
  En general, para \emph{cualquier} campo cuadrático $K = \QQ (\sqrt{d})$
  (imaginario o real) se puede definir un carácter $\chi$ módulo $|\Delta_K|$
  que gobierna la factorización de primos en $\O_K$ y nos lleva a la fórmula
  $$\zeta_K (s) = \zeta (s) \, L (s,\chi)$$
  ---véase ejercicio~\ref{ejerc:caracter-para-campo-cuadratico}.
  Luego los métodos parecidos a los de arriba nos permiten calcular $h_K$
  en términos de $L (1,\chi)$ (y $\log u$ para la unidad fundamental $u$ en el
  caso de campos reales). Para los detalles, véase
  \cite[Chapter~5]{Borevich-Shafarevich}.
\end{comentario}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% \pdfbookmark{Clase 27 (23/11/20)}{clase-27}
\section{Demostración de la fórmula del número de clases}
\marginpar{\small Clase 27 \\ 23/11/20}

El objetivo de esta sección será probar la fórmula analítica del número de
clases
\[ \lim_{s \to 1^+} (s - 1)\,\zeta_K (s) =
   \frac{2^{r_1}\,(2\pi)^{r_2}\,\Reg_K\,h_k}{\#\mu_K\,\sqrt{|\Delta_K|}}. \]
La prueba es algo larga y técnica, así que al principio explicaré la estrategia
general, omitiendo algunos detalles técnicos. Mi referencia es
\cite{Borevich-Shafarevich}.

Primero vamos a partir
$\zeta_K (s)$ en $h_K$ series
\[ \zeta_K (s) = \sum_{I\ne 0} \frac{1}{N_{K/\QQ} (I)^s} =
   \sum_{c\in \Cl (K)} \zeta_c (s),
   \quad\text{donde }
   \zeta_c (s) = \sum_{[I] = c} \frac{1}{N_{K/\QQ} (I)^s}. \]
A continuación veremos que cada una de estas series tiene el mismo residuo
\[ \lim_{s \to 1^+} (s - 1)\,\zeta_c (s) =
   \frac{2^{r_1}\,(2\pi)^{r_2}\,\Reg_K}{\#\mu_K\,\sqrt{|\Delta_K|}}. \]
Esto claramente implicaría la fórmula del número de clases.

\vspace{1em}

Para cada clase $c \in \Cl (K)$ fijemos un ideal entero $I' \subseteq \O_K$
tal que $[I'] = c^{-1}$. Ahora para todo ideal entero $I \subseteq \O_K$ tal que
$[I] = c$ se tiene $I I' = \alpha \O_K$ para algún $\alpha \in \O_K$ no nulo.
Esto nos da una biyección
\[ \{ I \subseteq \O_K \mid [I] = c \} \leftrightarrow
\{ \text{ideales principales } \alpha\O_K \mid \alpha \in I' \}. \]
Tenemos $N_{K/\QQ} (I) \, N_{K/\QQ} (I') = |N_{K/\QQ} (\alpha)|$, y entonces
$$\zeta_c (s) = N_{K/\QQ} (I')^s \sum_{\substack{0 \ne (\alpha) \subseteq \O_K \\ \alpha \in I'}} \frac{1}{|N_{K/\QQ} (\alpha)|^s}.$$
La suma es sobre todos los ideales principales generados por los elementos
$\alpha \in I'$, que es lo mismo que la suma sobre los $\alpha \in I'$ considerados
módulo la relación $\sim$.

\vspace{1em}

El grupo de unidades $\O_K^\times$ actúa sobre el espacio complejo $K_\CC$
mediante la multiplicación punto por punto
$$u \cdot x = \Phi (u)\,x,$$
y no es difícil ver que esta acción se restringe al subconjunto
$K_\RR^\times$. Para esta acción se puede obtener una construcción explícita de
un dominio fundamental $X \subset K_\RR^\times$ en términos de las raíces de
la unidad $\mu_K$ y las unidades fundamentales
$u_1,\ldots,u_{r_1+r_2-1} \in \O_K^\times$. La daremos más adelante,
y la conclusión será la siguiente.

\begin{teorema}
  \label{thm:X-dominio-fundamental-de-OK*}
  Existe un subconjunto $X \subset K_\RR^\times$ que satisface las siguientes
  condiciones.
  \begin{enumerate}
  \item[1)] $X$ es un \textbf{cono}: si $x \in X$, entonces $\lambda x \in X$
    para todo $\lambda > 0$.

  \item[2)] $X$ es un dominio fundamental de la acción de $\O_K^\times$ sobre
    $K_\RR^\times$: para todo punto $y \in K_\RR^\times$ existen únicos
    $u \in \O_K^\times$ y $x \in X$ tales que $y = \Phi (u)\,x$.

  \item[3)] El subconjunto $T = \{ x \in X \mid \prod_i |x_i| \le 1 \}$
    es acotado y se tiene
    \begin{equation}
      \label{eq:vol-T}
      \vol T = \frac{2^{r_1}\,(2\pi)^{r_2}\,\Reg_K}{\# \mu_K}.
    \end{equation}
  \end{enumerate}
\end{teorema}

Para la construcción de $X$, véase \S\ref{sec:dominio-fundamental-X}, y para el
cálculo de $\vol T$, refiero a \S\ref{sec:vol-T}. Por el momento propongo
considerar un par de ejemplos particulares cuando $K = \QQ (\sqrt{d})$ es un
campo cuadrático.

\begin{ejemplo}
  \label{ejemplo:conjunto-X-Q(sqrt-3)}
  Consideremos el campo cuadrático imaginario $K = \QQ (\sqrt{-3})$.
  Tenemos un isomorfismo
  \[ K_\RR \cong \RR^2, \quad
     (z_\sigma, z_{\overline{\sigma}}) \mapsto (\Re z_\sigma, \Im z_\sigma). \]
  El grupo de unidades es $\O_K^\times = \mu_6 (\CC)$. La multiplicación por
  $\sigma (\zeta_6) = \exp \Bigl(\frac{2\pi i}{6}\Bigr)$ corresponde a
  la rotación del plano complejo respecto al origen por el ángulo $\pi/3$,
  y entonces como un dominio fundamental podemos tomar
  $$X = \{ z \in \CC \mid 0 \le \arg z < \frac{\pi}{3} \}.$$
  El conjunto $T$ es la intersección de $X$ con el círculo definido por
  $|z| = 1$.

  \begin{center}
    \includegraphics{pic/X-T-sqrt-minus-3.pdf}
  \end{center}

  El área de $T$ es
  $$\vol (T) = 2^{r_2}\,\vol_{Leb.} (T) = \frac{\pi}{3}.$$
  Esto corresponde a la fórmula general
  $\vol T = \frac{2^{r_1}\,(2\pi)^{r_2}\,\Reg_K}{\#\mu_K}$.
\end{ejemplo}

\begin{ejemplo}
  \label{ejemplo:conjunto-X-Q(sqrt3)}
  Consideremos el campo cuadrático real $K = \QQ (\sqrt{3})$. En este caso
  $K_\RR \cong \RR^2$. El grupo de unidades será
  $$\O_K^\times = \{ \pm u^n \mid n \in \ZZ \},$$
  donde $u = 2 + \sqrt{3}$ es la unidad fundamental.

  Primero podemos ponernos de acuerdo que para $(x,y) \in X$ se tiene
  $x > 0$. De esta manera se escogen representantes únicos respecto a la acción
  de $\mu_K = \{ \pm 1 \}$, y nos queda ver qué sucede con la acción de la parte
  libre $\langle u\rangle$.  Esta viene dada por
  $$\Phi (u^n)\cdot (x,y) = ((2 + \sqrt{3})^n\,x, (2 - \sqrt{3})^n\,y).$$
  Consideremos el encaje logarítmico
  \[ \ell\colon K_\RR^\times = (\RR^\times)^2 \to \RR^2, \quad
     (x,y) \mapsto (\log |x|, \log |y|). \]
  Como una base del subespacio
  $$H = \{ (x,y) \in \RR^2 \mid x+y = 0 \}$$
  se puede tomar el vector
  $$L (u) = (\log (2 + \sqrt{3}), \log (2 - \sqrt{3})).$$
  Podemos completarlo a una base de $\RR^2$ con el vector
  $(1,1)$. Todo elemento de $\RR^2$ se expresa entonces de manera única como
  $$\lambda\,L (u) + \mu\,(1,1)$$
  para algunos $\lambda, \mu \in \RR$. En particular, para todo
  $(x,y) \in K_\RR^\times$
  \begin{equation}
    \tag{*} \ell (x,y) = (\log |x|, \log |y|) = \lambda\,L (u) + \mu\,(1,1).
  \end{equation}

  Afirmamos que como dominio fundamental $X$ se pueden tomar
  los $(x,y) \in K_\RR^\times$ tales que $0 \le \lambda < 1$ en la expresión de
  arriba. En efecto, si $(x,y) \in K_\RR^\times$ es cualquier punto tal que
  $\ell (x,y)$ tiene coordenadas $\lambda$ y $\mu$ en (*), entonces tomamos
  $n = \lfloor\lambda\rfloor$, y luego
  \[ \ell (\Phi (u^{-n})\,(x,y)) = L (u^{-n}) + \ell (x,y) =
     (\underbrace{\lambda - n}_{< 1})\,L(u) + \mu\,(1,1). \]
  Entonces, cualquier punto de $K_\RR^\times$ puede ser enviado al dominio
  fundamental $X$ actuando por alguna unidad en $\O_K^\times$. Por otra parte,
  podemos ver que los elementos de $X$ no pueden ser identificados por una
  acción de $\O_K^\times$. Consideremos dos puntos $(x,y)$, $(x',y') \in X$:
  \begin{align*}
    \ell (x,y) & = \lambda\,L (u) + \mu\,(1,1), \\
    \ell (x', y') & = \lambda'\,L (u) + \mu'\,(1,1),
  \end{align*}
  con $0 \le \lambda,\lambda' \le 1$, y supongamos que para algún
  $n \in \ZZ$ se tiene
  $$\Phi (u^n)\,(x,y) = (x',y').$$
  Aplicando el encaje logarítmico $\ell$, se obtiene
  $$(\lambda + n)\,L(u) + \ell (x,y) = \lambda'\,L (u) + \ell (x',y'),$$
  y entonces
  $$\lambda + n = \lambda', \quad \mu + \mu'.$$
  Dado que $0 \le \lambda,\lambda' \le 1$, esto es posible si y solamente si
  $n = 0$, pero luego $(x,y) = (x',y')$.

  \vspace{1em}

  Llegamos a la conclusión que $X$ consiste en los puntos
  $(x,y) \in K_\RR^\times = (\RR^\times)^2$ tales que
  \begin{align*}
    \log |x| & = \lambda\,\log (2 + \sqrt{3}) + \mu,\\
    \log |y| & = \lambda\,\log (2 - \sqrt{3}) + \mu,
  \end{align*}
  donde $0 \le \lambda < 1$ y $x > 0$. De aquí es fácil ver que $X$ será la
  unión de dos conos
  \[ C_1 = \langle (1,+1), \, (2 + \sqrt{3}, +2 - \sqrt{3}) \rangle, \quad
     C_2 = \langle (1,-1), \, (2 + \sqrt{3}, -2 + \sqrt{3}) \rangle. \]
  El subconjunto $T \subset X$ está acotado por la curva $xy = \pm 1$.

  \begin{center}
    \includegraphics{pic/X-T-sqrt-plus-3.pdf}
  \end{center}

  No es difícil calcular que el área de $T$ es
  $$2\int_1^{2 + \sqrt{3}} \frac{dx}{x} = 2\log (2 + \sqrt{3}),$$
  lo que corresponde a la fórmula
  $\vol T = \frac{2^{r_1}\,(2\pi)^{r_2}\,\Reg_K}{\#\mu_K}$.
\end{ejemplo}

De la parte 2) del teorema \ref{thm:X-dominio-fundamental-de-OK*} se deduce
fácilmente el siguiente resultado.

\begin{corolario}
  Para todo $\alpha \in \O_K$ no nulo existe único $\beta \sim \alpha$ tal que
  $\Phi (\beta) \in X$.

  \begin{proof}
    La acción de $\O_K^\times$ sobre $K_\RR^\times$ se restringe a una acción
    sobre $\Lambda\setminus \{ 0 \} = \Phi (\O_K \setminus \{ 0 \})$.
  \end{proof}
\end{corolario}

Volvamos a nuestra expresión
$$\zeta_c (s) = N_{K/\QQ} (I')^s \sum_{\substack{0 \ne (\alpha) \subseteq \O_K \\ \alpha \in I'}} \frac{1}{|N_{K/\QQ} (\alpha)|^s}.$$
Denotemos por $\Lambda$ el retículo $\Phi (I') \subset K_\RR$. Denotemos por
$N\colon K_\RR \to \RR$ el producto de coordenadas $x \mapsto \prod_i x_i$.
En este caso $N_{K/\QQ} (\alpha) = N (\Phi (\alpha))$. Ocupando el último
corolario, podemos escribir entonces
$$\zeta_c (s) = N_{K/\QQ} (I')^s \sum_{\omega \in \Lambda \cap X} \frac{1}{|N (\omega)|^s}.$$

Para calcular el residuo de esta serie en $s = 1$, vamos a formular el siguiente
teorema general.

\begin{teorema}
  \label{thm:residuo-de-Z(s)}
  Sean $X$ un cono en $(\RR^\times)^n$, $F\colon X\to \RR_{>0}$ una función
  positiva, y $\Lambda \subset X$ un retículo de rango completo. Supongamos que
  se cumplen las siguientes condiciones.
  \begin{enumerate}
  \item[a)] Para cualesquiera $x \in X$ y $\lambda > 0$ se cumple
    $F (\lambda x) = \lambda^n\,F (x)$.

  \item[b)] El subconjunto $T = \{ x\in X \mid F (x) \le 1 \}$ es acotado
    y tiene volumen no nulo.
  \end{enumerate}
  Entonces, la serie
  $$Z (s) = \sum_{\omega \in \Lambda \cap X} \frac{1}{F (x)^s}$$
  converge para $s > 1$, y se tiene
  $$\lim_{s \to 1^+} (s-1)\,Z (s) = \frac{\vol T}{\covol \Lambda}.$$
\end{teorema}

Veremos la prueba en \S\ref{sec:conos-reticulos-y-residuo-en-s=1}.
En nuestra situación, podemos aplicar el teorema a la función
$F\colon x \mapsto |N (x)|$ sobre $X \subset K_\RR^\times$,
y el subconjunto $T \subset X$. Recordamos que el espacio $K_\RR$ no es
precisamente $\RR^n$, sino tiene estructura euclidiana ligeramente distinta,
respecto a cual $\vol = 2^{r_2}\,\vol_{Leb.}$, pero esto será irrelevante porque
nos sale el cociente de dos volúmenes.

Como ya sabemos,
$$\covol \Lambda = \sqrt{|\Delta_K|}\,N_{K/\QQ} (I'),$$
y por otra parte, calcularemos que el volumen de $T$ viene dado por
\eqref{eq:vol-T}. Esto nos permite concluir que
$$\lim_{s\to 1^+} (s-1)\,\zeta_c (s) = \frac{2^{r_1}\,(2\pi)^{r_2}\,\Reg_K}{\#\mu_K\,\sqrt{|\Delta_K|}}.$$

Entonces, para terminar la prueba, nos falta lo siguiente:
\begin{itemize}
\item[1)] demostrar el teorema \ref{thm:residuo-de-Z(s)} sobre el residuo de
  $Z (s) = \sum_{\omega \in \Lambda \cap X} \frac{1}{F (x)^s}$ en $s = 1$;
\item[2)] obtener una buena descripción para un dominio fundamental
  $X \subset K_\RR^\times$ de la acción de $\O_K^\times$;
\item[3)] calcular el volumen \eqref{eq:vol-T} del subconjunto $T \subset X$.
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Conos, retículos y residuo en $s = 1$}
\label{sec:conos-reticulos-y-residuo-en-s=1}

Primero vamos a probar el teorema~\ref{thm:residuo-de-Z(s)}.
Tenemos un retículo de rango completo $\Lambda \subset \RR^n$ y un cono
$X \subset (\RR^\times)^n$ junto con una función $F\colon X\to \RR_{>0}$ que es
homogénea en el sentido de que
$$F (\lambda x) = \lambda^n\,F (x).$$
Consideremos el conjunto
$$T = \{ x \in X \mid F (x) \le 1 \}$$
que es acotado y de volumen finito no nulo. Nos interesa probar que la serie
$$Z (s) = \sum_{\omega \in \Lambda \cap X} \frac{1}{F (x)^s}$$
converge para $s > 1$ y tiene residuo $\frac{\vol T}{\covol \Lambda}$ en
$s = 1$.

\vspace{1em}

El punto clave es una interpretación de volúmenes en términos del conteo de
puntos en retículos. Para un parámetro $r > 0$ vamos a considerar el retículo
$\frac{1}{r}\Lambda$. Notamos que
$\covol\Bigl(\frac{1}{r}\Lambda\Bigr) = \frac{1}{r^n}\,\covol (\Lambda)$.
Definamos
\[ C (r) = \# \{ \omega \in \frac{1}{r}\Lambda \mid \omega \in T \}
         = \# \{ \omega \in \Lambda \mid \omega \in rT \}
         = \# \{ \omega \in \Lambda \cap X \mid F (\omega) \le r^n \}. \]
Tenemos entonces
\[ \vol T = \lim_{r\to\infty} C (r) \, \covol \Bigl(\frac{1}{r}\,\Lambda\Bigr)
          = \covol \Lambda \, \lim_{r\to\infty} \frac{C(r)}{r^n}. \]
Podemos ordenar los puntos $\omega \in \Lambda \cap X$ de tal manera que
$$0 < F (\omega_1) \le F (\omega_2) \le F (\omega_3) \le \cdots$$

Pongamos $r_k = \sqrt[n]{F (\omega_k)}$. Tenemos
$\{ \omega_1, \ldots, \omega_k \} \subseteq r_k\,T$, así que $C (r_k) \ge k$.
Por otra parte, para todo $\epsilon > 0$ se tiene
$x_k \notin (r_k - \epsilon)\,T$, así que $C (r_k - \epsilon) < k$. Esto nos
da la desigualdad
$$C (r_k - \epsilon) < k \le C (r_k),$$
y luego
$$\frac{C (r_k - \epsilon)}{(r_k-\epsilon)^n}\,\frac{(r_k - \epsilon)^n}{r_k^n} < \frac{k}{r_k^n} \le \frac{C (r_k)}{r_k^n}.$$
Pasando al límite $k \to \infty$, tenemos $r_k \to \infty$, y luego
$$\lim_{k\to\infty} \frac{k}{F (\omega_k)} = \frac{\vol T}{\covol \Lambda}.$$
Esto significa que para todo $\epsilon > 0$ se tiene
\[ \Bigl(\frac{\vol T}{\covol \Lambda} - \epsilon\Bigr)\frac{1}{k}
   < \frac{1}{F (\omega_k)}
   < \Bigl(\frac{\vol T}{\covol \Lambda} + \epsilon\Bigr)\frac{1}{k} \]
para todo $k$ suficientemente grande, digamos $k \ge k_0$. Elevando todo a $s > 1$
y sumando sobre $k\ge k_0$, tenemos
\[ \Bigl(\frac{\vol T}{\covol \Lambda} - \epsilon\Bigr)^s\,\sum_{k\ge k_0} \frac{1}{k^s}
   < \sum_{k\ge k_0} \frac{1}{F (\omega_k)^s}
   < \Bigl(\frac{\vol T}{\covol \Lambda} + \epsilon\Bigr)^s\,\sum_{k\ge k_0} \frac{1}{k^s}. \]
Aquí
$$\sum_{k\ge k_0} \frac{1}{k^s} = \zeta (s) - \sum_{1\le k < k_0} \frac{1}{k^s},$$
donde $\zeta (s)$ converge para $s > 1$. Por otra parte, nuestra serie es
$$Z (s) = \sum_{k\ge 1} \frac{1}{F (\omega_k)^s}.$$
Las desigualdades de arriba que se cumplen para todo $\epsilon > 0$ establecen
la convergencia de $Z (s)$ para $s > 1$.

Ahora multiplicando la desigualdad por $(s - 1)$ y pasando al límite
$s \to 1^+$, en vista de la fórmula
$$\lim_{s\to 1^+} (s-1)\,\sum_{k\ge k_0} \frac{1}{k^s} = \lim_{s\to 1^+} (s-1)\,\zeta(s) = 1,$$
se obtiene
\[ \frac{\vol T}{\covol \Lambda} - \epsilon
   < \liminf_{s\to 1^+} (s-1)\,Z(s) \le \limsup_{s\to 1^+} (s-1)\,Z(s)
   < \frac{\vol T}{\covol \Lambda} + \epsilon. \]
Esto se cumple para todo $\epsilon > 0$, así que podemos concluir que
$$\lim_{s\to 1^+} (s-1)\,Z (s) = \frac{\vol T}{\covol \Lambda}.$$
Hemos entonces probado el teorema~\ref{thm:residuo-de-Z(s)}. \qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Dominio fundamental $X$ de la acción de unidades sobre \texorpdfstring{$K_\RR^\times$}{Kℝ*}}
\label{sec:dominio-fundamental-X}

Ahora vamos a probar la primera mitad del teorema
\ref{thm:X-dominio-fundamental-de-OK*} que nos da un cono
$X \subset K_\RR^\times$ que es un dominio fundamental de la acción
de $\O_K^\times$.

Consideremos unidades fundamentales $u_1, \ldots, u_r \in \O_K^\times$. Entonces
los vectores $L (u_1), \ldots, L (u_r)$ forman una base del espacio $H \subset
\RR^{r_1+r_2}$. Por otra parte, el vector
$$L = (\underbrace{1,\ldots,1}_{r_1}, \underbrace{2,\ldots,2}_{r_2})$$
no está en $H$, así que los $L (u_i)$ junto con $L$ forman una base de
$\RR^{r_1+r_2}$: todo $x \in \RR^{r_1+r_2}$ puede ser expresado como
\begin{equation}
  \label{eqn:base-de-Rr1+r2}
  \lambda_1 \, L (u_1) + \cdots + \lambda_r \, L (u_r) + \lambda L
\end{equation}
para algunos $\lambda_1,\ldots,\lambda_r,\lambda \in \RR$.

A partir de ahora vamos a denotar por $m = \# \mu_K$ el número de las raíces de
la unidad en $K$.

\begin{definicion}
  Sea $X \subset K_\RR^\times$ el subconjunto definido por las siguientes
  condiciones.
  \begin{enumerate}
  \item[a)] Para todo $x \in X$ en la expresión de $\ell (x)$ en la base
    \eqref{eqn:base-de-Rr1+r2} se tiene $0 \le \lambda_i < 1$ para
    $i = 1,\ldots,r$.

  \item[b)] Se tiene $0 \le \arg x_1 < \frac{2\pi}{m}$.
  \end{enumerate}
\end{definicion}

La condición b) merece alguna explicación. Si $K$ tiene un encaje real, entonces
$\mu_K = \{ \pm 1 \}$ (otras raíces de la unidad no se encajan en $\RR$), así
que $m = 2$ y la condición b) nos dice simplemente que $x_1 > 0$. En general,
la condición b) sirve para tomar en cuenta la acción de
$\mu_K = (\O_K^\times)_{tors}$ como en
el ejemplo~\ref{ejemplo:conjunto-X-Q(sqrt-3)}. La condición a) es similar a
lo que vimos en el ejemplo~\ref{ejemplo:conjunto-X-Q(sqrt3)}.

\begin{proposicion}
  $X$ es un \textbf{cono}: si $x \in X$, entonces $\lambda x \in X$
  para todo $\lambda > 0$.

  \begin{proof}
    Para $x \in X$ y $\lambda > 0$ tenemos
    $$\ell (\lambda x) = \log |\lambda|\,L + \ell (x),$$
    y esto no afecta los coeficientes $\lambda_1,\ldots,\lambda_r$, así que la
    condición a) se preserva. Por otra parte, $\arg (\lambda x_1) = \arg x_1$,
    así que b) se preserva también. Notamos que $X \ne \emptyset$: por ejemplo,
    el punto $\Phi (1)$ está en $X$.
  \end{proof}
\end{proposicion}


\begin{proposicion}
  $X$ es un dominio fundamental de la acción de $\O_K^\times$ sobre
  $K_\RR^\times$: para todo punto $y \in K_\RR^\times$ existen únicos
  $u \in \O_K^\times$ y $x \in X$ tales que $y = \Phi (u)\,x$.

  \begin{proof}
    Primero para la existencia, escribamos $\ell (y)$ en términos de nuestra
    base de $\RR^{r_1+r_2}$:
    $$\ell (y) = \lambda_1 \, L (u_1) + \cdots + \lambda_r \, L (u_r) + \lambda L.$$
    Para $i = 1,\ldots,r$ pongamos
    $$\lambda_i = a_i + \mu_i,$$
    donde
    $$a_i \in \ZZ, \quad 0 \le \mu_i < 1.$$
    Consideremos la unidad $v = u_1^{a_1}\cdots u_r^{a_r}$ y el punto
    $z = \Phi (v^{-1})\,y$. Ahora
    \[ \ell (z) = L (v^{-1}) + \ell (y) =
       - a_1\,L (u_1) - \cdots - a_r\,L(u_r)
       + \lambda_1 \, L (u_1) + \cdots + \lambda_r \, L (u_r) + \lambda L =
       \mu_1 \, L (u_1) + \cdots + \mu_r \, L (u_r) + \lambda L. \]

    Esto nos asegura la condición a) de la definición de $X$, y falta analizar
    la condición b). Si $\arg z_1 = \phi$, entonces para algún $k$ se tiene
    $$\frac{2\pi k}{m} \le \phi < \frac{2\pi {k+1}}{m}.$$
    Sea $\zeta \in \mu_K$ la $m$-ésima raíz de la unidad tal que
    $\sigma_1 (\zeta) = \exp \Bigl(\frac{2\pi i}{m}\Bigr)$. En este caso
    el punto $x = \Phi (\zeta^{-k})\,z$ está en $X$: primero tenemos
    $$\ell (x) = L (\zeta^{-k}) + \ell (z) = \ell (z),$$
    dado que $\mu_K = \ker L$, así que la condición a) se preserva. Por otra
    parte,
    $$\arg x_1 = \arg z_1 - \frac{2\pi k}{m} = \phi - \frac{2\pi k}{m},$$
    y luego
    $$0 \le \arg x_1 < \frac{2\pi}{m}.$$
    Entonces,
    $$y = \Phi (v)\,z = \Phi (\zeta^k v)\,x$$
    es la representación que estábamos buscando.

    Ahora para ver que la representación es única, supongamos que
    $$y = \Phi (u)\,x = \Phi (u')\,x'$$
    para algunos $u,u' \in \O_K^\times$, $x,x' \in X$. Tomando los logaritmos,
    se obtiene
    $$L (u) + \ell (x) = L (u') + \ell (x').$$
    Aquí por nuestra hipótesis
    \begin{align*}
      \ell (x) & = \lambda_1 \, L (u_1) + \cdots + \lambda_r \, L (u_r) + \lambda L, \\
      \ell (x') & = \lambda_1' \, L (u_1) + \cdots + \lambda_r' \, L (u_r) + \lambda' L,
    \end{align*}
    donde $0 \le \lambda_i, \lambda_i' < 1$. Por otra parte,
    \begin{align*}
      L (u) & = a_1 \, L (u_1) + \cdots + a_r \, L (u_r), \\
      L (u') & = a_1' \, L (u_1) + \cdots + a_r' \, L (u_r),
    \end{align*}
    donde $a_i,a_i' \in \ZZ$. Esto nos permite concluir que $L (u) = L (u')$,
    así que $u' = \zeta u$ para alguna raíz de la unidad
    $\zeta \in \mu_K = \ker L$. Ahora $\Phi (u') = \Phi (\zeta)\,\Phi (u)$,
    y entonces $x = \Phi (\zeta)\,x'$, y en particular $x_1 = \sigma_1
    (\zeta)\,x_1'$.  La condición b) nos dice que
    $$0 \le \arg x_1, \arg x_1' < \frac{2\pi}{m}.$$
    Tenemos
    $$0 \le |\sigma_1 (\zeta)| < \frac{2\pi}{m},$$
    pero $\sigma_1 (\zeta)$ es una raíz $m$-ésima compleja, así que la única
    opción es $\sigma_1 (\zeta) = 1$, y luego $\zeta = 1$. Podemos concluir que
    $u = u'$ y $x = x'$.
  \end{proof}
\end{proposicion}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Cálculo del volumen de T}
\label{sec:vol-T}

Para terminar la prueba de la fórmula del número de clases, tenemos que ver que
$$T = \{ x \in X \mid |N (x)| \le 1 \}$$
es un conjunto acotado y calcular su volumen
$$\vol T = \frac{2^{r_1}\,(2\pi)^{r_2}\,\Reg_K}{m}.$$
El cálculo esencialmente consiste en una reducción a ciertas integrales
iteradas, lo que no suena muy interesante. Sin embargo, este es precisamente
el punto donde aparece el regulador y $m = \# \mu_K$.

\begin{lema}
  $T \subset X$ es un conjunto acotado.

  \begin{proof}
    Recordemos que $X \subset K_\RR^\times$ es un cono. Todo rayo en $X$ que
    sale del origen contiene único punto $x\in X$ tal que $|N (x)| = 1$.
    Ahora si $S$ es el conjunto de tales puntos, entonces
    $T = \bigcup_{0 < \lambda \le 1} \lambda S$.

    Para todo punto $x \in K_\RR^\times$ consideremos
    \[ \ell (x) = (n_i\,\log |x_i|)_i =
       \lambda_1 \, L (u_1) + \cdots + \lambda_r \, L (u_r) + \lambda L. \]
    Calculando la suma de coordenadas de los vectores en la parte derecha
    e izquierda, nos sale
    $\log |N (x)| = n\,(r_1 + 2r_2) = n\lambda$,
    usando que $L (u_i) \in H$.
    Podemos entonces escribir
    \[ \ell (x) =
       \lambda_1 \, L (u_1) + \cdots + \lambda_r \, L (u_r) +
       \frac{1}{n}\,\log |N (x)|\,L. \]
    Ahora si $x \in S$, entonces $\log |N (x)| = 1$, y nos queda
    \[ \ell (x) = (n_i\,\log |x_i|)_i
       = \lambda_1 \, L (u_1) + \cdots + \lambda_r \, L (u_r), \]
    donde $0 \le \lambda_1 < 1$, puesto que $x \in S \subset X$. Esto nos
    da una cota sobre los $\log |x_i|$, y luego sobre los $x_i$. Esto significa
    que $S$ es acotado, y por ende $T$ también lo es.
  \end{proof}
\end{lema}

\begin{lema}
  Para toda unidad $u \in \O_K^\times$ la transformación
  $x \mapsto \Phi (u)\cdot x$ sobre $K_\RR^\times$ preserva el volumen.

  \begin{proof}
    El determinante de esta transformación será
    $N (\Phi (u)) = K_{K/\QQ} (u) = \pm 1$.
  \end{proof}
\end{lema}

En particular, sea $\zeta \in \mu_K$ una raíz de la unidad tal que
$$\sigma_1 (\zeta) = \exp \Bigl(\frac{2\pi i}{m}\Bigr).$$
Para $k = 0,1,\ldots,m-1$ consideremos los conjuntos
$$T_k = \Phi (\zeta^k)\cdot T.$$
Tenemos entonces $\vol (T_k) = \vol (T)$. Ahora
\begin{gather*}
  |N (\Phi (\zeta^k)\cdot x)| = |N (x)|,\\
  \ell (\Phi (\zeta^k)\cdot x) = \ell (x),\\
  \arg (\Phi (\zeta^k)\cdot x)_1 = \arg x_1 + \frac{2\pi k}{m}.
\end{gather*}
Entonces, cada conjunto $T_k$ está definido por las condiciones
\begin{enumerate}
\item[1)] $0 < |N (x)| \le 1$;

\item[2)] $\ell (x) = \lambda_1 \, L (u_1) + \cdots + \lambda_r \, L (u_r) + \frac{1}{n}\,\log |N (x)|\,L$,
  donde $0 \le \lambda_i < 1$.

\item[3)] $\frac{2\pi k}{m} \le \arg x_1 < \frac{2\pi\,(k+1)}{m}$.
\end{enumerate}

De la condición 3) se ve que los $T_k$ son disjuntos y su unión
$\bigcup_{0 \le k \le m-1} T_k$ está definida por las condiciones 1) y 2).
Sea $\overline{T}$ el subconjunto de la unión tal que $x_1,\ldots,x_{r_1} > 0$.
Tenemos entonces
\[ \vol (T) = \frac{2^{r_1}}{m}\,\vol (\overline{T}) =
\frac{2^{r_1+r_2}}{m} \, \vol_{Leb.} (\overline{T}). \]

\begin{proposicion}
  Se tiene $\vol_{Leb.} (\overline{T}) = \pi^{r_2}\,\Reg_K$, y por lo tanto
  $\vol (T) = \frac{2^{r_1}\,(2\pi)^{r_2}\,\Reg_K}{m}$.

  \begin{proof}
    Para $x \in \overline{T}$ se tiene
    \[ \ell (x)_i =\sum_{1 \le k \le r} \lambda_k\,L (u_k) +
    \frac{n_i}{n}\,\log |N (x)|, \]
    donde $n_i = 1$ para las coordenadas que corresponden a encajes reales
    (es decir, $1 \le i \le r_1$)
    y $n_i = 2$ para las coordenadas que corresponden a encajes complejos
    (es decir, $r_1 + 1 \le i \le r_1 + r_2$).

    Escribamos las coordenadas de $K_\RR \cong \RR^{r_1 + 2r_2}$ como
    $$(x_1,\ldots,x_r, y_1, z_1, \ldots, y_{r_2}, z_{r_2}).$$
    Hagamos un cambio de variables
    \[ x_i = \rho_i, \quad
      y_j = \rho_{r_1 + j}\,\cos\phi_j, \quad
      z_j = \rho_{r_1 + j}\,\sin\phi_j, \]
    donde $1 \le i \le r_1$ y $1 \le j \le r_2$.
    El jacobiano correspondiente será
    \[ \def\arraystretch{2.25}
    \left(\begin{array}{ccc|ccccc}
      \frac{\partial x_1}{\partial \rho_1} & \cdots & \frac{\partial x_1}{\partial \rho_{r_1}} & \frac{\partial x_1}{\partial \rho_{r_1+1}} & \frac{\partial x_1}{\partial \phi_1} & \cdots & \frac{\partial x_1}{\partial \rho_{r_1 + r_2}} & \frac{\partial x_1}{\partial \phi_{r_2}} \\
      \vdots & \ddots & \vdots & \vdots & \vdots & \ddots & \vdots & \vdots \\
      \frac{\partial x_{r_1}}{\partial \rho_1} & \cdots & \frac{\partial x_{r_1}}{\partial \rho_{r_1}} & \frac{\partial x_{r_1}}{\partial \rho_{r_1+1}} & \frac{\partial x_{r_1}}{\partial \phi_1} & \cdots & \frac{\partial x_{r_1}}{\partial \rho_{r_1 + r_2}} & \frac{\partial x_{r_1}}{\partial \phi_{r_2}} \\
      \hline
      \frac{\partial y_1}{\partial \rho_1} & \cdots & \frac{\partial y_1}{\partial \rho_{r_1}} & \frac{\partial y_1}{\partial \rho_{r_1+1}} & \frac{\partial y_1}{\partial \phi_1} & \cdots & \frac{\partial y_1}{\partial \rho_{r_1 + r_2}} & \frac{\partial y_1}{\partial \phi_{r_2}} \\
      \frac{\partial z_1}{\partial \rho_1} & \cdots & \frac{\partial z_1}{\partial \rho_{r_1}} & \frac{\partial z_1}{\partial \rho_{r_1+1}} & \frac{\partial z_1}{\partial \phi_1} & \cdots & \frac{\partial z_1}{\partial \rho_{r_1 + r_2}} & \frac{\partial z_1}{\partial \phi_{r_2}} \\
      \vdots & \ddots & \vdots & \vdots & \vdots & \ddots & \vdots & \vdots \\
      \frac{\partial y_{r_2}}{\partial \rho_1} & \cdots & \frac{\partial y_{r_2}}{\partial \rho_{r_1}} & \frac{\partial y_{r_2}}{\partial \rho_{r_1+1}} & \frac{\partial y_{r_2}}{\partial \phi_1} & \cdots & \frac{\partial y_{r_2}}{\partial \rho_{r_1 + r_2}} & \frac{\partial y_{r_2}}{\partial \phi_{r_2}} \\
      \frac{\partial z_{r_2}}{\partial \rho_1} & \cdots & \frac{\partial z_{r_2}}{\partial \rho_{r_1}} & \frac{\partial z_{r_2}}{\partial \rho_{r_1+1}} & \frac{\partial z_{r_2}}{\partial \phi_1} & \cdots & \frac{\partial z_{r_2}}{\partial \rho_{r_1 + r_2}} & \frac{\partial z_{r_2}}{\partial \phi_{r_2}} \\
    \end{array}\right). \]
    Calculándolo con cuidado, nos sale la matriz
    \[ \left(\begin{array}{ccc|ccccc}
      1 & \cdots & 0 & 0 & 0 & \cdots & 0 & 0 \\
      \vdots & \ddots & \vdots & \vdots & \vdots & \ddots & \vdots & \vdots \\
      0 & \cdots & 1 & 0 & 0 & \cdots & 0 & 0 \\
      \hline
      0 & \cdots & 0 & \cos \phi_1 & -\rho_{r_1+1}\,\sin (\phi_1) & \cdots & 0 & 0 \\
      0 & \cdots & 0 & \sen \phi_1 & +\rho_{r_1+1}\,\cos (\phi_1) & \cdots & 0 & 0 \\
      \vdots & \ddots & \vdots & \vdots & \vdots & \ddots & \vdots & \vdots \\
      0 & \cdots & 0 & 0 & 0 & \cdots & \cos \phi_{r_2} & -\rho_{r_1+r_2}\,\sen (\phi_{r_2}) \\
      0 & \cdots & 0 & 0 & 0 & \cdots & \sin \phi_{r_2} & +\rho_{r_1+r_2}\,\cos (\phi_{r_2}) \\
    \end{array}\right). \]
    de determinante $\rho_{r_1 + 1} \cdots \rho_{r_1 + r_2}$.

    \vspace{1em}

    En términos de nuevas coordenadas, el conjunto
    $\overline{T} \subset \RR^{r_1 + 2r_2}$ viene dado por
    \begin{enumerate}
    \item[1)] $\rho_1, \ldots, \rho_{r_1 + r_2} > 0$,
      $\prod\limits_{1 \le i \le r_1 + r_2} \rho_i^{e_i} \le 1$;

    \item[2)] $\log \rho_j^{e_j} = \sum\limits_{1 \le k \le r} \lambda_k \, (L (u_k))_j + \frac{e_j}{n}\,\log \prod\limits_{1 \le i \le r_1 + r_2} \rho_i^{e_i}$,
      donde $0 \le \lambda_k < 1$;

    \item[3)] $0 \le \phi_j < 2\pi$.
    \end{enumerate}

    Ahora pasemos a otras coordenadas $\lambda_1,\ldots,\lambda_r,\lambda$,
    definidas por
    $$\log \rho_j^{e_j} = \sum_{1 \le k \le r} \lambda_k\,L(u_k)_j + \frac{e_j}{n}\,\log \lambda.$$
    Sumando estas ecuaciones para $j = 1, \ldots, r_1 + r_2$ y notando que
    $\sum_j e_j = n$ y $\sum_j L (u_k)_j = 0$, se obtiene
    $$\lambda = \prod_{1 \le j \le r_2 + r_2} \rho_j^{e_j}.$$
    Entonces, el conjunto $\overline{T}$ está definido por las condiciones
    $$0 \le \lambda_k < 1, \quad 0 < \lambda \le 1$$
    para $k = 1, \ldots, r$. Calculamos el jacobiano
    \[ \def\arraystretch{2.25}
    J = \left(\begin{array}{c|ccc}
      \frac{\partial \rho_1}{\partial\lambda} & \frac{\partial \rho_1}{\partial\lambda_1} & \cdots & \frac{\partial \rho_1}{\partial\lambda_r} \\
      \vdots & \vdots & \ddots & \vdots \\
      \frac{\partial \rho_{r_1}}{\partial\lambda} & \frac{\partial \rho_{r_1}}{\partial\lambda_1} & \cdots & \frac{\partial \rho_{r_1}}{\partial\lambda_r} \\
      \hline
      \frac{\partial \rho_{r_1+1}}{\partial\lambda} & \frac{\partial \rho_{r_1+1}}{\partial\lambda_1} & \cdots & \frac{\partial \rho_{r_1+1}}{\partial\lambda_r} \\
      \vdots & \vdots & \ddots & \vdots \\
      \frac{\partial \rho_{r_1+r_2}}{\partial\lambda} & \frac{\partial \rho_{r_1+r_2}}{\partial\lambda_1} & \cdots & \frac{\partial \rho_{r_1+r_2}}{\partial\lambda_r} \\
    \end{array}\right) =
    \left(\begin{array}{c|ccc}
      \frac{\rho_1}{n \lambda} & \frac{\rho_1}{e_1}\,L (u_1)_1 & \cdots & \frac{\rho_1}{e_1}\,L (u_r)_1 \\
      \vdots & \vdots & \ddots & \vdots \\
      \frac{\rho_{r_1}}{n \lambda} & \frac{\rho_{r_1}}{e_{r_1}}\,L (u_1)_{r_1} & \cdots & \frac{\rho_{r_1}}{e_{r_1}}\,L (u_r)_{r_1} \\
      \hline
      \frac{\rho_{r_1+1}}{n \lambda} & \frac{\rho_{r_1+1}}{e_{r_1+1}}\,L (u_1)_{r_1+1} & \cdots & \frac{\rho_{r_1+1}}{e_{r_1+1}}\,L (u_r)_{r_1+1} \\
      \vdots & \vdots & \ddots & \vdots \\
      \frac{\rho_{r_1+r_2}}{n \lambda} & \frac{\rho_{r_1+r_2}}{e_{r_1+r_2}}\,L (u_1)_{r_1+r_2} & \cdots & \frac{\rho_{r_1+r_2}}{e_{r_1+r_2}}\,L (u_r)_{r_1+r_2} \\
    \end{array}\right). \]
    El determinante correspondiente será
    \[ |\det J| = \def\arraystretch{1.75}
    \frac{\rho_1\cdots\rho_{r_1+r_2}}{n\lambda\,2^{r_2}}\,
    \det \left(\begin{array}{c|ccc}
      1 & L (u_1)_1 & \cdots & L (u_r)_1 \\
      \vdots & \vdots & \ddots & \vdots \\
      1 & L (u_1)_{r_1} & \cdots & L (u_r)_{r_1} \\
      \hline
      2 & L (u_1)_{r_1+1} & \cdots & L (u_r)_{r_1+1} \\
      \vdots & \vdots & \ddots & \vdots \\
      2 & L (u_1)_{r_1+r_2} & \cdots & L (u_r)_{r_1+r_2} \\
    \end{array}\right). \]
    Sumando todas las filas a la primera, allí nos quedará el vector
    $(n,0,\ldots,0)$. Recordando la definición del regulador,
    \[ \det |J| = \frac{\rho_1\cdots\rho_{r_1+r_2}}{\lambda\,2^{r_2}}\,\Reg_K =
    \frac{1}{\rho_{r_1+1}\cdots\rho_{r_1+r_2}\,2^{r_2}}\,\Reg_K. \]

    Juntando todos los cálculos de arriba,
    \begin{align*}
      \vol_{Leb.} (\overline{T}) & = \int\cdots\int d x_1\cdots d x_{r_1}\,d y_1\,dz_1\cdots d y_{r_2} d z_{r_2} \\
      & = \int\cdots\int \rho_{r_1+1}\cdots\rho_{r_1+r_2}\,d\rho_1\cdots d\rho_{r_1+r_2}\,d \phi_1\cdots d\phi_{r_2} \\
      & = \int_0^{2\pi} d\phi_1 \cdots\int_0^{2\pi} d\phi_{r_2} \int\cdots\int\rho_{r_1+1}\cdots\rho_{r_1+r_2}\,d\rho_1\cdots d\rho_{r_1+r_2} \\
      & = (2\pi)^{r_2}\,\int\cdots\int \det |J|\,\rho_{r_1+1}\cdots\rho_{r_1+r_2}\,d\lambda_1\cdots d\lambda_r\,d\lambda \\
      & = \pi^{r_2}\,\Reg_K\,\int_0^1 d\lambda_1 \cdots \int_0^1 d\lambda_r \, \int_0^1 d\lambda = \pi^{r_2}\,\Reg_K. \qedhere
    \end{align*}
  \end{proof}
\end{proposicion}

Con esto ya tenemos todos los detalles de nuestra prueba de la fórmula de
clases.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% \pdfbookmark{Clase 28 (25/11/20)}{clase-28}
\section{Función zeta y series L}
\marginpar{\small Clase 28 \\ 25/11/20}

En esta sección me gustaría explicar cómo la función zeta se factoriza en
ciertas series $L$ de Dirichlet
$$\zeta_K (s) = \prod_\chi L(s,\chi),$$
en el caso cuando $K/\QQ$ es una extensión abeliana. Aquí voy a seguir la
exposición de \cite{Washington-GTM83}.

La idea es bastante sencilla: recordemos que un carácter de Dirichlet mód $m$
es un homomorfismo multiplicativo
$\chi\colon (\ZZ/m\ZZ)^\times \to \CC^\times$. Dado que para un campo ciclotómico
$\QQ (\zeta_m)$ se tiene $\Gal (\QQ(\zeta_m)/\QQ) \cong (\ZZ/m\ZZ)^\times$,
es útil considerar los caracteres de Dirichlet como caracteres de Galois
$\chi\colon \Gal (\QQ(\zeta_m)/\QQ) \to \CC^\times$. Ahora los subgrupos
$H \subseteq \Gal (\QQ(\zeta_m)/\QQ)$ corresponden a subcampos
$K \subseteq \QQ (\zeta_m)$. Como ya mencionamos en el capítulo
\ref{cap:teoria-de-galois}, el \textbf{teorema de Kronecker--Weber} afirma que
cualquier extensión abeliana $K/\QQ$ puede ser realizada como una subextensión
de $\QQ (\zeta_m)/\QQ$ para algún $m$.

Ahora para el grupo de caracteres
$\widehat{(\ZZ/m\ZZ)^\times} \cong \widehat{\Gal (\QQ(\zeta_m)/\QQ)}$ se tiene
$\widehat{(\ZZ/m\ZZ)^\times} \cong (\ZZ/m\ZZ)^\times$, así que los subcampos
de $\QQ (\zeta_m)$ están en correspondencia con grupos de caracteres de
Dirichlet mód $m$. Sin embargo, aquí el isomorfismo
$\widehat{(\ZZ/m\ZZ)^\times} \cong (\ZZ/m\ZZ)^\times$ no es canónico, y por esto
hay que proceder con cuidado. Vamos a empezar por una revisión más
sistemática de los caracteres de grupos abelianos finitos.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Caracteres de grupos abelianos finitos}

Sea $G$ un grupo abeliano finito. Vamos a usar la notación multiplicativa.
Un \textbf{carácter} de $G$ es un homomorfismo $\chi\colon G\to \CC^\times$.
Los caracteres forman un grupo respecto a la multiplicación punto por punto
que será denotado por $\widehat{G}$. Esta construcción es contravariante:
un homomorfismo de grupos $f\colon G\to H$ induce un homomorfismo de grupos
de caracteres $\widehat{f}\colon \widehat{H} \to \widehat{G}$ mediante la
composición con $f$.

\begin{lema}
  Se tiene $\widehat{G\times H} \cong \widehat{G}\times\widehat{H}$.

  \begin{proof}
    Para los grupos abelianos el producto $\times$ coincide con coproducto,
    y luego
    $\Hom (G\times H, \CC^\times) \cong \Hom (G, \CC^\times) \times \Hom (H, \CC^\times)$
    por las propiedades universales de productos y coproductos.
  \end{proof}
\end{lema}

\begin{lema}
  Hay un isomorfismo no canónico $\widehat{G} \cong G$. En particular,
  $\#\widehat{G} = \# G$.

  \begin{proof}
    Primero, si $G = C_n$ es un grupo cíclico finito, entonces
    \[ \widehat{C_n} = \Hom (C_n, \CC^\times) = \Hom (C_n, \mu_n (\CC)) \cong
    \Hom (C_n,C_n) \cong C_n. \]
    En general, tenemos un isomorfismo no canónico
    $G \cong C_{n_1}\times\cdots\times C_{n_s}$, y luego
    \[ \widehat{G} \cong \widehat{C_{n_1}}\times\cdots\times \widehat{C_{n_s}} \cong
       C_{n_1}\times\cdots\times C_{n_s} \cong G. \qedhere \]
  \end{proof}
\end{lema}

Las siguientes propiedades es un caso muy particular de
la \textbf{dualidad Pontriaguin} que funciona para los grupos abelianos
localmente compactos. En este caso el \textbf{grupo dual} $\widehat{G}$ se
define como el grupo de homomorfismos continuos $\chi\colon G\to \TT$, donde
$\TT = \{ z \in \CC \mid |z| = 1 \}$ es el grupo compacto del círculo.
En el caso cuando $G$ es finito, es trivialmente compacto, y todo homomorfismo
$\chi\colon G\to \CC^\times$ toma valores en las raíces $n$-ésimas de la unidad
$\mu_n (\CC) \subset \TT$, donde $n = \# G$. En general la prueba de
la dualidad de Pontriaguin es bastante complicada, pero para $G$ finito
podemos usar la observación de arriba de que $\#\widehat{G} = \# G$ y ocupar el
conteo de elementos.

\begin{proposicion}
  Sean $G$ un grupo abeliano finito y $\widehat{G}$ su grupo de caracteres.

  \begin{enumerate}
  \item[a)] Hay isomorfismo canónico $G \cong \widehat{\widehat{G}}$
    dado por el homomorfismo de evaluación
    $ev\colon g \mapsto (\chi \mapsto \chi (g))$.

  \item[b)] Tenemos un apareamiento no degenerado
    \[ G\times \widehat{G} \to \CC^\times, \quad
       (g,\chi) \mapsto \chi (g); \]
    Es decir, si $\chi (g) = 1$ para todo $g \in G$, entonces $\chi = 1$,
    y si $\chi (g) = 1$ para todo $\chi \in \widehat{G}$, entonces $g = 1$.

  \item[c)] Dado un subgrupo $H \subset G$, consideremos el subgrupo ortogonal
    respecto al apareamiento de arriba:
    $$H^\perp = \{ \chi \in \widehat{G} \mid \chi (h) = 1 \text{ para todo } h\in H \}.$$
    Tenemos isomorfismos naturales
    \[ H^\perp \cong \widehat{G/H}, \quad \widehat{H} \cong \widehat{G}/H^\perp. \]

  \item[d)] Bajo la identificación de $\widehat{\widehat{G}}$ con $G$, se tiene
    $(H^\perp)^\perp = H$.
  \end{enumerate}

  \begin{proof}
    El homomorfismo $ev$ es inyectivo: si tenemos $\chi (g) = 1$ para todo
    carácter $\chi\colon G \to \CC^\times$, entonces todo $\chi$ se factoriza de
    manera única por el cociente $G/\langle g\rangle$, y luego
    $\widehat{G} = \widehat{G/\langle g\rangle}$. Sin embargo,
    $\#\widehat{G} = \# G$ y $\#\widehat{G/\langle g\rangle} = G/\langle g\rangle$,
    así que necesariamente $g = 1$.  Por otra parte, el homomorfismo es
    sobreyectivo, dado que
    $\# G = \# \widehat{G} = \# \widehat{\widehat{G}}$.
    Esto establece la parte a). Notamos que el argumento es similar a la prueba
    del isomorfismo canónico $V \cong (V^\vee)^\vee$ para un espacio vectorial
    de dimensión finita $V$.

    La parte b) es una consecuencia inmediata de lo que acabamos de ver.

    En c), observamos que si $H \subset \ker \chi$, entonces $\chi$ se factoriza
    de manera única por el cociente $G/H$, así que $H^\perp \cong \widehat{G/H}$.
    Además, la inclusión $H \hookrightarrow G$ induce la restricción de
    caracteres $\widehat{G} \to \widehat{H}$, y por la definición
    $H^\perp$ es el núcleo. Esto nos da un homomorfismo inyectivo
    $\widehat{G}/H^\perp \hookrightarrow \widehat{H}$. Para la sobreyectividad,
    calculamos que
    \[ \# (\widehat{G}/H^\perp) = \frac{\# G}{\# H^\perp} =
    \frac{\# G}{\# \widehat{G/H}} = \frac{\# G}{\# (G/H)} =
    \# H = \# \widehat{H}. \]

    En fin, en la parte d), primero tenemos por la definición
    $H \subseteq (H^\perp)^\perp$, y luego
    \[ \# (H^\perp)^\perp = \# (\widehat{G/H})^\perp =
       \# \left(\frac{\widehat{G}}{\widehat{G/H}}\right) = \# H. \qedhere \]
  \end{proof}
\end{proposicion}

\subsection{Caracteres de Dirichlet}

\begin{definicion}
  Un carácter de Dirichlet mód $m$ es un homomorfismo
  $\chi\colon (\ZZ/m\ZZ)^\times \to \CC^\times$.
\end{definicion}

Notamos que si $m \mid m'$, entonces $\chi$ induce un carácter
\[ (\ZZ/m'\ZZ)^\times \to (\ZZ/m\ZZ)^\times \xrightarrow{\chi} \CC^\times. \]

\begin{definicion}
  El $m$ más pequeño tal que $\chi$ puede ser considerado como un carácter mód
  $m$ se llama el \textbf{conductor} de $\chi$ y se denota por
  $f_\chi$.\footnote{Nota políticamente incorrecta: aquí «$f$» viene del alemán
    \emph{Führer}, lo que literalmente significa líder o conductor.}  Cuando
  $\chi$ se considera como un carácter mód $f_\chi$, se dice que $\chi$ es
  \textbf{primitivo}.
\end{definicion}

\begin{ejemplo}
  Consideremos el homomorfismo $\chi\colon (\ZZ/6\ZZ)^\times \to \CC^\times$
  definido por $1 \mapsto 1$ y $5 \mapsto -1$. En realidad este $\chi$ se induce
  por el homomorfismo no trivial $\chi'\colon (\ZZ/3\ZZ)^\times \to \CC^\times$
  definido por $1 \mapsto 1$, $2 \mapsto -1$:
  $$\chi\colon (\ZZ/6\ZZ)^\times \to (\ZZ/3\ZZ)^\times \xrightarrow{\chi'} \CC^\times.$$
  Entonces $\chi$ tiene conductor $f_\chi = 3$ y no es primitivo.
\end{ejemplo}

\begin{definicion}
  Si $\chi (-1) = +1$, se dice que $\chi$ es \textbf{par}, y si
  $\chi (-1) = -1$, se dice que $\chi$ es \textbf{impar}.
\end{definicion}

Un carácter de Dirichlet $\chi\colon (\ZZ/m\ZZ)^\times \to \CC^\times$ se extiende
a una aplicación $\chi\colon \ZZ\to \CC$ poniendo
$$\chi (n) = 0, \text{ si }\gcd (n,f_\chi) \ne 1.$$

Si $\chi$ y $\chi'$ son caracteres primitivos, entonces su producto punto por
punto se define como un carácter
$$\chi\chi'\colon (\ZZ/\lcm (f_\chi,f_{\chi'})\ZZ)^\times \to \CC^\times,$$
y es también primitivo. Si $\gcd (f_\chi,f_{\chi'}) = 1$, entonces
$f_{\chi\chi'} = f_\chi\,f_{\chi'}$.

Sea $K/\QQ$ una extensión abeliana. En este caso gracias al teorema de
Kronecker--Weber tenemos ${K \subseteq \QQ (\zeta_m)}$ para algún $m$.
El mínimo posible $m$ con esta propiedad se llama el \textbf{conductor}
de $K$. En este caso todo carácter de Galois
$\chi\colon \Gal (K/\QQ) \to \CC^\times$ puede ser interpretado como un
carácter de Dirichlet mód $m$:
\[ \begin{tikzcd}
  (\ZZ/m\ZZ)^\times &[-3em] \cong &[-3em] \Gal (\QQ (\zeta_m)/\QQ)\ar{rr}\ar[->>]{dr} & & \CC^\times \\
  & & & \Gal (K/\QQ)\ar{ur}[swap]{\chi}
  \end{tikzcd} \]
De esta manera el grupo de caracteres $\widehat{\Gal (K/\QQ)}$ se identifica con
cierto grupo de caracteres de Dirichlet $X$ y se tiene el apareamiento perfecto
correspondiente
$$\Gal (K/\QQ) \times X \to \CC^\times.$$

Para un subcampo $F\subseteq K$ consideremos el subgrupo
$\Gal (K/F) \subseteq \Gal (K/\QQ)$ y el correspondiente subgrupo ortogonal
de $X$
$$Y = \Gal (K/F)^\perp = \{ \chi \in X \mid \chi (g) = 1 \text{ para todo } g \in \Gal (K/F) \}.$$
Viceversa, dado un subgrupo $Y \subseteq X$, podemos considerar el grupo
$Y^\perp \subseteq \Gal (K/\QQ)$ y el subcampo fijo correspondiente
$F = K^{Y^\perp}$. De esta manera se obtiene la siguiente versión de
la correspondencia de Galois para $K/\QQ$.

\begin{teorema}
  Para un campo $K \subseteq \QQ (\zeta_m)$, sea
  $X \cong \widehat{\Gal (K/\QQ)}$ un grupo de caracteres de Dirichlet
  correspondiente. Tenemos una biyección
  \[ \begin{tikzcd}[column sep=5em]
    \{ \text{subgrupos }Y \subseteq X \} \ar[shift left=0.25em]{r}{Y \mapsto K^{(Y^\perp)}} &
    \{ \text{subcampos }F \subseteq K \} \ar[shift left=0.25em]{l}{\Gal (K/F)^\perp \mapsfrom F}
  \end{tikzcd} \]
  Esta correspondencia cumple con las siguientes propiedades:
  \begin{enumerate}
  \item[a)] $[F : \QQ] = \# Y$.

  \item[b)] Se tiene $F_1 \subseteq F_2$ si y solamente si $Y_1 \subseteq Y_2$.

  \item[c)] Al subgrupo generado por los elementos $Y_1$ e $Y_2$ corresponde
    el compositum $F_1 F_2$.
  \end{enumerate}

  En particular, hay una biyección
  \[ \begin{tikzcd}
    \{ \text{subgrupos }X \subseteq \widehat{(\ZZ/m\ZZ)^\times} \} \ar[shift left=0.25em]{r} &
    \{ \text{subcampos }K \subseteq \QQ (\zeta_m) \} \ar[shift left=0.25em]{l}
  \end{tikzcd} \]

  \begin{proof}
    Si $F = K^{(Y^\perp)}$, entonces $Y^\perp = \Gal (K/F)$ por la teoría de
    Galois, y luego $\Gal (K/F)^\perp = (Y^\perp)^\perp = Y$.
    De manera similar, si $Y = \Gal (K/F)^\perp$, entonces
    $K^{(Y^\perp)} = K^{(\Gal (K/F)^\perp)^\perp} = K^{\Gal (K/F)} = F$.
    Esto establece la biyección.

    Para verificar la propiedad a), notamos que $[F : \QQ] = \# \Gal (F/\QQ)$.
    Por otra parte,
    \[ \Gal (K/F)^\perp \cong (\Gal (K/\QQ)/\Gal (K/F))^{\widehat{~}}
       \cong \widehat{\Gal (F/\QQ)}, \]
    y $\# \widehat{\Gal (F/\QQ)} = \# \Gal (F/\QQ)$.

    La propiedad b) nada más viene del hecho de que para la correspondencia de
    Galois habitual, se tiene $F_1 \subseteq F_2$ si y solamente si
    $\Gal (K/F_2) \subseteq \Gal (K/F_1)$, y lo último se cumple si y solamente
    si $\Gal (K/F_1)^\perp \subseteq \Gal (K/F_2)^\perp$.

    Como consecuencia, en la propiedad c), el subgrupo de $X$ más pequeño que
    contiene $Y_1$ e $Y_2$ corresponderá al subcampo más pequeño de $K$
    que contiene $F_1$ y $F_2$.
  \end{proof}
\end{teorema}

\begin{ejemplo}
  \label{ej:Q-zeta-7-real-caracteres}
  En el campo ciclotómico $\QQ (\zeta_7)$ consideremos el subcampo cúbico real
  $K = \QQ (\zeta_7 + \zeta_7^{-1})$. Este debe corresponder a algún grupo de
  caracteres de Dirichlet $X \subset \widehat{(\ZZ/7\ZZ)^\times}$ de orden $3$.
  El grupo $(\ZZ/7\ZZ)^\times$ tiene solamente dos caracteres cúbicos;
  estos corresponden a $2$ y $4$ que tienen orden $3$ mód $7$.

  Para definir un carácter cúbico, podemos escoger un generador de
  $(\ZZ/7\ZZ)^\times$, por ejemplo $3$, y mandarlo a la raíz de la unidad
  $\zeta_3$:
  \[ \chi\colon 1\mapsto 1, \quad
  2 \equiv 3^2 \mapsto \zeta_3^2, \quad
  3 \mapsto \zeta_3, \quad
  4 \equiv 3^4 \mapsto \zeta_3, \quad
  5 \equiv 3^5 \mapsto \zeta_3^2, \quad
  6 \equiv 3^3 \mapsto 1. \]
  El otro carácter cúbico será $\chi^2 = \overline{\chi}$. Entonces,
  $X = \{ 1, \chi, \chi^2 \}$.
\end{ejemplo}

\begin{ejemplo}
  \label{ej:sqrt-2-sqrt-3-caracteres}
  Consideremos el campo $K = \QQ (\sqrt{2},\sqrt{3})$. La extensión $K/\QQ$
  es abeliana, y el teorema de Kronecker--Weber nos dice que
  $K \subset \QQ (\zeta_m)$ para algún $m$.

  Nos conviene considerar por separado dos campos cuadráticos
  $F_1 = \QQ (\sqrt{2})$ y $F_2 = \QQ (\sqrt{3})$.
  Tenemos $F_1 \subset \QQ (\zeta_8)$ y $F_2 \subset \QQ (\zeta_{12})$,
  y luego $K = F_1 F_2 \subset \QQ (\zeta_{24})$.

  El encaje $F_1 \subset \QQ (\zeta_8)$ corresponde a un carácter cuadrático
  $\chi_1$ mód $8$, y sería instructivo entender cuál es este, ocupando las
  consideraciones de arriba. El automorfismo no trivial de $\QQ (\zeta_8)$
  que deja fijo a $\sqrt{2} = \zeta_8 + \zeta_8^{-1}$ es
  $\sigma\colon \zeta_8 \mapsto \zeta_8^7$, así que
  $$\Gal (\QQ (\zeta_8)/F_1) = \{ 1, \sigma \}.$$
  Nos interesa el grupo ortogonal
  \[ \Gal (\QQ (\zeta_8)/F_1)^\perp =
     \{ \chi \in \Gal (\QQ (\zeta_8)/\QQ)^{\widehat{~}} \mid \chi (\sigma) = 1 \}. \]
  Todos los elementos no triviales de
  $\Gal (\QQ (\zeta_8)/\QQ) \cong (\ZZ/8\ZZ)^\times$ tienen orden $2$,
  así que los caracteres
  $\chi\in \Gal (\QQ (\zeta_8)/\QQ)^{\widehat{~}} \cong \widehat{(\ZZ/8\ZZ)^\times}$
  toman valores $\pm 1$. Bajo la identificación
  $\Gal (\QQ (\zeta_8)/\QQ)^{\widehat{~}} \cong \widehat{(\ZZ/8\ZZ)^\times}$,
  notamos que el elemento no trivial de
  $\Gal (\QQ (\zeta_8)/F_1)^\perp$ debe mandar $7$ a $+1$, y esto ya nos define
  todo el carácter:
  \[ \chi_1\colon 1 \mapsto +1, \quad
  3\mapsto -1, \quad
  5\mapsto -1, \quad
  7\mapsto +1 \]

  Dejo al lector investigar el caso de $F_2 \subset \QQ (\zeta_{12})$ y ver que
  el carácter correspondiente mód $12$ será
  \[ \chi_2\colon 1 \mapsto +1, \quad
  5\mapsto -1, \quad
  7\mapsto -1, \quad
  11\mapsto +1. \]

  Podemos concluir que $K$ corresponde al grupo de caracteres de Dirichlet
  \[ X = \{ 1, \chi_1, \chi_2, \chi_1\chi_2 \}. \qedhere \]
\end{ejemplo}

\subsection{Caracteres de Dirichlet y ramificación}

Empezamos por un par de pequeños lemas sobre los índices de ramificación en
extensiones. Invito que el lector revise el material de
\S\S\ref{sec:descomposicion-e-inercia}--\ref{sec:frobenius} sobre el grupo
de descomposición e inercia y automorfismo de Frobenius.

Primero, nos conviene introducir la siguiente terminología: se dice que un primo
racional $p$ es \textbf{totalmente ramificado}\footnote{No hemos mencionado este
  término hasta el momento solo porque por el carácter introductorio de este
  curso, no hemos tratado de manera más sistemática la teoría de
  ramificación\ldots} en una extensión $K/\QQ$ si en $\O_K$ hay único ideal
primo $\mathfrak{p}\mid p$ y $p\O_K = \mathfrak{p}^e$, donde
$e = [K : \QQ]$. Notamos que esto es equivalente a tener
$f (\mathfrak{p}|p) = 1$.

\begin{lema}
  En una torre de extensiones $\QQ \subseteq F \subseteq K$,
  si $p$ es totalmente ramificado en $K$, entonces es totalmente ramificado en
  $F$.

  \begin{proof}
    Si $\mathfrak{P}$ es el único primo en $\O_K$ que está sobre $p$, entonces
    $\mathfrak{p} = \mathfrak{P}\cap \O_F$ es el único primo en $\O_F$
    que está sobre $p$. Ahora
    $f (\mathfrak{P}|\mathfrak{p})\,f (\mathfrak{p}|p) = f (\mathfrak{P}|p) = 1$
    implica que $f (\mathfrak{p}|p) = 1$.
  \end{proof}
\end{lema}

\begin{lema}
  Sean $F_1$ y $F_2$ dos campos de números, donde $F_2/\QQ$ es una extensión de
  Galois. Dado un primo racional $p$, consideremos ideales primos
  $\mathfrak{P} \subset \O_{F_1 F_2}$, $\mathfrak{p}_1 \subset \O_{F_1}$,
  $\mathfrak{p}_1 \subset \O_{F_2}$ tales que
  $\mathfrak{P} \mid \mathfrak{p}_1 \mid p$ y $\mathfrak{p}_2 \mid p$.

  \begin{enumerate}
  \item[1)] Si $p$ no se ramifica en $F_2$, entonces
    $e (\mathfrak{P} \mid \mathfrak{p}_1) = 1$.

  \item[2)] En particular, si $F_2/\QQ$ es también una extensión de Galois,
    y $p$ no se ramifica en $F_2$, entonces el índice de ramificación de $p$ en
    $F_1/\QQ$ es el mismo que el índice de ramificación de $p$ en $F_1 F_2/\QQ$.
  \end{enumerate}

  \[ \begin{tikzcd}
    & F_1 F_2\ar[-]{dl}[description]{nr}\ar[-]{dr} \\
    F_1\ar[-]{dr} & & F_2\ar[-]{dl}[description]{nr} \\
    & \QQ
  \end{tikzcd} \]

  \begin{proof}
    Recordemos que si $F_2/\QQ$ es una extensión de Galois, entonces
    $F_1 F_2/F_1$ es también una extensión de Galois. Consideremos los grupos
    de descomposición
    \begin{align*}
      D (\mathfrak{P}|\mathfrak{p}_1) & = \{ \sigma \in \Gal (F_1 F_2/F_1) \mid \sigma (\mathfrak{P}) = \mathfrak{P} \}, \\
      D (\mathfrak{p}_2|p) & = \{ \sigma \in \Gal (F_2/\QQ) \mid \sigma (\mathfrak{p}_2) = \mathfrak{p}_2 \}.
    \end{align*}
    Dejo al lector verificar que el siguiente diagrama conmuta:
    \[ \begin{tikzcd}
      1 \ar{r} & I (\mathfrak{P}|\mathfrak{p}_1)\ar[dashed]{d}\ar{r} & D (\mathfrak{P}|\mathfrak{p}_1) \ar{r}\ar{d} & \Gal (\kappa(\mathfrak{P})/\kappa(\mathfrak{p}_1)) \ar{r}\ar{d} & 1 \\
      1 \ar{r} & I (\mathfrak{p}_2|p)\ar{r} & D (\mathfrak{p}_2|p) \ar{r} & \Gal (\kappa(\mathfrak{p}_2)/\FF_p) \ar{r} & 1
    \end{tikzcd} \]
    Aquí el homomorfismo en el medio está inducido por el homomorfismo
    inyectivo de restricción
    \[ \Gal (F_1 F_2/F_1) \hookrightarrow \Gal (F_2/\QQ),
    \quad \sigma \mapsto \left.\sigma\right|_{F_2} \]
    (véase \ref{prop:irracionalidades-naturales}). Como consecuencia, tenemos
    un homomorfismo inyectivo
    $I (\mathfrak{P}|\mathfrak{p}_1) \hookrightarrow I (\mathfrak{p}_2|p)$.
    En particular, si $p$ no se ramifica en $F_2$, entonces
    $I (\mathfrak{p}_2|p) = 1$, y luego $I (\mathfrak{P}|\mathfrak{p}_1) = 1$,
    así que $e (\mathfrak{P} \mid \mathfrak{p}_1) = 1$.

    Para la parte 2) del lema, dado un primo racional $p$, sean
    $\mathfrak{P} \subset \O_{F_1 F_2}$ un ideal primo tal que
    $\mathfrak{P} \mid p$ y $\mathfrak{p}_1 = \mathfrak{P} \cap \O_{F_1}$,
    $\mathfrak{p}_2 = \mathfrak{P} \cap \O_{F_2}$. Entonces,
    \[ e (\mathfrak{P}|p) =
       e (\mathfrak{P}|\mathfrak{p}_1)\,e (\mathfrak{p}_1|p) =
       e (\mathfrak{p}_1|p). \qedhere\]
  \end{proof}
\end{lema}

Ahora si $m = \prod_p p^k$, entonces
$(\ZZ/m\ZZ)^\times \cong \prod_p (\ZZ/p^k\ZZ)^\times$, y luego
$\widehat{(\ZZ/m\ZZ)^\times} \cong \prod_p \widehat{(\ZZ/p^k\ZZ)^\times}$.
De esta manera todo carácter de Dirichlet $\chi$ mód $m$ se descompone como
$\chi = \prod_p \chi_p$, donde $\chi_p$ es un carácter mód $p^k$. Dado un grupo
de caracteres de Dirichlet $X$, pongamos
$$X_p = \{ \chi_p \mid \chi \in X \}.$$

\begin{teorema}
  Para $K \subseteq \QQ (\zeta_m)$, sea $X \cong \widehat{\Gal (K/\QQ)}$
  el grupo de caracteres de Dirichlet correspondiente. Para un primo racional
  $p$ el índice de ramificación en $K$ es $e_p = \# X_p$.

  \begin{proof}
    Escribamos $m = p^k\,m'$, donde $p \nmid m'$.
    El campo $L = K\,\QQ (\zeta_{m'})$ corresponde al grupo de caracteres de
    Dirichlet generado por $X$ y $\widehat{(\ZZ/m'\ZZ)^\times}$. Los caracteres
    mód $m'$ son precisamente los caracteres mód $m$ de conductor $f_\chi$ tal
    que $p \nmid f_\chi$. Entonces, $L$ corresponde al producto directo
    $X_p \times \widehat{(\ZZ/m'\ZZ)^\times}$, y por ende
    $L = F\,\QQ (\zeta_{m'})$, donde $F$ es el subcampo de $\QQ (\zeta_{p^k})$
    que corresponde a $X_p$.

    Tenemos el siguiente diagrama, donde está marcada la ramificación de $p$
    en las extensiones.

    \[ \begin{tikzcd}[row sep=1em, column sep=1em]
      & & & \QQ (\zeta_m)\ar[-]{d}\ar[-]{dddrr}\ar[-]{ddlll} \\
       & & & L\ar[-]{ddll}[description]{nr}\ar[-]{dd}[description]{nr}\ar[-]{ddrr} \\
      \QQ (\zeta_{p^k})\ar[-]{dr}\ar[-,bend right=45]{dddrrr}[description]{tr} \\
      & F\ar[-]{ddrr}[description]{tr} & & K\ar[-]{dd} & & \QQ (\zeta_{m'})\ar[-]{ddll}[description]{nr} \\
      \\
       & & & \QQ
    \end{tikzcd} \]

    Aquí $p$ no se ramifica en la extensión $\QQ (\zeta_{m'})/\QQ$, así que el
    índice de ramificación de $p$ en $K/\QQ$ es el mismo que en la extensión
    $L/\QQ$. En la extensión $L/F$ el primo $p$ tampoco se ramifica, así que
    el índice de ramificación es el mismo que en $F/\QQ$.
    En fin, $F/\QQ$ es una subextensión de $\QQ (\zeta_{p^k})/\QQ$ donde $p$
    es totalmente ramificado. Se sigue que $p$ es totalmente ramificado en
    $F/\QQ$ y $e_p = [F : \QQ] = \# X_p$.
  \end{proof}
\end{teorema}

Esto nos lleva a la siguiente caracterización de ramificación.

\begin{corolario}
  En la situación anterior, un primo $p$ no se ramifica en $K$ si y solamente si
  $\chi (p) \ne 0$ para todo $\chi \in X$.

  \begin{proof}
    Según el teorema, $p$ se ramifica en $K/\QQ$ si y solamente si
    $\# X_p \ne 1$. Esto es equivalente a tener un carácter no trivial
    $\chi \in X$ tal que
    \[ \chi_p \ne 1 \iff p \mid f_\chi \iff \chi (p) = 0. \qedhere \]
  \end{proof}
\end{corolario}

\begin{teorema}
  \label{thm:caracteres-de-Dirichlet-descomposicion-e-inercia}
  Sean $K \subseteq \QQ (\zeta_m)$ y $X \cong \widehat{\Gal (K/\QQ)}$ el grupo
  de caracteres de Dirichlet correspondiente. Para un primo racional $p$
  consideremos los subgrupos de $X$ dados por
  \[ Y = \{ \chi\in X \mid \chi (p) \ne 0 \}, \quad
     Z = \{ \chi\in X\mid \chi (p) = 1 \}. \]
  En este caso el grupo $Y/Z$ es cíclico, y se tiene
  \[ e_p = [X:Y], \quad
     f_p = [Y:Z], \quad
     g_p = \# Z. \]
  \begin{proof}
    Recordamos que
    $$e_p\,f_p\,g_p = [K : \QQ] = \# X.$$
    Entonces, bastará verificar que $e_p = [X:Y]$ y $f_p = [Y:Z]$, y luego
    $$g_p = \frac{\# X}{[X:Y]\cdot [Y:Z]} = \# Z.$$

    Sea $F$ el subcampo de $K$ que corresponde al subgrupo
    $Y \subseteq X$. Entonces, $\QQ \subseteq F \subseteq K$ es la subextensión
    más grande donde $p$ no se ramifica. Esto significa que $F$ es precisamente
    el campo de inercia de $p$ (véase
    \ref{prop:caracterizacion-de-campo-de-descomposicion-e-inercia}). Tenemos
    entonces $F = K^{I (\mathfrak{p}|p)} = K^{\Gal (K/F)}$, así que
    $I (\mathfrak{p}|p) = \Gal (K/F)$. Luego,
    $e_p = \# I (\mathfrak{p}|p) = \# \Gal (K/F)$ (véase
    \ref{thm:campo-de-descomposicion-e-inercia}).

    Recordemos que bajo el apareamiento $\Gal (K/\QQ) \times X \to \CC^\times$
    se tiene $Y = \Gal (K/F)^\perp$, así que
    \[ X/Y = \widehat{\Gal (K/\QQ)}/\Gal (K/F)^\perp \cong \widehat{\Gal (K/F)}. \]
    Entonces, $e_p = \# \Gal (K/F) = \# \widehat{\Gal (K/F)} = [X : Y]$.

    Ahora nos vamos a fijar en la extensión $F/\QQ$ donde $p$ no se ramifica.
    En este caso el grupo de descomposición correspondiente es cíclico, generado
    por el automorfismo de Frobenius $\Frob_p \in \Gal (F/\QQ)$, y se tiene
    $f_p = \# \langle \Frob_p\rangle$.

    Sea $n$ el mcm de los conductores $f_\chi$ para $\chi \in Y$. En este caso
    $F \subseteq \QQ (\zeta_n)$, donde $p \nmid n$, y $p$ tampoco se
    ramifica en la extensión $\QQ (\zeta_n)/\QQ$. Recordemos que el grupo de
    descomposición de $p$ respecto a $\QQ (\zeta_n)/\QQ$ es cíclico, generado
    por el automorfismo de Frobenius $\zeta_n \mapsto \zeta_n^p$.

    El grupo $\Gal (F/\QQ)$ es el cociente de
    $\Gal (\zeta_n)/\QQ \cong (\ZZ/n\ZZ)^\times$ por
    $\Gal (\QQ (\zeta_n)/F)$, y el automorfismo $\Frob_p$ es precisamente
    la clase lateral de $p \in (\ZZ/n\ZZ)^\times$. Ahora si $\chi \in Y$,
    entonces se tiene $\Gal (\QQ (\zeta_n)/F) \subseteq \ker \chi$, así que
    $\chi (\Frob_p) = \chi (p)$. En particular, $\chi (\Frob_p) = 1$ si y
    solamente si $\chi (p) = 1$. Esto significa que respecto al apareamiento
    $\Gal (F/\QQ) \times Y \to \CC^\times$, tenemos precisamente
    $Z = \langle \Frob_p\rangle^\perp$. Ahora
    $$Y/Z \cong \widehat{\langle\Frob_p\rangle},$$
    y luego
    $[Y:Z] = \#\widehat{\langle\Frob_p\rangle} = \#\langle\Frob_p\rangle = f_p$.
  \end{proof}
\end{teorema}

\subsection{Factorización de la función zeta en series L de Dirichlet}

Recordemos que a un carácter de Dirichlet $\chi$ se asocia la serie $L$
correspondiente
\[ L (s,\chi) = \sum_{n\ge 1} \frac{\chi(n)}{n^s} =
   \prod_p \frac{1}{1 - \chi(p)\,p^{-s}}. \]
Aquí para levantar $\chi$ a una aplicación $\chi\colon \ZZ\to \CC$, vamos a
usar nuestra convención de que $\chi$ se considera módulo su conductor $f_\chi$.

\begin{teorema}
  Para un subcampo $K \subseteq \QQ (\zeta_m)$, sea $X$ el grupo de caracteres
  de Dirichlet correspondiente. Se tiene
  $$\zeta_K (s) = \prod_{\chi\in X} L (s,\chi).$$

  \begin{proof}
    Escribamos la función zeta como el producto de Euler
    $$\zeta_K (s) = \prod_p \prod_{\mathfrak{p}\mid p} \frac{1}{1 - N_{K/\QQ} (\mathfrak{p})^{-s}}.$$
    Pongamos
    \[ p\O_K = (\mathfrak{p}_1\cdots\mathfrak{p}_{g_p})^{e_p},
       \quad \text{donde }
       N_{K/\QQ} (\mathfrak{p}_i) = p^{f_p}. \]
    El factor de Euler que corresponde a $p$ será entonces
    \[ \prod_{1 \le i \le g_p} \frac{1}{1 - N_{K/\QQ} (\mathfrak{p}_i)^{-s}} =
       \prod_p \frac{1}{(1 - p^{-f_p \,s})^{g_p}}. \]

    Por otra parte, en el producto $\prod_{\chi\in X} L (s,\chi)$ el factor que
    corresponde a $p$ será
    \[ \prod_{\chi\in X} \frac{1}{1 - \chi (p)\,p^{-s}} =
       \prod_{\chi\in Y} \frac{1}{1 - \chi (p)\,p^{-s}}, \]
    donde
    $$Y = \{ \chi \in X \mid \chi (p) \ne 0 \}.$$
    Hemos pasado al producto sobre $\chi \in Y$ porque los términos con
    $\chi (p) = 0$ no contribuyen nada. De la misma manera, podemos considerar
    el subgrupo de $Y$ dado por
    $$Z = \{ \chi \in X \mid \chi (p) = 1 \}.$$
    Para cada clase lateral $\chi Z \in Y/Z$ los caracteres en $\chi Z$
    toman el mismo valor en $p$. Esto nos permite reescribir nuestro
    factor de Euler como
    $$\left(\prod_{\overline{\chi}\in Y/Z} \frac{1}{1 - \chi (p)\,p^{-s}}\right)^{\# Z},$$
    donde por $\overline{\chi}\in Y/Z$ se entienden diferentes representantes
    del grupo cociente. Recordemos de
    \ref{thm:caracteres-de-Dirichlet-descomposicion-e-inercia} que $Y/Z$ es un
    grupo cíclico de orden $f_p$ y $\# Z = g_p$. Entonces, los valores
    $\chi (p)$ para diferentes representantes $\overline{\chi} \in Y/Z$ serán
    precisamente las $f_p$-ésimas raíces de la unidad. Usando la identidad
    $\prod_{0 \le k \le n-1} (1 - \zeta_n^k\,x) = 1 - x^n$, calculamos
    $$\prod_{0 \le k \le f_p-1} \frac{1}{1 - \zeta_{f_p}^k\,p^{-s}} = \frac{1}{1 - p^{-f_p\,s}}.$$
    Esto nos dice que
    \[ \prod_{\chi\in X} \frac{1}{1 - \chi (p)\,p^{-s}} =
       \frac{1}{(1 - \chi (p)\,p^{-f_p\,s})^{g_p}}. \qedhere \]
  \end{proof}
\end{teorema}

Como consecuencia, se obtiene el siguiente resultado que es el punto clave en
la prueba del teorema de Dirichlet sobre primos en progresiones aritméticas
(véase el apéndice~\ref{ap:Dirichlet}).

\begin{corolario}
  \label{cor:L(1,chi)-ne-0}
  Para $\chi \ne 1$ se tiene $L (1,\chi) \ne 0$.

  \begin{proof}
    Consideremos el grupo de caracteres de Dirichlet $X = \langle\chi\rangle$
    y el campo correspondiente $K \subseteq \QQ (\zeta_m)$, donde $m$ es
    el conductor de $\chi$. Sea $n = \# X$. El teorema anterior nos da
    \[ \zeta_K (s) = \prod_{0 \le k \le n-1} L (s,\chi^k) =
       \zeta (s) \, \prod_{1 \le k \le n-1} L (s,\chi^k). \]
    Sabemos que las funciones $\zeta_K (s)$ y $\zeta (s)$ tienen un polo simple
    en $s = 1$, y esto implica que ninguno de los factores $L (s,\chi^k)$
    se anulan en $s = 1$.
  \end{proof}
\end{corolario}

\begin{ejemplo}
  \label{ej:Q-zeta-7-real-zeta-descomp}
  En el ejemplo~\ref{ej:Q-zeta-7-real-caracteres} vimos que el campo cúbico real
  $K = \QQ (\zeta_7 + \zeta_7^{-1})$ corresponde al grupo de caracteres de
  Dirichlet $X = \{ 1, \chi, \chi^2 \}$, donde $\chi$ es un carácter
  cúbico mód $7$. Entonces,
  \[ \zeta_K (s) = \zeta (s) \, L (s,\chi) \, L (s,\chi^2). \qedhere \]
\end{ejemplo}

\begin{ejemplo}
  \label{ej:sqrt-2-sqrt-3-zeta-descomp}
  En el ejemplo~\ref{ej:sqrt-2-sqrt-3-caracteres} vimos que el campo
  bicuadrático $K = \QQ (\sqrt{2},\sqrt{3})$ se encaja en $\QQ (\zeta_{24})$
  y corresponde al grupo de caracteres
  $$X = \{ 1, \chi_1, \chi_2, \chi_1\chi_2 \},$$
  donde $\chi_1$ es un carácter mód $8$ y $\chi_2$ es un carácter mód $12$.
  (De hecho, estos caracteres también pueden ser recuperados del
  ejercicio~\ref{ejerc:caracter-para-campo-cuadratico}.)
  Tenemos como consecuencia
  \[ \zeta_K (s) = \zeta (s)\,L (s,\chi_1)\,L (s,\chi_2)\,L (s,\chi_1\chi_2). \qedhere \]
\end{ejemplo}

\begin{comentario}
  Todo lo que hemos hecho en esta sección funciona para extensiones abelianas
  $K/\QQ$. Para factorizar la función $\zeta_K (s)$ en el caso no abeliano,
  Artin introdujo funciones $L (s,\rho)$, donde $\rho$ es una representación
  lineal del grupo $\Gal (K/\QQ)$; es decir, un homomorfismo
  $\rho\colon \Gal (K/\QQ) \to \GL_n (\CC)$. Aquí $n$ es la dimensión de
  la representación. El resultado general es la factorización
  $$\zeta_K (s) = \prod_\rho L (s,\rho),$$
  donde el producto es sobre todas las representaciones irreducibles del grupo
  de Galois.

  Cuando $G = \Gal (K/\QQ)$ es un grupo abeliano, un resultado básico de
  la teoría de representación (véase por ejemplo \cite{Serre-RLGF}) nos dice que
  todas las representaciones irreducibles de $G$ son unidimensionales, y
  entonces corresponden a los caracteres
  $\chi\colon G \to \GL_1 (\CC) = \CC^\times$. En este caso las funciones $L$
  de Artin serán las series $L$ de Dirichlet.

  El caso no abeliano es más complicado y de este se origina una gran parte de
  las matemáticas contemporáneas.
\end{comentario}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% \pdfbookmark{Clase 29 (30/11/20)}{clase-29}
\section{Perspectiva: Prolongación analítica}
\marginpar{\small Clase 29 \\ 30/11/20}

En muchos casos una función de variable compleja definida por una serie sobre
el dominio de convergencia (como la función $\zeta_K (s)$ que al principio se
define para $\Re s > 1$) puede ser extendida a una función meromorfa sobre todo
$s \in \CC$. Este es el caso con la función zeta de Dedekind.

\begin{teorema}
  La función zeta de Dedekind admite prolongación analítica a todo plano
  complejo con el único polo en $s = 1$ de residuo dado por la fórmula del
  número de clases. Se cumple la ecuación funcional
  $$\zeta_K (1-s) = A(s)\,\zeta_K (s),$$
  donde
  $$A (s) = |\Delta_K|^{s - 1/2}\,\left(\cos\frac{\pi s}{2}\right)^{r_1+r_2}\,\left(\sin\frac{\pi s}{2}\right)^{r_2}\,\left(2\,(2\pi)^{-s}\,\Gamma (s)\right)^n,$$
  $n = [K : \QQ]$, y $r_1$ (resp. $2 r_2$) es el número de encajes reales
  (resp. complejos) de $K$.

  \begin{proof}
    Véase \cite[\S VII.5]{Neukirch-ANT}.
  \end{proof}
\end{teorema}

Aquí
$$\Gamma (s) = \int_0^\infty e^{-t}\,t^{s-1}\,dt, \quad \Re s > 0$$
es la \textbf{función Gamma}. En particular, $\Gamma (k) = (k-1)!$ para $k = 1,2,3,\ldots$

Tomando $K = \QQ$, se obtiene la ecuación funcional para la función zeta de
Riemann
\begin{equation}
  \label{eqn:ecuacion-funcional-para-zeta-de-Riemann}
  \zeta (1-s) = \left(\cos\frac{\pi s}{2}\right)\,2\,(2\pi)^{-s}\,\Gamma (s)\,\zeta (s).
\end{equation}

\begin{figure}
  \begin{center}
    \includegraphics{pic/riemann-zeta-negative.pdf}
  \end{center}

  \caption{Valores negativos de $\zeta (s)$}
\end{figure}

\begin{figure}
  \begin{center}
    \includegraphics{pic/zeta-x2-2-negative.pdf}
  \end{center}

  \caption{Valores negativos de $\zeta_{\QQ (\sqrt{\pm 2})} (s)$}
\end{figure}

Sustituyendo $s = 1$ en la ecuación funcional, notamos que el término
$\left(\cos\frac{\pi s}{2}\right)^{r_1+r_2}$ tiene cero de orden $r_1 + r_2$,
mientras que $\zeta_K (s)$ tiene polo de orden $1$. Esto nos permite concluir
que $\zeta_K (s)$ tiene cero en $s = 0$ de orden $r_1 + r_2 - 1$. Curiosamente,
este es también el rango del grupo de unidades $\O_K^\times$. Dejo al lector
calcular que el residuo correspondiente será
$$\zeta_K^* (0) = \lim_{s \to 0} s^{-(r_1 + r_2 - 1)}\,\zeta_K (s) = -\frac{\Reg_K\,h_k}{\# \mu_K}.$$
En particular,
$$\zeta (0) = -\frac{1}{2}.$$

La ecuación funcional nos da los \textbf{ceros triviales} de la función
$\zeta_K (s)$ que aparecen para $s = 0,-1,-2,-3,\ldots$ gracias a los términos
$\cos \frac{\pi s}{2}$ y $\sin \frac{\pi s}{2}$. Aquí están los ordenes de estos
ceros.

\begin{center}
  \renewcommand{\arraystretch}{1.5}
  \begin{tabular}{rcccccccccccc}
    \hline
    $s\colon$ & $0$ & $-1$ & $-2$ & $-3$ & $-4$ & $-5$ & $-6$ & $-7$ & $-8$ & $-9$ & $-10$ & $\cdots$ \\
    \hline
    $\text{ord}\colon$ & $r_1 + r_2 - 1$ & $r_2$ & $r_1 + r_2$ & $r_2$ & $r_1 + r_2$ & $r_2$ & $r_1 + r_2$ & $r_2$ & $r_1 + r_2$ & $r_2$ & $r_1 + r_2$ & $\cdots$ \\
    \hline
  \end{tabular}
\end{center}

La \textbf{hipótesis de Riemann extendida} afirma que todos los ceros
\emph{no triviales} de $\zeta_K (s)$ tienen $\Re s = \frac{1}{2}$. El mismo
Riemann formuló su conjetura para el caso de $K = \QQ$, y este es uno de los
problemas abiertos más importantes en matemáticas.

\vspace{1em}

Las series L de Dirichlet también admiten prolongación a todo el plano complejo.

\begin{teorema}
  Sea $\chi$ un carácter de Dirichlet primitivo mód $m$. La serie $L (s,\chi)$
  admite prolongación analítica a todo plano complejo que satisface la ecuación
  funcional
  \begin{equation}
    \label{eqn:ecuacion-funcional-para-series-L}
    L (1-s,\chi) = A(s) \, L (s,\overline{\chi}),
  \end{equation}
  donde
  $$A (s) = \frac{m^{s-1}\,\Gamma (s)}{(2\pi)^s} \, \left(e^{-\pi i s/2} + \chi (-1)\,e^{\pi i s/2}\right)\,g (\chi)$$
  y
  $$g (\chi) = \sum_{1 \le a \le m-1} \chi (a) \, \zeta_m^a.$$

  \begin{proof}
    Véase \cite[\S VII.2]{Neukirch-ANT} o \cite[Chapter~12]{Apostol-analytic}.
  \end{proof}
\end{teorema}

\begin{figure}
  \begin{center}
    \includegraphics{pic/lfun-negative.pdf}
  \end{center}

  \caption{$L (s,\chi)$ para $\chi_1 (n) = \legendre{+8}{n}$ (par) y $\chi_2 (n) = \legendre{-8}{n}$ (impar)}
\end{figure}

Más adelante veremos que $g (\chi) \ne 0$. Además, de la fórmula del producto de
Euler se ve que $L (s,\overline{\chi}) \ne 0$ para $s > 1$. Entonces, los ceros
triviales de $L (s,\chi)$ en $s = 0,-1,-2,-3,\ldots$ vienen del término
\[ e^{-\pi i s/2} + \chi (-1)\,e^{\pi i s/2} = \begin{cases}
  2 \, \cos \left(\frac{\pi s}{2}\right), & \text{si }\chi (-1) = +1,\\
  -2i \, \sin \left(\frac{\pi s}{2}\right), & \text{si }\chi (-1) = -1.
\end{cases} \]
Podemos concluir que si $\chi (-1) = +1$, entonces $L (s,\chi)$ tiene ceros
simples en $s = 0, -2, -4, -6, \ldots$, y si $\chi (-1) = -1$, entonces
$L (s,\chi)$ tiene ceros simples en $s = -1, -3, -5, \ldots$
La \textbf{hipótesis de Riemann generalizada} afirma que los ceros
\emph{no triviales} de $L (s,\chi)$ tienen $\Re s = \frac{1}{2}$.

Nuestro próximo objetivo será calcular los valores $L (s,\chi)$ para
$s = 0,-1,-2,-3,\ldots$ de manera explícita.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Perspectiva: Valores especiales}

Los valores de la función zeta $\zeta_K (s)$ en enteros $s = n \in \ZZ$ se
conocen como los \textbf{valores especiales}. Como vimos, la función zeta suele
tener ceros en $s = n$ negativos, así que normalmente por el valor especial se
entiende más bien el residuo correspondiente
$$\zeta_K^* (n) = \lim_{s \to n} (s-n)^{-d_n}\,\zeta_K (s),$$
donde $d_n$ denota el orden de cero en $s = n$ (para el polo en $s = 1$ tenemos
$d_1 = -1$).

Para las funciones $L (s,\chi)$ los valores especiales se definen de manera
similar.

Un ejemplo primordial de valores especiales es
\[ \zeta_K^* (0) = \lim_{s \to 0} s^{-(r_1 + r_2 - 1)}\,\zeta_K (s) = -\frac{\Reg_K\,h_k}{\# \mu_K}
   \longleftrightarrow
   \zeta_K^* (1) = \frac{2^{r_1}\,(2\pi)^{r_2}\,\Reg_K\,h_k}{\#\mu_K\,\sqrt{|\Delta_K|}}. \]

Hay varias identidades (en gran parte conjeturales) que generalizan estas
fórmulas a todo $s = n \in \ZZ$. La idea general es definir
\emph{ciertos invariantes algebraicos} análogos a $\Cl (K)$ y $\O_K^\times$;
estos deben ser algunos grupos abelianos finitamente generados. De sus partes de
torsión vendrá algún número racional, similar a $\frac{h_K}{\# \mu_K}$.
Por otra parte, debería haber ciertos «reguladores superiores» $\Reg_{K,n}$
responsables por la parte trascendente del valor especial. Estos reguladores
superiores también serán covolúmenes de algunos retículos, pero son más
difíciles de definir.

Las construcciones técnicas necesarias para escribir estas fórmulas para los
valores especiales nos llevarían demasiado lejos. El lector interesado en los
resultados y conjeturas contemporáneos acerca de los valores especiales puede
empezar por el artículo de Kontsevich y Zagier sobre períodos
\cite{Kontsevich-Zagier}, y también ver el artículo de Nekov\'a\v{r} sobre las
conjeturas de Beilinson en \cite{Motives-I}, y el libro
\cite{Bloch-Kato-for-riemann-zeta} sobre las conjeturas de Bloch--Kato para la
función zeta de Riemann. Aquí me gustaría explicar un resultado clásico.

\begin{teorema}[Siegel--Klingen]
  Para un campo totalmente real $K/\QQ$ los valores
  $\zeta_K (-1)$, $\zeta_K (-3)$, $\zeta_K (-5)$, $\ldots$
  son números racionales.
\end{teorema}

Aquí se trata literalmente de valores $\zeta_K (-n)$, no de residuos
$\zeta_K^* (-n)$. Hemos calculado arriba los ordenes de ceros triviales
$\zeta_K (-n)$, y estos son $r_2$ o $r_1 + r_2$, dependiendo de la paridad de
$n$. En particular, si $K$ no es totalmente real y $r_2 > 0$, entonces
$\zeta_K (-n) = 0$ para todo $n \le 0$. Por esto la hipótesis dice que $K/\QQ$
es totalmente real.

Para la prueba completa del teorema véase \cite[\S VII.9]{Neukirch-ANT}.
A continuación veremos una prueba para $K/\QQ$ una extensión abeliana. En este
caso, como ya vimos, se tiene $\zeta_K (s) = \prod_\chi L (s,\chi)$ para ciertos
caracteres de Dirichlet $\chi$, y bastaría saber calcular los valores de
$L (s,\chi)$ en $s = n \le 0$.  Estos cálculos son muy clásicos.

\subsection{Números y polinomios de Bernoulli}

Hay diferentes definiciones equivalentes de los números y polinomios de
Bernoulli. Nos conviene usar las funciones generatrices exponenciales.

\begin{definicion}
  Los \textbf{números de Bernoulli} $B_k \in \QQ$ se definen mediante
  $$\frac{t\,e^t}{e^t - 1} = \sum_{k\ge 0} \frac{B_k}{k!}\,t^k,$$
  y los \textbf{polinomios de Bernoulli} $B_k (x) \in \QQ [x]$ se definen
  mediante
  $$\frac{t\,e^{tx}}{e^t-1} = \sum_{k \ge 0} B_k (x)\,\frac{t^k}{k!}.$$
\end{definicion}

No es difícil verificar que la función generatriz para $B_k$ es equivalente a
la recurrencia
$$\sum_{0 \le i \le k} {k+1 \choose i}\,B_i = k+1.$$

\begin{proposicion}
  Los números y polinomios de Bernoulli cumplen las siguientes propiedades.

  \begin{enumerate}
  \item[a)] $B_k (1) = B_k$.

  \item[b)] $B_k (x+1) - B_k (x) = k\,x^{k-1}$.

    En particular, para $x = 0$ se obtiene $B_k (0) = B_k$ para $k \ne 1$.

  \item[c)] $B_k (1-x) = (-1)^k\,B_k (x)$.

    En particular, para $x = 0$, se obtiene que $B_k = 0$ para $k \ge 3$ impar.

  \item[d)] Para todo $k \ge 1$ se tiene
    $B_k' (x) = k\,B_{k-1} (x)$ y $\int_0^1 B_k (x)\,dx = 0$.
  \end{enumerate}

  \begin{proof}
    La propiedad a) se sigue de las funciones generatrices para $B_k$ y $B_k (x)$,
    y la propiedad b) se sigue de la identidad
    \[ \sum_{k\ge 0} (B_k (x+1) - B_k (x))\,\frac{t^k}{k!} =
       \frac{t\,e^{(x+1)\,t}}{e^t-1} - \frac{t\,e^{t\,x}}{e^t-1} =
       t\,e^{t\,x} = \sum_{k \ge 0} \frac{x^k}{k!}\,t^{k+1}. \]
    De manera similar, c) se sigue de
    \[ \sum_{k\ge 0} B_k (1-x)\,\frac{t^k}{k!} =
       \frac{t\,e^{(1-x)\,t}}{e^t - 1} =
       \frac{(-t)\,e^{x\,(-t)}}{e^{-t} - 1} =
       \sum_{k\ge 0} (-1)^k\,B_k (x)\,\frac{t^k}{k!}. \]
    En fin, para d), tomando as derivadas formales de la identidad
    $\frac{t\,e^{tx}}{e^t - 1} = \sum_{k \ge 0} B_k (x) \, \frac{t^k}{k!}$
    respecto a $x$, se obtiene
    \[ \frac{\partial}{\partial x} \left(\frac{t\,e^{tx}}{e^t - 1}\right) =
       \frac{t\cdot t\,e^{tx}}{e^t - 1} =
       t\,\sum_{k \ge 0} B_k (x) \, \frac{t^k}{k!} =
       \sum_{k \ge 1} B_{k-1} (x) \, \frac{t^k}{(k-1)!} =
       \sum_{k \ge 0} B_k' (x) \, \frac{t^k}{k!}. \]
    Se tiene $\int B_k (x)\,dx = \frac{1}{k+1}\,B_{k+1} (x) + C$, donde $B_{k+1}
    (0) = B_{k+1} (1)$, y luego $\int_0^1 B_k (x)\,dx = 0$.
  \end{proof}
\end{proposicion}

De hecho, la última propiedad \emph{caracteriza} los polinomios de Bernoulli:
estos se definen de manera única por las condiciones
\[ B_0 (x) = 1, \quad
   B_k' (x) = k\,B_{k-1} (x), \quad
   \int_0^1 B_k (x) \, dx = 0\text{ para }k \ge 1. \]
(La identidad $B_k' (x) = k\,B_{k-1} (x)$ define $B_k (x)$ salvo el término
constante que luego se recupera de la condición $\int_0^1 B_k (x) \, dx = 0$.)

\begin{figure}
  \begin{center}
    \renewcommand{\arraystretch}{1.75}
    \begin{tabular}{clc}
      \hline
      $k$ & $B_k (x)$ & $B_k$ \\
      \hline
      $0$ & $1$ & $1$ \\
      \hline
      $1$ & $x - \frac{1}{2}$ & $\frac{1}{2}$ \\
      \hline
      $2$ & $x^2 - x + \frac{1}{6}$ & $\frac{1}{6}$ \\
      \hline
      $3$ & $x^3 - \frac{3}{2}\,x^2 + \frac{1}{2}\,x$ & $0$ \\
      \hline
      $4$ & $x^4 - 2\,x^3 + x^2 - \frac{1}{30}$ & $-\frac{1}{30}$ \\
      \hline
      $5$ & $x^5 - \frac{5}{2}\,x^4 + \frac{5}{3}\,x^3 - \frac{1}{6}\,x$ & $0$ \\
      \hline
      $6$ & $x^6 - 3\,x^5 + \frac{5}{2}\,x^4 - \frac{1}{2}\,x^2 + \frac{1}{42}$ & $\frac{1}{42}$ \\
      \hline
      $7$ & $x^7 - \frac{7}{2}\,x^6 + \frac{7}{2}\,x^5 - \frac{7}{6}\,x^3 + \frac{1}{6}\,x$ & $0$ \\
      \hline
      $8$ & $x^8 - 4\,x^7 + \frac{14}{3}\,x^6 - \frac{7}{3}\,x^4 + \frac{2}{3}\,x^2 - \frac{1}{30}$ & $-\frac{1}{30}$ \\
      \hline
      $9$ & $x^9 - \frac{9}{2}\,x^8 + 6\,x^7 - \frac{21}{5}\,x^5 + 2\,x^3 - \frac{3}{10}\,x$ & $0$ \\
      \hline
      $10$ & $x^{10} - 5\,x^9 + \frac{15}{2}\,x^8 - 7\,x^6 + 5\,x^4 - \frac{3}{2}\,x^2 + \frac{5}{66}$ & $\frac{5}{66}$ \\
      \hline
      $11$ & $x^{11} - \frac{11}{2}\,x^{10} + \frac{55}{6}\,x^9 - 11\,x^7 + 11\,x^5 - \frac{11}{2}\,x^3 + \frac{5}{6}\,x$ & $0$ \\
      \hline
      $12$ & $x^{12} - 6\,x^{11} + 11\,x^{10} - \frac{33}{2}\,x^8 + 22\,x^6 - \frac{33}{2}\,x^4 + 5\,x^2 - \frac{691}{2730}$ & $-\frac{691}{2730}$ \\
      \hline
      $13$ & $x^{13} - \frac{13}{2}\,x^{12} + 13\,x^{11} - \frac{143}{6}\,x^9 + \frac{286}{7}\,x^7 - \frac{429}{10}\,x^5 + \frac{65}{3}\,x^3 - \frac{691}{210}\,x$ & $0$ \\
      \hline
      $14$ & $x^{14} - 7\,x^{13} + \frac{91}{6}\,x^{12} - \frac{1001}{30}\,x^{10} + \frac{143}{2}\,x^8 - \frac{1001}{10}\,x^6 + \frac{455}{6}\,x^4 - \frac{691}{30}\,x^2 + \frac{7}{6}$ & $\frac{7}{6}$ \\
      \hline
      $15$ & $x^{15} - \frac{15}{2}\,x^{14} + \frac{35}{2}\,x^{13} - \frac{91}{2}\,x^{11} + \frac{715}{6}\,x^9 - \frac{429}{2}\,x^7 + \frac{455}{2}\,x^5 - \frac{691}{6}\,x^3 + \frac{35}{2}\,x$ & $0$ \\
      \hline
    \end{tabular}
  \end{center}

  \caption{Polinomios y números de Bernoulli}
\end{figure}

\begin{figure}
  \begin{center}
    \includegraphics{pic/bernoulli-polynomials.pdf}
  \end{center}

  \caption{Polinomios de Bernoulli $B_n (x)$}
\end{figure}

A continuación nos servirá el siguiente caso particular de series de Fourier.
Sea $f\colon \mathbb{R} \to \mathbb{R}$ una función continua por trozos y
periódica tal que $f (x+1) = f (x)$. Luego, para todo $x_0\in \mathbb{R}$ donde
$f$ es continua y las derivadas izquierda y derecha de $f$ existen, se cumple
\[ f (x_0) = \sum_{n\in\mathbb{Z}} \widehat{f} (n) \, e^{2\pi i n x_0},
   \quad\text{donde }
   \widehat{f} (n) = \int_0^1 e^{-2\pi i n x} \, f(x) \, dx. \]

\begin{proposicion}
  Tenemos la serie de Fourier
  \begin{equation}
    \label{eq:serie-de-Fourier-polinomios-de-Bernoulli}
    B_k (x - \lfloor x\rfloor) = -\frac{k!}{(2\pi i)^k}\sum_{\substack{n\in \mathbb{Z} \\ n \ne 0}} \frac{e^{2\pi i n x}}{n^k}.
  \end{equation}

  \begin{proof}
    Necesitamos calcular los coeficientes de Fourier de la función
    $f (x) = B_k (x - \lfloor x\rfloor)$. Para $n = 0$ tenemos
    $$\widehat{f} (0) = \int_0^1 B_k (x)\,dx = 0.$$
    Para $n \ne 0$ y $k = 1$ usamos la integración por partes
    ($\int_a^b f'(x)\,g(x)\,dx = \left[f(x)\,g(x)\right]_a^b - \int_a^b f(x) \, g'(x)\,dx$):
    \begin{align*}
      \int_0^1 e^{-2\pi i n x}\,\left(x - \frac{1}{2}\right)\,dx & = -\frac{1}{2\pi i n} \int_0^1 \left(e^{-2\pi i n x}\right)' \, \left(x - \frac{1}{2}\right)\,dx \\
      & = -\frac{1}{2\pi i n} \, \left( \left[e^{-2\pi i n x}\,\left(x - \frac{1}{2}\right)\right]^1_0 - \underbrace{\int_0^1 e^{-2\pi i n x}\,dx}_{=0} \right) = -\frac{1}{2\pi i n}.
    \end{align*}

    Para $k > 1$ la integración por partes junto con la identidad
    $B_k' (x) = k\,B_{k-1} (x)$ nos da
    \begin{align*}
      \widehat{f} (n) & = \int_0^1 e^{-2\pi i n x} \, B_k (x)\,dx \\
      & = -\frac{1}{2\pi i n}\,\int_0^1 (e^{-2\pi i n x})' \, B_k (x)\,dx \\
      & = -\frac{1}{2\pi i n}\,\left(\left[e^{-2\pi i n x}\,B_k (x)\right]_0^1 - k\,\int_0^1 e^{-2\pi i n x} \, B_{k-1} (x)\,dx\right) \\
      & = \frac{k}{2\pi i n} \, \int_0^1 e^{-2\pi i n x}\,B_{k-1} (x)\,dx \\
      & = \frac{k\,(k-1)}{(2\pi i n)^2} \int_0^1 e^{-2\pi i n x}\,B_{k-2} (x)\,dx \\
      & = \cdots \\
      & = \frac{k!}{(2\pi i n)^{k-1}} \int_0^1 e^{-2\pi i n x}\,\left(x - \frac{1}{2}\right)\,dx \\
      & = \frac{k!}{(2\pi i n)^{k-1}} \cdot \left(-\frac{1}{2\pi i n}\right) = -\frac{k!}{(2\pi i n)^k}. \qedhere
    \end{align*}
  \end{proof}
\end{proposicion}

\begin{figure}
  \begin{center}
    \includegraphics{pic/bernoulli-polynomials-periodic.pdf}
  \end{center}

  \caption{Funciones periódicas $B_n (x - \lfloor x\rfloor)$}
\end{figure}

La serie de Fourier \eqref{eq:serie-de-Fourier-polinomios-de-Bernoulli} nos
lleva al siguiente famoso resultado.

\begin{teorema}[Euler]
  Para todo $k\ge 1$ se tiene
  $$\zeta (2k) = (-1)^{k+1} \, B_{2k}\,\frac{2^{2k-1}}{(2k)!}\,\pi^{2k}.$$

  \begin{proof}
    Sustituyendo $x = 0$ en \eqref{eq:serie-de-Fourier-polinomios-de-Bernoulli}
    y $2k$ en lugar de $k$, se obtiene
    \[ B_{2k} = B_{2k} (0) =
       -\frac{(2k)!}{(-1)^k\,(2\pi)^{2k}} \, 2\,\sum_{n \ge 1} \frac{1}{n^{2k}} =
       (-1)^{k+1}\frac{(2k)!}{2^{2k-1}\,\pi^{2k}}\,\zeta (2k). \qedhere \]
    \end{proof}
\end{teorema}

\begin{ejemplo}
  Los primeros valores $\zeta (2k)$ son
  \begin{align*}
    \zeta (2) & = \frac{\pi^2}{6} \approx 1.644934\ldots, \\
    \zeta (4) & = \frac{\pi^4}{90} \approx 1.082323\ldots, \\
    \zeta (6) & = \frac{\pi^6}{945}  \approx 1.017343\ldots, \\
    \zeta (8) & = \frac{\pi^8}{9450} \approx 1.004077\ldots, \\
    \zeta (10) & = \frac{\pi^{10}}{93\,555} \approx 1.000994\ldots, \\
    \zeta (12) & = \frac{691\,\pi^{12}}{638\,512\,875} \approx 1.000246\ldots \qedhere
  \end{align*}
\end{ejemplo}

\begin{comentario}
  Los valores $\zeta (3), \zeta (5), \zeta (7), \ldots$ son más misteriosos.
  \emph{Al parecer}, son números trascendentes. Por supuesto, los números
  $$\zeta (2k) = (-1)^{k+1} \, B_{2k}\,\frac{2^{2k-1}}{(2k)!}\,\pi^{2k}$$
  son también trascendentes, ya que $\pi$ es trascendente. Los valores $\zeta
  (2k+1)$ deberían de ser trascendentes por alguna razón más sofisticada, y se
  supone que entre $\zeta (2k+1)$ distintos no hay ninguna relación algebraica.
  Sin embargo, todavía no hay demostraciones ni siquiera de que los $\zeta
  (2k+1)$ sean irracionales. En 1977 el matemático francés Roger Apéry demostró
  que el número
  $$\zeta (3) \approx 1.20205690315959428539973816\ldots$$
  es irracional. La tumba de Apéry en París lleva la inscripción
  \begin{center}
    \noindent\textsc{Roger APÉRY}
    \noindent\textsc{1916--1994}

    \vspace{0.7em}

    \noindent\rule{1cm}{0.4mm}

    \vspace{1em}

    \noindent$1 + \frac{1}{8} + \frac{1}{27} + \frac{1}{64} + \cdots \ne \frac{p}{q}$
  \end{center}
  \noindent Para más información sobre el teorema de Apéry, véase el artículo
  \cite{van-der-Poorten-1978}.
  Los métodos de Apéry no se generalizan para demostrar que $\zeta (5)$ es
  irracional. Hay pocos resultados en esta dirección. Rivoal demostró en 2000
  que entre los números $\zeta (3), \zeta (7), \zeta (9), \ldots$ hay una
  infinidad de irracionales \cite{Rivoal-2000}, mientras que Zudilin demostró
  que por lo menos un número entre $\zeta(5)$, $\zeta(7)$, $\zeta(9)$ y
  $\zeta(11)$ es irracional \cite{Zudilin-2004}.
\end{comentario}

\begin{corolario}
  $(-1)^{k+1}\,B_{2k} > 0$ para $k \ge 1$. Es decir, $B_{2k} \ne 0$, y los
  signos son alternantes.

  \begin{proof}
    Se sigue inmediatamente de la fórmula
    $(-1)^{k+1}\, B_{2k} = \frac{(2k)!}{2^{2k-1}\,\pi^{2k}} \, \zeta (2k)$.
    Esto también puede ser deducido directamente de la definición de $B_{2k}$,
    pero la fórmula para $\zeta (2k)$ nos da mejor explicación.
  \end{proof}
\end{corolario}

\begin{corolario}
  Se tiene $|B_{2k+2}| > |B_{2k}|$ para $k \ge 3$.

  \begin{proof}
    Basta aplicar la fórmula
    $$|B_{2k}| = \frac{2\cdot (2k)!}{(2\pi)^{2k}}\,\zeta (2k),$$
    y notar que la función $\zeta (s+c)/\zeta (s)$ crece para todo $c > 0$
    (por ejemplo, calcule que $\frac{d}{ds} \log \zeta (s+c)/\zeta (s) > 0$,
    usando la fórmula del producto).
  \end{proof}
\end{corolario}

\begin{corolario}
  Para $n = 0,1,2,3,\ldots$ se tiene
  $$\zeta (-n) = -\frac{B_{n+1}}{n+1}.$$

  \begin{proof}
    De la ecuación funcional \eqref{eqn:ecuacion-funcional-para-zeta-de-Riemann}
    se ve que $\zeta (-2k) = 0$ (se anula $\sin (-\pi k/2)$). Esto coincide con
    el hecho de que $B_n = 0$ para $n > 1$ impar. Por otra parte, para
    $s = -(2k+1)$ impar la fórmula de Euler se simplifica a
    $\zeta (-(2k+1)) = -\frac{B_{2k+2}}{2k+2}$. En fin, de la ecuación funcional
    se deduce que $\zeta (0) = -\frac{1}{2} = -B_1$.
  \end{proof}
\end{corolario}

\subsection{Números de Bernoulli torcidos por un carácter de Dirichlet}

Recordemos que la función zeta de Riemann es un caso particular de las series L
de Dirichlet $L (s,\chi)$ cuando $\chi = 1$. A continuación nos gustaría
generalizar la fórmula $\zeta (-n) = -\frac{B_{n+1}}{n+1}$ a
$L (-n,\chi) = -\frac{B_{\chi,n+1}}{n+1}$, donde $B_{\chi,n+1}$ son números
racionales que generalizan los números de Bernoulli.

\begin{definicion}
  Dado un carácter de Dirichlet $\chi$ mód $m$, los
  \textbf{números de Bernoulli generalizados} («torcidos» por $\chi$) se definen
  mediante la función generatriz
  $$\sum_{k\ge 0} B_{k,\chi}\,\frac{t^k}{k!} = \sum_a \frac{\chi (a)\,t\,e^{at}}{e^{mt} - 1},$$
  donde la suma es sobre $1 \le a \le m-1$. A partir de ahora estas sumas serán
  denotadas simplemente por $\sum\limits_a$.
\end{definicion}

Notamos que $B_{k,\chi} \in \QQ (\zeta_m)$.

\begin{proposicion}
  \label{prop:propiedades-de-numeros-de-Bernoulli-generalizados}
  \begin{enumerate}
  \item[a)] Para $\chi \ne 1$ se tiene $B_{k,\chi} = 0$ si
    $\chi (-1) = (-1)^{k+1}$.

  \item[b)] Los números de Bernoulli $B_{k,\chi}$ están relacionados con los
    polinomios de Bernoulli mediante la fórmula
    $$B_{k,\chi} = m^{k-1} \, \sum_a \chi (a)\,B_k (a/m).$$
  \end{enumerate}

  \begin{proof}
    Para la propiedad a), basta notar que para la función generatriz
    $f (t) = \sum_a \frac{\chi (a)\,t\,e^{at}}{e^{mt}-1}$
    se tiene $f (t) = \chi (-1) \, f (-t)$. Entonces, $f (t)$ es una función par
    o impar, dependiendo de la paridad de $\chi$.

    Para la propiedad b), podemos considerar la función generatriz para los
    polinomios de Bernoulli
    $$\sum_{k \ge 0} B_k (x) \, \frac{t^k}{k!} = \frac{t\,e^{tx}}{e^t - 1}.$$
    Al sustituir $x = a/m$ y remplazar $t$ por $mt$, nos queda
    \[ \sum_{k \ge 0} \sum_a \chi (a)\,B_k (a/m) \, \frac{(mt)^k}{k!} =
       \sum_a \frac{\chi(a)\,mt\,e^{t\,a}}{e^{mt}-1} =
       m\,\sum_{k\ge 0} B_{k,\chi}\,\frac{t^k}{k!}. \]
    Basta comparar los coeficientes.
  \end{proof}
\end{proposicion}

\begin{ejemplo}
  Un carácter no trivial mód $4$ viene dado por
  $$\chi\colon 1 \mapsto +1, \quad 3 \mapsto -1.$$
  Entonces, los números de Bernoulli correspondientes se definen por por
  la función generatriz
  \[ \sum_{k\ge 0} B_{k,\chi}\,\frac{t^k}{k!} =
     t\,\frac{e^t - e^{3t}}{e^{4t}-1}
     = -\frac{te^t}{e^{2t}+1}. \]
  El carácter $\chi$ es impar, así que $B_{k,\chi} = 0$ para los $k$ pares. Para
  los impares, calculamos los siguientes valores.

  \begin{center}
    \renewcommand{\arraystretch}{1.5}
    \begin{tabular}{rcccccccc}
      \hline
      $k\colon$ & $1$ & $3$ & $5$ & $7$ & $9$ & $11$ & $13$ & $15$ \\
      \hline
      $B_{k,\chi}\colon$ & $-\frac{1}{2}$ & $+\frac{3}{2}$ & $-\frac{25}{2}$ & $+\frac{427}{2}$ & $-\frac{12465}{2}$ & $+\frac{555731}{2}$ & $-\frac{35135945}{2}$ & $+\frac{2990414715}{2}$ \\
      \hline
    \end{tabular}
  \end{center}

\begin{shaded}\small
\begin{verbatim}
? default(seriesprecision,16);
? f = -t*exp(t)/(exp(2*t)+1);
? vector (8,k, (2*k-1)!*polcoeff(f,2*k-1))
% = [-1/2, 3/2, -25/2, 427/2, -12465/2, 555731/2, -35135945/2, 2990414715/2]
\end{verbatim}
\end{shaded}
\end{ejemplo}

\subsection{Sumas de Gauss para caracteres de Dirichlet}

\begin{definicion}
  Sea $\chi$ un carácter de Dirichlet primitivo mód $m$.
  La \textbf{suma de Gauss} correspondiente viene dada por
  $$g (\chi) = \sum_a \chi (a) \, \zeta_m^a,$$
  donde $\zeta_m = e^{2\pi i/m}$. En general, para todo entero $n$ pongamos
  $$g_n (\chi) = \sum_a \chi (a) \, \zeta_m^{an}.$$
\end{definicion}

Vamos a necesitar un par de propiedades básicas de sumas de Gauss. El caso de
$m = p$ primo ya fue considerado en nuestra prueba de la reciprocidad cuadrática
en \S\ref{sec:reciprocidad-cuadratica}.

\begin{lema}
  \label{lema:sumas-de-Gauss-1}
  Para todo $n \in \mathbb{Z}$ se tiene
  $$\overline{\chi (n)} \, g (\chi) = g_n (\chi).$$
  En particular (tomando $n = -1$ y los conjugados),
  $$\overline{g (\chi)} = \chi (-1)\,g (\overline{\chi}).$$

  \begin{proof}
    Si $\gcd (n,m) = 1$, entonces la multiplicación por $n$ nos da
    un automorfismo de $(\mathbb{Z}/m\mathbb{Z})^\times$, y luego
    \begin{align*}
      \overline{\chi (n)} \, g (\chi) & = \overline{\chi (n)}\,\sum_a \chi (a) \, \zeta_m^a\\
      & = \chi (n)^{-1}\,\sum_a \chi (an) \, \zeta_m^{an}\\
      & = \sum_a \chi (a) \, \zeta_m^{an} \\
      & = g_n (\chi).
    \end{align*}
    Por otra parte, si $\gcd (n,m) \ne 1$, entonces $\chi (n) = 0$,
    y afirmamos que
    $$g_n (\chi) = \sum_a \chi (a) \, \zeta_m^{an} = 0.$$
    Para esto escribamos $d = \gcd (n,m)$. Notamos que $\zeta_m^{an}$ depende
    de $a$ mód $m/d$, y los elementos que satisfacen $\gcd (a,m/d) = 1$ forman
    un subgrupo de $(\mathbb{Z}/m\mathbb{Z})^\times$, que es el núcleo del
    homomorfismo canónico sobreyectivo
    $(\mathbb{Z}/m\mathbb{Z})^\times \to (\mathbb{Z}/\frac{m}{d}\mathbb{Z})^\times$.
    Ahora
    $$\sum_{a \in (\mathbb{Z}/m\mathbb{Z})^\times} \chi (a) \, \zeta_m^{an} = \sum_{b \in (\mathbb{Z}/\frac{m}{d}\mathbb{Z})^\times} \left(\sum_{a \equiv b ~ (m/d)} \chi (a)\right)\,\zeta_m^{an},$$
    donde
    $$\sum_{a \equiv b ~ (m/d)} \chi (a) = \chi (b) \, \sum_{a \equiv 1 ~ (m/d)} \chi (a) = 0.$$
    En efecto, aquí $\chi$ es un carácter no trivial, así que siempre existe
    algún $c \in (\mathbb{Z}/m\mathbb{Z})^\times$ tal que
    $\chi (c) \ne 1$. Luego,
    $$\sum_{a \equiv 1 ~ (m/d)} \chi (a) = \sum_{a \equiv 1 ~ (m/d)} \chi (ac) = \chi (c)\,\sum_{a \equiv 1 ~ (m/d)} \chi (a),$$
    lo que implica que la suma es nula.
  \end{proof}
\end{lema}

\begin{lema}
  \label{lema:sumas-de-Gauss-2}
  $$|g (\chi)|^2 = g (\chi)\,\overline{g (\chi)} = m.$$
  En particular (usando \ref{lema:sumas-de-Gauss-1}),
  $$g (\chi)^{-1} = \frac{1}{m}\,\chi (-1)\,g (\overline{\chi}).$$

  \begin{proof}
    Según el lema anterior, para todo $n$ se cumple
    $$|\chi(n)|^2\,|g (\chi)|^2 = |g_n (\chi)|^2.$$
    Aquí
    \[ |\chi (n)| = \begin{cases}
      1, & \gcd (n,m) = 1,\\
      0, & \gcd (n,m) \ne 1.
    \end{cases} \]
    Calculamos que
    $$\phi (m)\,|g (\chi)|^2 = \sum_{1 \le n \le m-1} |\chi (n)|^2\,|g (\chi)|^2 = \sum_{1 \le n \le m-1} |g_n (\chi)|^2.$$
    Por otra parte, la última suma es
    \begin{align*}
      \sum_{1 \le n \le m-1} |g_n (\chi)|^2 & = \sum_{1 \le n \le m-1} g_n (\chi) \, \overline{g_n (\chi)} \\
      & = \sum_{1 \le a,b \le m-1} \chi (a)\,\overline{\chi (b)}\, \sum_{1 \le n \le m-1} \zeta_m^{(a-b)\,n}, \\
      & = \phi (m)\,m,
    \end{align*}
    usando
    \[ \sum_{1 \le n \le m-1} \zeta_m^{(a-b)\,n} = \begin{cases}
      0, & a \ne b,\\
      m, & a = b.
    \end{cases} \]
    Esto concluye la prueba.
  \end{proof}
\end{lema}

\subsection{Valores especiales de las series L de Dirichlet}

Estamos listos para formular y probar el resultado principal de esta sección.

\begin{teorema}
  Sean $\chi$ un carácter de Dirichlet primitivo mód $m$ y $k > 1$ un número
  natural tal que $\chi (-1) = (-1)^k$. Entonces,
  $$L (k,\chi) = (-1)^{k+1} \, \frac{(2\pi i)^k}{2\cdot k! \, m^k}\,g (\chi)\,B_{k,\overline{\chi}}.$$
\end{teorema}

Esto nos da \emph{la mitad} de los valores especiales: $L (k,\chi)$,
donde la paridad de $k$ corresponde a la paridad del carácter.

\begin{proof}
  La fórmula del lema~\ref{lema:sumas-de-Gauss-1} nos da para todo
  $n \in \mathbb{Z}$
  \[ \chi (n)\,g (\overline{\chi}) =
     \sum_a \overline{\chi (a)}\,\zeta^{an}_m. \]
  Gracias a esto, podemos escribir
  \[ L (k,\chi)\,g (\overline{\chi}) =
     \sum_a \overline{\chi (a)} \, \sum_{n\ge 1} \frac{\zeta_m^{an}}{n^k}. \]
  Puesto que $\chi (-1) = (-1)^k$, tenemos
  \[ L (k,\chi)\,g (\overline{\chi}) =
     \frac{1}{2} \sum_a \overline{\chi (a)} \sum_{\substack{n \in \mathbb{Z} \\ n \ne 0}} \frac{\zeta_m^{an}}{n^k}. \]

  Recordemos la serie de Fourier para los polinomios de Bernoulli:
  \[ B_k (x - \lfloor x\rfloor) =
     -\frac{k!}{(2\pi i)^k} \, \sum_{\substack{n \in \mathbb{Z} \\ n \ne 0}} \frac{e^{2\pi i n x}}{n^k}. \]
  En particular, sustituyendo $x = a/m$, se obtiene
  \[ \sum_{\substack{n \in \mathbb{Z} \\ n \ne 0}} \frac{\zeta_m^{an}}{n^k} =
     -\frac{(2\pi i)^k}{k!}\,B_k (a/m). \]
  Y usando la expresión para $B_{k,\chi}$ en términos de $B_k (x)$,
  \[ L (k,\chi)\,g (\overline{\chi}) =
     -\frac{(2\pi i)^k}{2\cdot k!} \sum_a \overline{\chi (a)} B_k (a/m) =
     -\frac{(2\pi i)^k}{2\cdot k!\,m^{k-1}}\,B_{k,\overline{\chi}}. \]
  En fin, dado que
  \[ g (\overline{\chi})^{-1} =
     \frac{1}{m}\,\chi (-1)\,g (\chi) =
     \frac{1}{m}\,(-1)^k\,g (\chi) \]
  por el lema~\ref{lema:sumas-de-Gauss-2}, llegamos a la fórmula deseada
  \[ L (k,\chi) = (-1)^{k+1}\,\frac{(2\pi i)^k}{2\cdot k!\,m^k}\,g (\chi)\,B_{k,\overline{\chi}}. \qedhere \]
\end{proof}

\begin{corolario}
  \label{cor:no-anulacion-de-B-k-chi}
  Si $\chi (-1) = (-1)^k$ para $k > 1$, entonces $B_{k,\chi} \ne 0$.

  \begin{proof}
    La fórmula del producto de Euler
    $L (s,\chi) = \prod_p \frac{1}{1 - \chi (p)\,p^{-s}}$
    implica que $L (s,\chi) \ne 0$ para ${s > 1}$.
  \end{proof}
\end{corolario}

\begin{corolario}
  \label{cor:valores-negativos-de-series-L}
  Para todo $n = 0,1,2,3,\ldots$ se tiene
  $$L (-n,\chi) = -\frac{B_{n+1,\chi}}{n+1}.$$

  \begin{proof}
    Se sigue de la ecuación funcional
    \eqref{eqn:ecuacion-funcional-para-series-L}. Los detalles se dejan como un
    ejercicio.
  \end{proof}
\end{corolario}

\subsection{Ejemplo: Campos reales abelianos}

Estamos listos para probar el teorema de Siegel--Klingen para las extensiones
abelianas.

\begin{teorema}
  Si $K/\QQ$ es un campo de números totalmente real abeliano, entonces
  $\zeta_K (-n)$ son números racionales no nulos para $n = 1,3,5,\ldots$

  \begin{proof}
    Dado que $K/\QQ$ es una extensión abeliana, tenemos la descomposición de la
    función zeta
    $$\zeta_K (s) = \prod_{\chi\in X} L (s,\chi),$$
    donde $X \subseteq \widehat{(\ZZ/m\ZZ)^\times}$ es el grupo de caracteres de
    Dirichlet que corresponde a $K \subseteq \QQ (\zeta_m)$. Ahora ocupando
    nuestras fórmulas para los valores especiales de funciones $L$ de Dirichlet
    (corolario~\ref{cor:valores-negativos-de-series-L}),
    $$\zeta_K (-n) = (-1)^{[K:\QQ]}\,\prod_{\chi\in X} \frac{B_{n+1,\chi}}{n+1}.$$
    Puesto que $K$ es un campo totalmente real, para todo $\chi \in X$ se tiene
    $\chi (-1) = +1$, así que $B_{n+1,\chi} \ne 0$ para $n$ impar
    (corolario~\ref{cor:no-anulacion-de-B-k-chi}). Esto también se sigue del
    hecho de que el orden de anulación de $\zeta_K (s)$ para
    $s = -1, -3, -5, \ldots$ es igual a $r_2$, y en nuestro caso $r_2 = 0$.
    Los números de Bernoulli generalizados $B_{n+1,\chi}$ están en la extensión
    ciclotómica $\QQ (\zeta_m)$, y nos gustaría ver que el producto
    $\prod_{\chi\in X} B_{n+1,\chi}$ es un número racional. Para esto podemos
    ocupar la fórmula
    $$B_{n+1,\chi} = m^n\,\sum_{1 \le a \le m-1} \chi (a)\,B_{n+1} (a/m)$$
    (proposición~\ref{prop:propiedades-de-numeros-de-Bernoulli-generalizados}).
    Los caracteres $\chi\in X$ pueden ser identificados con caracteres de Galois
    $\Gal (K/\QQ) \to \CC^\times$, y el grupo $\Gal (\QQ (\zeta_m)/\QQ)$ actúa
    sobre $\chi\in X$ permutando las raíces de la unidad complejas. Entonces,
    para todo automorfismo $\sigma \in \Gal (\QQ (\zeta_m)/\QQ)$ se tiene
    $\sigma (B_{n+1,\chi}) = B_{n+1,\sigma\cdot\chi}$. En particular, $\sigma$
    deja fijo el producto $\prod_{\chi\in X} B_{n+1,\chi}$, así que este es un
    número racional.
  \end{proof}
\end{teorema}

Veamos un par de ejemplos particulares.

\begin{ejemplo}
  En el ejemplo \ref{ej:Q-zeta-7-real-zeta-descomp} hemos calculado que si $K$
  es el subcampo cúbico real en $\QQ (\zeta_7)$, entonces
  $$\zeta_K (s) = \zeta (s) \, L (s,\chi) \, L (s,\chi^2),$$
  donde $\chi$ es el carácter cúbico mód $7$. Calculamos los números de
  Bernoulli correspondientes. Notamos que
  $B_{k,\chi^2} = B_{k,\overline{\chi}} = \overline{B_{k,\chi}}$, así que
  $B_{k,\chi}\,B_{k,\chi^2} = |B_{k,\chi}|^2$.

  \begin{center}
    \renewcommand{\arraystretch}{1.5}
    \begin{tabular}{rcccccccccc}
      \hline
      $k\colon$ & $1$ & $2$ & $3$ & $4$ & $5$ & $6$ & $7$ & $8$ & $9$ & $10$ \\
      \hline
      $B_k\colon$ & $\frac{1}{2}$ & $\frac{1}{6}$ & $0$ & $-\frac{1}{30}$ & $0$ & $\frac{1}{42}$ & $0$ & $-\frac{1}{30}$ & $0$ & $\frac{5}{66}$ \\
      \hline
      $B_{k,\chi}\colon$ & $0$ & $\frac{8-4\,\zeta_3}{7}$ & $0$ & $\frac{-128 + 88\,\zeta_3}{7}$ & $0$ & $672 - 516\,\zeta_3$ & $0$ & $\frac{-324736 + 257456\,\zeta_3}{7}$ & $0$ & $\frac{36199840 - 28945220\,\zeta_3}{7}$ \\
      \hline
      $B_{k,\chi}\,B_{k,\chi^2}\colon$ & $0$ & $\frac{16}{7}$ & $0$ & $\frac{5056}{7}$ & $0$ & $1064592$ & $0$ & $\frac{36477470464}{7}$ & $0$ & $\frac{456580929948400}{7}$ \\
      \hline
      $\zeta_K (1-k)\colon$ & $0$ & $-\frac{1}{21}$ & $0$ & $\frac{79}{210}$ & $0$ & $-\frac{7393}{63}$ & $0$ & $\frac{142490119}{420}$ & $0$ & $-\frac{1141452324871}{231}$ \\
      \hline
    \end{tabular}
  \end{center}

  \begin{shaded}
\begin{verbatim}
? f = x^3 + x^2 - 2*x - 1;
? for (k=1,10, print ([-k, bestappr (lfun(f,-k))]))
[-1, -1/21]
[-2, 0]
[-3, 79/210]
[-4, 0]
[-5, -7393/63]
[-6, 0]
[-7, 142490119/420]
[-8, 0]
[-9, -1141452324871/231]
[-10, 0]
\end{verbatim}
\end{shaded}
\end{ejemplo}

\begin{ejemplo}
  En \ref{ej:sqrt-2-sqrt-3-zeta-descomp} notamos que para
  $K = \QQ (\sqrt{2},\sqrt{3})$ se tiene
  $$\zeta_K (s) = \zeta (s)\,\zeta (s,\chi_1)\,\zeta (s,\chi_2)\,\zeta (s,\chi_1)\,\zeta (s,\chi_1\chi_2),$$
  donde $\chi_1$ y $\chi_2$ son ciertos caracteres mód $8$ y mód $12$
  respectivamente. Calculamos los números de Bernoulli correspondientes.

  \begin{center}
    \renewcommand{\arraystretch}{1.5}
    \begin{tabular}{rcccccccccc}
      \hline
      $k\colon$ & $1$ & $2$ & $3$ & $4$ & $5$ & $6$ & $7$ & $8$ & $9$ & $10$ \\
      \hline
      $B_k\colon$ & $\frac{1}{2}$ & $\frac{1}{6}$ & $0$ & $-\frac{1}{30}$ & $0$ & $\frac{1}{42}$ & $0$ & $-\frac{1}{30}$ & $0$ & $\frac{5}{66}$ \\
      \hline
      $B_{k,\chi_1}\colon$ & $0$ & $2$ & $0$ & $-44$ & $0$ & $2166$ & $0$ & $-196888$ & $0$ & $28730410$ \\
      \hline
      $B_{k,\chi_2}\colon$ & $0$ & $4$ & $0$ & $-184$ & $0$ & $20172$ & $0$ & $-4120688$ & $0$ & $1352745620$ \\
      \hline
      $B_{k,\chi_1 \chi_2}\colon$ & $0$ & $12$ & $0$ & $-2088$ & $0$ & $912996$ & $0$ & $-745928016$ & $0$ & $979492656060$ \\
      \hline
      $\zeta_K (1-k)\colon$ & $0$ & $1$ & $0$ & $\frac{22011}{10}$ & $0$ & $\frac{2198584943}{3}$ & $0$ & $\frac{98499651123679091}{20}$ & $0$ & $\frac{3172326639386146564271121}{11}$ \\
      \hline
    \end{tabular}
  \end{center}

  Por ejemplo,
  $$\zeta_K (-1) = \frac{B_2}{2}\,\frac{B_{2,\chi_1}}{2}\,\frac{B_{2,\chi_2}}{2}\,\frac{B_{2,\chi_1\chi_2}}{2} = 1.$$

  \begin{shaded}
\begin{verbatim}
? f = x^4 - 10*x^2 + 1;
? for (k=0,9, print ([-k, bestappr (lfun(f,-k))]))
[0, 0]
[-1, 1]
[-2, 0]
[-3, 22011/10]
[-4, 0]
[-5, 2198584943/3]
[-6, 0]
[-7, 98499651123679091/20]
[-8, 0]
[-9, 26096408689669293746412345882494627023907453563824990777421065 /
     90488946510851474588918352998651662532]

? bestappr (lfun (f,-9), 11)
% = 3172326639386146564271121/11

? default(realprecision, 100)
? bestappr (lfun (f,-9))
% = 3172326639386146564271121/11
\end{verbatim}
\end{shaded}

  Aquí la primera aproximación racional a $\zeta_K (-9)$ es equivocada porque
  con la precisión por defecto, PARI/GP obtiene el valor aproximado
  $288393330853286051297374.63636363636364$, y aquí hay muy pocos dígitos
  después de la coma flotante. Para el valor correcto, se puede especificar
  que nos interesa aproximación con el denominador $\le 11$, o aumentar
  la precisión.
\end{ejemplo}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% \pdfbookmark{Clase 30 (02/12/20)}{clase-30}
\section{Equivalencia aritmética}
\marginpar{\small Clase 30 \\ 02/12/20}

La fórmula del número de clases nos sugiere que la función zeta $\zeta_K (s)$
trae mucha información aritmética sobre el campo de números $K$, pero
$\zeta_K (s)$ no sabe \emph{todo} de $K$: es posible que
$\zeta_K (s) = \zeta_{K'} (s)$ para dos campos no isomorfos $K \not\cong
K'$. Aún así, si dos campos comparten la misma función zeta, estos tienen muchas
propiedades en común. Este será el tema de la presente sección. La referencia
original es el artículo \cite{Perlis-1977}, y también recomiendo los apuntes
\cite{Sutherland-AE}.

\begin{definicion}
  Se dice que dos campos de números $K/\QQ$ y $K/\QQ$ son
  \textbf{aritméticamente equivalentes} si $\zeta_K (s) = \zeta_{K'} (s)$.
\end{definicion}

Está claro que esta es una relación de equivalencia, y si $K\cong K'$, entonces
los campos son aritméticamente equivalentes. Nuestro objetivo es entender qué
precisamente significa la equivalencia aritmética. Primero vamos a revisar
la ecuación funcional para $\zeta_K (s)$. Nos conviene reescribirla de manera
más simétrica.

\begin{teorema}
  Definamos la \textbf{función zeta de Dedekind completada} por
  $$Z_K (s) = |\Delta_K|^{s/2}\,\Gamma_\RR (s)^{r_1}\,\Gamma_\CC (s)^{r_2}\,\zeta_K (s),$$
  donde
  \[ \Gamma_\RR (s) = \pi^{-s/2}\,\Gamma \Bigl(\frac{s}{2}\Bigr), \quad
    \Gamma_\CC (s) = 2\,(2\pi)^{-s}\,\Gamma (s). \]
  Luego, $Z_K (s)$ se extiende a una función meromorfa sobre todo el plano
  complejo con polos simples en $s = 0$ y $s = 1$ que satisface la ecuación
  funcional
  $$Z_K (s) = Z_K (1-s).$$

  \begin{proof}
    Véase por ejemplo \cite[\S VII.5]{Neukirch-ANT}.
  \end{proof}
\end{teorema}

La ecuación funcional impone cierta rigidez sobre $Z_K (s)$ y en particular
implica que esta función se determina por el producto de Euler para
$\zeta_K (s)$, posiblemente con un número finito de factores quitados.
Para verlo, necesitamos la siguiente observación.

\begin{lema}
  Dados números reales $1 < x_1 \le x_2 \le \cdots \le x_m$ y
  $1 < y_1 \le y_2 \le \cdots \le y_n$, definamos las funciones complejas
  \[ f (s) = \prod_{1\le i\le m} (1 - x_i^{-s}), \quad
    g (s) = \prod_{1\le j\le n} (1 - y_j^{-s}), \quad
    h (s) = \frac{f (s)}{g (s)}. \]

  Sea $\phi (s)$ una función meromorfa que no tiene ceros y polos en $s$ que
  coincide con los ceros o polos de $h (s)$. Supongamos que se cumple una
  ecuación funcional
  $$h (s) = \phi (s) \, h (1-s).$$
  Luego, $f (s) = g (s)$ y $\phi (s) = 1$.

  \begin{proof}
    Las funciones $f (s)$ y $g (s)$ no tienen polos, y sus ceros son
    $\frac{2\pi i k}{\log x_i}$ y $\frac{2\pi i k}{\log y_j}$ respectivamente
    para $k\in \ZZ$. Todo cero de $h (s)$ debe ser un cero de $f (s)$, y por
    nuestra hipótesis, este no puede ser un cero de $\phi (s)$. Además, las
    funciones $f (s)$ y $f (1-s)$ no tienen ceros en común (los ceros de $f (s)$
    cumplen $\Re s = 0$, mientras que los ceros de $f (1-s)$ cumplen
    $\Re s = 1$). Entonces, los ceros de $h (s)$ no pueden coincidir con los
    ceros de $h (1-s)$. Dado que $h (s) = \phi (s) \, h (1-s)$, esto implica que
    $h (s)$ no tiene ceros. De manera similar se demuestra que $h (s)$ no tiene
    polos. Entonces, $f (s)$ y $g (s)$ deben tener los mismos ceros de las
    mismas multiplicidades, así que $(x_1,\ldots,x_m) = (y_1,\ldots,y_n)$ y
    $f (s) = g (s)$. Se sigue que $h (s) = 1$ y $\phi (s) = 1$.
  \end{proof}
\end{lema}

\begin{proposicion}
  Sean $K/\QQ$ y $K'/\QQ$ dos campos de números, y supongamos que salvo un
  número finito de primos racionales $p \in \ZZ$ se cumple
  \[ \prod_{\mathfrak{p} \mid p\O_K} (1 - N_{K/\QQ} (\mathfrak{p})^{-s}) =
    \prod_{\mathfrak{p} \mid p\O_{K'}} (1 - N_{K'/\QQ} (\mathfrak{p})^{-s}). \]
  Luego, $\zeta_K (s) = \zeta_{K'} (s)$, $Z_K (s) = Z_{K'} (s)$,
  $[K:\QQ] = [K':\QQ]$, $r_1 = r'_1$, $r_2 = r'_2$, $\Delta_K = \Delta_{K'}$.

  \begin{proof}
    Sea $S$ el conjunto finito de primos racionales para cuales no se cumple la
    hipótesis de arriba. Podemos aplicar el lema anterior a las funciones
    \[ f (s) = \prod_{\substack{\mathfrak{p} \mid p\O_K \\ p\in S}} (1 - N_{K/\QQ} (\mathfrak{p})^{-s}), \quad
      g (s) = \prod_{\substack{\mathfrak{p} \mid p\O_{K'} \\ p\in S}} (1 - N_{K'/\QQ} (\mathfrak{p})^{-s}), \quad
      \phi (s) = \frac{Z_K (s) \, Z_{K'} (1-s) \, \zeta_{K'} (s) \, \zeta_K (1-s)}{Z_{K'} (s) \, Z_K (1-s) \, \zeta_K (s) \, \zeta_{K'} (1-s)}. \]

    De hecho, los ceros y polos de $Z_K (s)$ y $\zeta_K (s)$ están en $s = 0$ y
    $s = 1$, y estos no coinciden con los ceros de $f (s)$ y $f (g)$. Además,
    calculamos que $\phi (s)\,h (1-s) = h (s)$ usando
    $$\zeta_K (1-s)\,f (1-s) = \zeta_{K'} (1-s)\,g (1-s)$$
    ---por la definición, $f(s)$ y $g(s)$ precisamente corresponden a los
    factores de Euler de $\zeta_K (s)$ y $\zeta_{K'} (s)$ que no coinciden.

    Luego, el lema nos da $f (s) = g (s)$, lo que significa que
    $\zeta_K (s) = \zeta_{K'} (s)$. Recordemos que los ordenes de ceros
    de $\zeta_K (s)$ en enteros negativos $s = -n$ son $r_2$ o $r_1 + r_2$,
    dependiendo de la paridad de $n$. Entonces, la igualdad
    $\zeta_K (s) = \zeta_{K'} (s)$ implica que $r_1 = r'_1$ y $r_2 = r'_2$.
    Como consecuencia, $[K:\QQ] = r_1 + 2 r_2 = r'_1 + 2 r'_2 = [K':\QQ]$.

    Por el mismo lema anterior, se tiene $\phi (s) = 1$, de donde se deduce
    $$Z_K (s)^2 = Z_K (s)\,Z_K (1-s) = Z_{K'} (s)\,Z_{K'} (1-s) = Z_{K'} (s)^2.$$
    Calculamos el residuo
    \[ \lim_{s\to 1^+} (1-s)\,Z_K (s)^2 =
      |\Delta_K|\,\Bigl(\pi^{-1/2}\,\Gamma \Bigl(\frac{1}{2}\Bigr)\Bigr)^{2r_1}\,\Bigl(2\,(2\pi)^{-1}\,\Gamma (1)\Bigr)^{2r_2}\,\zeta_K^* (1)^2 =
      |\Delta_K|\,\pi^{-2r_2}\,\zeta_K^* (1)^2. \]
    Aquí usamos que $\Gamma \Bigl(\frac{1}{2}\Bigr) = \sqrt{\pi}$. Entonces,
    nuestra identidad nos da
    $$|\Delta_K|\,\pi^{-2r_2} = |\Delta_{K'}|\,\pi^{-2r'_2},$$
    de donde $|\Delta_K| = |\Delta_K'|$. Recordemos que el signo del
    discriminante es $(-1)^{r_2}$, así que $\Delta_K = \Delta_{K'}$.
  \end{proof}
\end{proposicion}

Ahora si $p\in \ZZ$ es un primo racional que no se ramifica en $K$ (es decir,
$p\nmid \Delta_K$), entonces se tiene factorización
$p\O_K = \mathfrak{p}_1 \cdots \mathfrak{p}_s$, donde los grados de campos
residuales $f_i = [\O_K/\mathfrak{p}_i : \FF_p]$ satisfacen
$f_1 + \cdots + f_s = [K : \QQ]$. De esta manera a cada primo no ramificado
corresponde una partición de $[K : \QQ]$, y esta se llama el
\textbf{tipo de descomposición} de $p$. El siguiente resultado explica el
término «equivalencia aritmética».

\begin{teorema}
  Las siguientes condiciones son equivalentes.
  \begin{enumerate}
  \item[1)] $\zeta_K (s) = \zeta_{K'} (s)$,

  \item[2)] los tipos de descomposición de $p$ en $K$ y $K'$ coinciden para todo
    $p$ no ramificado,

  \item[3)] los tipos de descomposición de $p$ en $K$ y $K'$ coinciden para todo
    $p$, salvo un número finito.
  \end{enumerate}

  En particular, dos campos aritméticamente equivalentes necesariamente
  comparten el grado $[K : \QQ]$, el número de encajes reales $r_1$ y complejos
  $r_2$, y el discriminante $\Delta_K$.

  \begin{proof}
    Para $n \ge 1$ denotemos por $a_n$ el número de ideales en $\O_K$ de norma
    $n$. Tenemos $\zeta_K (s) = \sum_{n\ge 1} \frac{a_n}{n^s}$, y si
    $\zeta_K (s) = \zeta_{K'} (s)$, entonces $a_n = a'_n$ para todo $n \ge 1$
    porque para una serie de Dirichlet los coeficientes $a_n$ están definidos de
    modo único.

    Ahora si $p\O_K = \mathfrak{p}_1\cdots \mathfrak{p}_s$, entonces
    $N_{K/\QQ} (\mathfrak{p}_i) = p^{f_i}$. Se sigue que $a_p$ es el número de
    ideales primos sobre $p$ con el grado del campo residual $f = 1$.
    Luego, el número de ideales primos con $f = 2$ será
    $a_{p^2} - {a_p \choose 2} - a_p$.  De la misma manera, el número de ideales
    primos con el grado del campo residual $f$ se expresa mediante
    $a_p, a_{p^2}, \ldots, a_{p^{f-1}}$. Entonces, los coeficientes $a_n$
    determinan los tipos de descomposición de primos racionales en $K$.  Dado
    que $a_n = a'_n$, los tipos de descomposición serán los mismos en $K$ y
    $K'$. Esto establece la implicación 1)$\Rightarrow $2), y la implicación
    2)$\Rightarrow$3) es trivial.

    Para la implicación 3)$\Rightarrow$1), notamos que si los tipos de
    descomposición coinciden, posiblemente salvo un número finito de primos $p$,
    entonces los factores de Euler
    \[ \prod_{\mathfrak{p} \mid p\O_K} (1 - N_{K/\QQ} (\mathfrak{p})^{-s}) =
      \prod_{\mathfrak{p} \mid p\O_{K'}} (1 - N_{K'/\QQ} (\mathfrak{p})^{-s}). \]
    coinciden, salvo un número finito de $p$. La proposición de arriba implica
    que $\zeta_K (s) = \zeta_{K'} (s)$.
  \end{proof}
\end{teorema}

\subsection{Triplas de Gassmann}

El matemático suizo Fritz Gassmann (1899--1990) encontró en 1926 una
caracterización elemental de la equivalencia aritmética, que da una manera
eficaz de verificarla y construir ejemplos no triviales con $K$ y $K'$ no
isomorfos.

\begin{definicion}
  Sean $G$ un grupo finito y $H, H'$ sus subrupos. Se dice que $(G,H,H')$ es una
  \textbf{tripla de Gassmann} si existe una biyección entre $H$ y $H'$ que
  preserva las clases de conjugación en $G$. En otras palabras, si para todo
  $g \in G$ se tiene
  $$\# (H\cap g^G) = \# (H'\cap g^G),$$
  donde $g^G$ denota la clase de conjugación de $g$.
\end{definicion}

Gassmann probó el siguiente resultado.

\begin{teorema}
  \label{thm:Gassmann}
  Sean $K$ y $K'$ dos campos de números y $L/\QQ$ una extensión de Galois tal
  que $K, K' \subseteq L$ (por ejemplo, la cerradura de Galois del compositum
  $K K'$). Entonces, $K$ y $K'$ son aritméticamente equivalentes si y solamente
  si
  $$(\Gal (L/\QQ), \, \Gal (L/K), \, \Gal (L/K'))$$
  es una tripla de Gassmann.
\end{teorema}

El teorema de Gassmann nos permite construir ejemplos de campos no isomorfos
aritméticamente equivalentes. Para esto basta encontrar una tripla de Gassmann
$(G, H, H')$ con $H$ y $H'$ subgrupos no conjugados en $G$ y saber realizar $G$
como el grupo de Galois de alguna extensión $L/\QQ$\footnote{Recordemos que el
  \textbf{problema inverso} de la teoría de Galois afirma que cualquier grupo
  finito $G$ se realiza como un grupo de Galois de $L/\QQ$. Esta es una gran
  conjetura, pero la solución existe para muchos $G$ y varias familias
  infinitas.}. Luego basta tomar $K = L^H$ y $K' = L^{H'}$, y puesto que $H$ y
$H'$ no son conjugados, tendremos $K \not\cong K'$.

Una manera fácil de construir triplas de Gassmann no triviales es la siguiente.

\begin{proposicion}
  Para un grupo finito $H$ definamos la \textbf{estadística de ordenes} como la
  función
  \[ \phi_H\colon \NN \to \NN, \quad
    n \mapsto \# \{ h\in H \mid \ord h = n \}. \]
  Para dos grupos finitos $H$ y $H'$ existe una tripla de Gassmann $(G,H,H')$
  si y solamente si $\phi_H = \phi_{H'}$.

  \begin{proof}
    En una dirección, si $(G,H,H')$ es una tripla de Gassmann, entonces por la
    definición existe una biyección $H \leftrightarrow H'$ que preserva las
    clases de conjugación en $G$, y los elementos cada clase de conjugación
    tienen el mismo orden, así que $\phi_H = \phi_{H'}$.

    En la otra dirección, supongamos que $\phi_H = \phi_{H'}$. Pongamos
    $n = \# H = \# H'$ y sea $G$ el grupo simétrico $S_n$. La acción de $H$
    sobre sí mismo mediante la multiplicación por la izquierda nos da encajes
    $H, H' \hookrightarrow G$. Todo $h \in H$ da lugar a una permutación que
    consiste en $\frac{n}{\ord h}$ ciclos de longitud $\ord h$. Ahora $h \in H$
    y $h' \in H'$ serán conjugados en $G$ si y solamente si $\ord h = \ord h'$.
    Dado que $\phi_H = \phi_{H'}$, podemos escoger una biyección
    $H \leftrightarrow H'$ que preserva los ordenes de elementos, y luego las
    clases de conjugación en $G$. Esto nos da una tripla de Gassmann $(G,H,H')$.
  \end{proof}
\end{proposicion}

Todo grupo simétrico se realiza como un grupo de Galois de alguna extensión
$L/\QQ$, así que el último argumento nos permite construir ejemplos de
equivalencia aritmética. Sin embargo, la extensión $L/\QQ$ tendrá grado $n!$,
así que este método no será muy eficaz.

\begin{ejemplo}
  Con ayuda de computadora, ocupando el programa
  GAP\footnote{\url{https://gap-system.org/}}, se pueden buscar grupos no
  isomorfos $H$ y $H'$ de pequeño orden $\# H = \# H'$ tales que
  $\phi_H = \phi_{H'}$. Resulta que el ejemplo más pequeño se realiza por grupos
  de orden $16$. Por ejemplo, podemos tomar $H = \ZZ/4\ZZ \oplus \ZZ/4\ZZ$ y el
  producto semidirecto no trivial
  $H' = \ZZ/4\ZZ \rtimes \ZZ/4\ZZ$.\footnote{Estos dos grupos están tabulados en
    \emph{Small Groups Library} de GAP como \texttt{[16,2]} y \texttt{[16,4]}.}

  Las clases de conjugación en $H$ son triviales. Hay tres elementos de orden
  $2$: estos son $(0,2)$, $(2,0)$, $(2,2)$. El resto de elementos no triviales
  tienen orden $4$, en total son $16 - 3 - 1 = 12$. Por otra parte, en $H'$ las
  clases de conjugación son las siguientes.

  \begin{center}
    \renewcommand{\arraystretch}{1.5}
    \begin{tabular}{rccc}
      \hline
      orden de elementos: & $1$ & $2$ & $4$ \\
      \hline
      tamaño de clase: & $1$ & $1$ & $2$ \\
      \hline
      número de clases: & $1$ & $3$ & $6$ \\
      \hline
    \end{tabular}
  \end{center}
  La estadística de ordenes es la misma. \qedhere
\end{ejemplo}

\begin{ejemplo}
  Por otra parte, la búsqueda en GAP nos dice que el grupo más pequeño $G$ que
  admite una tripla de Gassmann $(G,H,H')$ con $H$ y $H'$ no conjugados tiene
  orden $32$ (en la notación de GAP, este es \texttt{[32,43]}).

  \begin{shaded}\small
\begin{verbatim}
isGassmannTripple := function (H,Hp,cc)
  local c;

  for c in cc do
    if Size(Intersection(H,c)) <> Size(Intersection(Hp,c)) then
      return false;
    fi;
  od;

  return true;
end;;
\end{verbatim}
  \end{shaded}

  Para obtener campos $K$ y $K'$ de grado menor posible,
  vamos a minimizar el índice $[G:H]$ / maximizar el orden $\# H$.

  \begin{shaded}
\begin{verbatim}
findGassmannTriple := function (G)
  local cc, ccSubgr, i, j, H, Hp, hSize, triple;

  triple := [];
  hSize := 0;
  triple := [];

  cc := ConjugacyClasses(G);
  ccSubgr := ConjugacyClassesSubgroups(G);

  for i in [1..Size(ccSubgr)] do
    for j in [i+1..Size(ccSubgr)] do
      # H and H' must have the same size
      if (Size(Representative(ccSubgr[i])) <>
            Size(Representative(ccSubgr[j]))) then
        continue;
      fi;

      for H in Elements (ccSubgr[i]) do
        for Hp in Elements (ccSubgr[j]) do
          if isGassmannTripple (H,Hp,cc) and Size(H) > hSize then
            triple := [G,H,Hp];
            hSize := Size(H);
          fi;
        od;
      od;

    od;
  od;

  return triple;
end;;
\end{verbatim}
  \end{shaded}

  \begin{shaded}
\begin{verbatim}
gap> findGassmannTriple (SmallGroup(32,43));
[ <pc group of size 32 with 5 generators>, Group([ f2, f3 ]), 
  Group([ f2*f4, f3 ]) ]
gap> Size(last[2]);
4
\end{verbatim}
  \end{shaded}

  En este caso $[G:H] = 8$, y $G$ puede ser realizado como un grupo de Galois de
  alguna extensión $L/\QQ$, lo que nos da un ejemplo de dos campos no isomorfos
  aritméticamente equivalentes de grado $8$. Con ayuda de PARI/GP o LMFDB,
  encontramos dos campos específicos definidos por polinomios irreducibles
  \[ f = x^8 - x^4 - 1, \quad
    f' = x^8 - 4\,x^6 + 5\,x^4 - 2\,x^2 - 1. \]
  En este caso $r_1 = 2$, $r_2 = 3$, y el discriminante correspondiente es
  $-2^{16}\cdot 5^4 = -40960000$.

  Para verificar la equivalencia aritmética de manera indirecta, sin ocupar los
  grupos de Galois, podemos recurrir a las siguientes consideraciones.
  El teorema de Kummer--Dedekind nos dice que que salvo un número finito de
  primos, el tipo de descomposición de $p$ en $\O_K$ es el mismo que el tipo de
  descomposición del polinomio $f$ mód $p$. Podemos entonces escribir un código
  que compara los tipos de descomposición de $f$ y $f'$ para una cantidad
  suficientemente grande de primos.

  \begin{shaded}\small
\begin{verbatim}
dectype (f,p) = {
  local (dec = factor(f*Mod(1,p)));
  vecsort (vector (matsize(dec)[1], i, poldegree(dec[i,1])))
};

N = 10^6;

compare (f1,f2) = {
  local (badprimes = List());

  forprime (p=2,N,
    if (dectype(f1,p) != dectype(f2,p),
      listput (badprimes,p)
    )
  );

  Vec(badprimes)
};
\end{verbatim}
  \end{shaded}

  Aquí esencialmente estamos comparando los factores de Euler de las funciones
  zeta $\zeta_K (s)$ y $\zeta_{K'} (s)$, salvo un número finito, que como ya
  sabemos, no afectan el resultado. Por otra parte, el cálculo de los valores de
  las funciones zeta con una buena precisión requiere bastante memoria, y por
  esto lo evitamos.

  \begin{shaded}\small
\begin{verbatim}
? f1 = x^8 - x^4 - 1;
? f2 = x^8 - 4*x^6 + 5*x^4 - 2*x^2 - 1;
? compare (f1,f2)
? = []
? K1 = nfinit(f1);
? K2 = nfinit(f2);
? nfisisom(K1,K2)
% = 0
? K1.disc
% = -40960000
? K2.disc
% = -40960000
? K1.sign
% = [2, 3]
? K2.sign
% = [2, 3]
\end{verbatim}
  \end{shaded}
\end{ejemplo}

\begin{ejemplo}
  El artículo de Perlis \cite{Perlis-1977} contiene un argumento sencillo de la
  teoría de grupos que demuestra que para una tripla de Gassmann no trivial
  $(G,H,H')$ necesariamente se tiene $[G : H] \ge 7$. Esto significa que los
  campos no isomorfos de grado $\le 6$ no pueden ser aritméticamente
  equivalentes. Perlis dice que un campo $K$ es \textbf{solitario} si todo campo
  aritméticamente equivalente a $K$ debe ser isomorfo a $K$.

  De nuevo, usando GAP, se puede verificar que el grupo más
  pequeño que nos da una tripla con $[G : H] = 7$ es $G = \GL_3 (\FF_2)$.

  \begin{shaded}\small
\begin{verbatim}
gap> findGassmannTriple(GL(3,2));
[ SL(3,2), <matrix group of size 24 with 4 generators>, 
  <matrix group of size 24 with 4 generators> ]
gap> Size(last[1])/Size(last[2]);
7
\end{verbatim}
  \end{shaded}

  De hecho, hay una manera geométrica de obtener la tripla de Gassmann en
  cuestión. El grupo $\GL_3 (\FF_2) \cong \SL_3 (\FF_2) \cong \PSL_3 (\FF_2)$
  actúa sobre los $7$ puntos de $\AA^3 (\FF_2) \setminus \{ 0 \}$, y por otra
  parte sobre los $7$ hiperplanos en este espacio que corresponden a los puntos
  del plano proyectivo $\PP^2 (\FF_2)$. Estas acciones son
  $2$-transitivas\footnote{Para cualesquiera $(x,y)$, $(x',y')$ con $x\ne y$,
    $x'\ne y'$ existe $g\in G$ tal que $(g\cdot x, g\cdot y) = (x',y')$}.
  Ahora sean $P$ un punto no nulo en $\AA^3 (\FF_2)$ y $L$ el hiperplano
  ortogonal correspondiente. Una matriz $A \in \GL_3 (\FF_2)$ fija $L$ si y
  solamente si la matriz traspuesta $A^t$ fija $P$. Sean $H$ el grupo
  estabilizador de $P$ y $H'$ el estabilizador de $L$. Se puede ver que $H$ y
  $H'$ no son conjugados, y para toda matriz $A \in \GL_3 (\FF_2)$ existe una
  biyección
  $$(H\cap A^G) \leftrightarrow (H'\cap A^G).$$
  Especificamente, esta biyección viene dada por $B\mapsto B^t$, ya que toda
  matriz es conjugada con su traspuesta.

  Realizando $\GL_3 (\FF_2)$ como un grupo de Galois, a partir de esta tripla de
  Gassmann se pueden encontrar polinomios específicos
  \[ f = x^7 - 7\,x - 3, \quad
    f' = x^7 - 7\,x^4 - 21\,x^3 + 21\,x^2 + 42\,x - 9. \]
  En este caso $r_1 = 3$, $r_2 = 2$, $\Delta = 3^6\cdot 7^8 = 4202539929$.

  \begin{shaded}\small
\begin{verbatim}
? f1 = x^7 - 7*x - 3;
? f2 = x^7 - 7*x^4 - 21*x^3 + 21*x^2 + 42*x - 9;
? compare (f1,f2);
% = [3]
? K1 = nfinit(f1);
? K2 = nfinit(f2);
? nfisisom(K1,K2)
% = 0
? K1.disc
% = 4202539929
? K2.disc
% = 4202539929
? K1.sign
% = [3, 2]
? K2.sign
% = [3, 2] 
\end{verbatim}
  \end{shaded}
\end{ejemplo}

Más ejemplos particulares de campos aritméticamente equivalentes de grado
pequeño se encuentran en el artículo \cite{Bosma-deSmit-2002}. Antes de discutir
la prueba del teorema de Gassmann, notamos su consecuencia importante.

\begin{corolario}
  Si $K$ y $K'$ son aritméticamente equivalentes, entonces
  $\O_K^\times \cong \O_{K'}^\times$.

  \begin{proof}
    Primero, $r_1 = r'_1$ y $r_2 = r'_2$ implica que
    $$\rk \O_K^\times = r_1 + r_2 - 1 = r'_1 + r'_2 - 1 = \rk \O_{K'}^\times.$$
    Nos falta ver que las partes de torsión de los grupos de unidades también
    coinciden; es decir, que $\mu_K = \mu_{K'}$.

    Por la definición, el \textbf{corazón normal}\footnote{\emph{normal core} en
      inglés y \emph{cœur} en francés} de $K$ es el subcampo más grande
    $F\subseteq K$ tal que la extensión $F/\QQ$ es normal. Este será
    precisamente el subcampo de $L$ fijo por el subgrupo generado por todos los
    subgrupos conjugados $H^g$ para $g \in G$. Por la definición de triplas de
    Gassmann, para todo $h\in H$ tenemos
    $\# (H\cap h^G) = \# (H'\cap H^G) \ne 0$. En particular, algún conjugado
    $h^g$ está en $H'$. De aquí se sigue fácilmente que
    $\langle H^g \mid g\in G\rangle = \langle H'^g \mid g\in G\rangle$, así que
    $K$ y $K'$ comparten el mismo corazón normal.

    Las extensiones ciclotómicas $\QQ (\mu_K)/\QQ$ y $\QQ (\mu_{K'})/\QQ$ son
    normales, así que ambas están en el corazón normal de $K$ y $K'$, y por ende
    $\mu_K = \mu_{K'}$.
  \end{proof}
\end{corolario}

\begin{corolario}
  Si $K$ y $K'$ son aritméticamente equivalentes, entonces
  $$\Reg_K\,h_K = \Reg_{K'}\,h_{K'}.$$

  \begin{proof}
    Dado que $\zeta_K (s) = \zeta_{K'} (s)$, las funciones zeta tienen el mismo
    residuo en $s = 1$ que nos da la fórmula del número de clases:
    \[ \frac{2^{r_1}\,(2\pi)^{r_2}\,\Reg_K\,h_K}{\#\mu_K\,\sqrt{|\Delta_K|}} = 
      \frac{2^{r'_1}\,(2\pi)^{r'_2}\,\Reg_{K'}\,h_{K'}}{\#\mu_{K'}\,\sqrt{|\Delta_{K'}|}}. \]
    Aquí $r_1 = r'_1$, $r_2 = r'_2$, $\Delta_K = \Delta_{K'}$.
  \end{proof}
\end{corolario}

Esto nos deja con la siguiente pregunta: ¿será también cierto que la
equivalencia aritmética implica que $\Reg_K = \Reg_{K'}$ y $h_K = h_{K'}$? La
respuesta es \emph{negativa}.

\begin{ejemplo}
  En \cite{deSmit-Perlis-1994} de Smit y Perlis
  construyen una familia de ejemplos, entre cuales está
  \[ K = \QQ (\sqrt[8]{-15}), \quad K' = \QQ (\sqrt[8]{-240}). \]
  Estos dos campos son aritméticamente equivalentes, pero
  \[ \Reg_K = 66.316448\ldots, \quad
    h_K = 16, \quad
    \Reg_{K'} = 132.632896\ldots, \quad
    h_{K'} = 8. \]

  \begin{shaded}\small
\begin{verbatim}
? f1 = x^8 + 15;
? f2 = x^8 + 240;
? compare (f1,f2);
% = []
? K1 = bnfinit(f1);
? K2 = bnfinit(f2);
? nfisisom(K1,K2)
% = 0
? K1.disc
% = 174960000000
? K2.disc
% = 174960000000
? K1.sign
% = [0, 4]
? K2.sign
% = [0, 4]
? K1.no
% = 16
? K2.no
% = 8
? K1.reg
% = 66.316448148870962189601403176835356992
? K2.reg
% = 132.63289629774192437920280635367071398
\end{verbatim}
  \end{shaded}
\end{ejemplo}

Entonces, la función zeta $\zeta_K (s)$ sabe mucho del campo de números $K$,
¡pero no todo! En algún sentido, esto pasa porque, aunque los invariantes
aritméticos de $K$ aparecen en las fórmulas para los valores especiales de
$\zeta_K (s)$, estos invariantes están «entrelazados» entre sí.

\subsection{Demostración del teorema de Gassmann}

Para probar el teorema de Gassmann~\ref{thm:Gassmann}, necesitamos revisar cómo
el automorfismo de Frobenius determina el tipo de descomposición de primos
racionales. Sea $L/\QQ$ una extensión de Galois y $K \subseteq L$ un
subcampo. Denotemos $G = \Gal (L/\QQ)$ y $H = \Gal (L/K)$.

\begin{enumerate}
\item A todo primo racional $p$ que no se ramifica en $L$ corresponde el
  automorfismo de Frobenius $\Frob_p \in G$. El teorema de densidad de
  Chebotarëv (véase~\ref{thm:Chebotarev}) nos dice que para cada $\sigma \in G$
  existe un número infinito de $p$ tales que $\Frob_p$ tiene la misma clase de
  conjugación que $\sigma$.

\item El teorema~\ref{thm:tipo-de-descomposicion-en-extension-no-Galois} nos
  dice que para $p$ no ramificado en $L$ el tipo de descomposición
  $p \O_K = \mathfrak{p}_1\cdots \mathfrak{p}_s$ se determina por la acción de
  $\Frob_p$ sobre las clases laterales
  $$H\backslash G = \{ H\tau \mid \tau \in G \}$$
  por la multiplicación por la derecha. Específicamente, los grados de campos
  residuales $f_1,\ldots,f_s$ corresponden exactamente al tipo de ciclo de
  $\Frob_p$ visto como una permutación del conjunto $H\backslash G$.

\item En general, dada una representación por permutaciones $G\to \Sym (X)$,
  la traza correspondiente cuenta los puntos fijos y da lugar a un carácter
  $\chi\colon G\to \ZZ$ que es una función constante sobre las clases laterales.
  $$\chi (\sigma) = \#\{ x \in X \mid \sigma (x) = x \}.$$
  El tipo de ciclo de cada $\sigma \in G$ se determina por el carácter $\chi$,
  específicamente por los valores de $\chi (\sigma^n)$ para $n = 1,2,3,\ldots$

\item En nuestro caso particular, nos interesa la representación
  $G \to \Sym (H \backslash G)$ y el carácter correspondiente
  $$\chi_H (\sigma) = \# \{ H\tau \in H\backslash G \mid H \tau \sigma = H \tau \}.$$
\end{enumerate}

Ahora supongamos que $K, K' \subseteq L$ son dos subcampos y $H = \Gal (L/K)$,
$H' = \Gal (L/K')$.

\begin{lema}
  Los campos $K$ y $K'$ son aritméticamente equivalentes si y solamente si
  $\chi_H = \chi_{H'}$.

  \begin{proof}
    Si $K$ y $K'$ son aritméticamente equivalentes, entonces salvo un número
    finito, todo primo $p$ tiene el mismo tipo de descomposición en $K$ y $K'$.
    Entonces, el tipo de ciclo de la acción de $\Frob_p$ sobre $H\backslash G$ y
    $H' \backslash G$ coincide. Puesto que cada clase de conjugación $\sigma^G$
    se realiza por $\Frob_p$ por un número infinito de $p$, esto implica que
    $\chi_H = \chi_{H'}$.

    Viceversa, si $\chi_H = \chi_{H'}$, entonces para todo $p$ no ramificado en
    $L$ el tipo de ciclo de $\Frob_p$ actuando sobre $H\backslash G$ y
    $H'\backslash G$ coincide. Esto implica que el tipo de descomposición de $p$
    en $K$ y $K'$ es el mismo. Entonces, $K$ y $K'$ son aritméticamente
    equivalentes.
  \end{proof}
\end{lema}

Para probar el teorema de Gassmann, nos falta relacionar la condición
$\chi_H = \chi_{H'}$ con las triplas de Gassmann.

\begin{lema}
  Para un grupo finito $G$, dos subgrupos $H, H' \subset G$ dan lugar a una
  tripla de Gassmann $(G,H,H')$ si y solamente si $\chi_H = \chi_{H'}$.

  \begin{proof}
    Definamos
    $$\psi_H\colon G\to \ZZ, \quad \sigma \mapsto \# (H \cap \sigma^G).$$
    Esta es una función constante sobre las clases de conjugación, y por la
    definición, $(G,H,H')$ es una tripla de Gassmann si y solamente si
    $\psi_H = \psi_{H'}$.

    Para $\sigma \in G$ consideremos el centralizador correspondiente
    $$C_G (\sigma) = \{ \tau \in G \mid \tau\sigma = \sigma\tau \}.$$
    Este es el estabilizador de la acción de $G$ sobre la clase de conjugación
    $\sigma^G$ mediante la conjugación. Tenemos
    \[ \psi_H (\sigma)\cdot \# C_G (\sigma) =
      \# \{ \tau \in G \mid \tau \sigma \tau^{-1} \in H \} =
      \# \{ \tau \in G \mid H \tau \sigma = H \tau \} =
      \chi_H (\sigma) \cdot \# H. \]
    Podemos definir entonces la función $\phi_H\colon G \to \QQ$ mediante
    $\phi_H (\sigma) = \# C_G (\sigma) / \# H$. El cálculo de arriba nos dice
    que $\chi_H = \psi_H\,\phi_H$.

    Ahora si $(G,H,H')$ es una tripla de Gassmann, entonces $\phi_H = \psi_{H'}$
    y $\phi_H = \phi_{H'}$ (dado que $\# H = \# H'$). Esto implica que
    $\chi_H = \chi_{H'}$. Viceversa, si $\chi_H = \chi_{H'}$, entonces
    $\phi_H = \phi_{H'}$, dado que
    $\# (H\backslash G) = \chi_H (1) = \chi_{H'} (1) = \# (H'\backslash G)$.
    Esto implica que $\psi_H = \psi_{H'}$, así que $(G,H,H')$ es una tripla de
    Gassmann.
  \end{proof}
\end{lema}

Juntando todas las observaciones, se obtiene una prueba del teorema de
Gassmann~\ref{thm:Gassmann}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\pagebreak

\phantomsection

\addcontentsline{toc}{section}{Ejercicios}
\section*{Ejercicios}

\begin{ejercicio}
  Dado un número natural $n$, calcule el número de representaciones
  $n = x^2 - xy + y^2$ con $x,y \in \ZZ$.

  \noindent (Considere la función zeta de $\QQ (\zeta_3)$.)
\end{ejercicio}

\begin{ejercicio}[Símbolo de Kronecker]
  Para $a \in \ZZ$ libre de cuadrados, $a \equiv 0 \pmod{4}$, definamos el
  \textbf{símbolo de Kronecker} $\chi_a$ de la siguiente manera.
  \begin{itemize}
  \item Si $p \mid a$, entonces $\chi_a (p) = 0$.
  \item Si $p \nmid a$ es un primo impar, entonces $\chi_a (p) = \legendre{a}{p}$
    es el símbolo de Legendre.
  \item $\chi_a (2) = +1$ si $a \equiv 1 \pmod{8}$ y $\chi_a (2) = -1$ si
    $a \equiv 5 \pmod{8}$.
  \item En geleral, si $\pm b = p_1 \cdots p_s$, entonces
    $\chi_a (n) = \chi_a (p_1) \cdots \chi_a (p_s)$.
  \end{itemize}

  Demuestre las siguientes propiedades.
  \begin{enumerate}
  \item[1)] $\chi_d (n) = \legendre{n}{d}$ es el símbolo de Jacobi para $n$
    impar.
  \item[2)] Si $n > 0$, $\gcd (a,n) = 1$, $a = 2^t\,c$ con $c$ impar, entonces
    $$\chi_a (n) = (-1)^{\frac{c-1}{2}\,\frac{n-1}{2}}\,\chi_2 (n)^t \, \chi_n (c).$$
  \item[3)] $\chi_a (m) = \chi_a (n)$ si $m \equiv n \pmod{a}$.
  \end{enumerate}
\end{ejercicio}

\begin{ejercicio}
  \label{ejerc:caracter-para-campo-cuadratico}
  Para un campo cuadrático $K = \QQ (\sqrt{d})$ consideremos el símbolo de
  Kronecker $\chi = \chi_{\Delta_K}$.

  \begin{enumerate}
  \item[1)] Demuestre que $\chi$ es un carácter de Dirichlet mód $|\Delta_K|$.

  \item[2)] Demuestre que $\chi$ determina la factorización de primos
    racionales en $\O_K$:
    \[ p\O_K = \begin{cases}
      \mathfrak{p}\,\overline{\mathfrak{p}}, & \text{si } \chi (p) = +1,\\
      \mathfrak{p}, & \text{si } \chi (p) = -1,\\
      \mathfrak{p}^2, & \text{si } \chi (p) = 0.
    \end{cases} \]

  \item[3)] Demuestre que $\zeta_K (s) = \zeta (s) \, L (s,\chi)$.
  \end{enumerate}
\end{ejercicio}

\begin{ejercicio}
  \label{ejerc:L-series-caracter-cuadratico-mod-p}
  Sea $p$ un número primo y $\chi$ el carácter de Dirichlet de orden $2$ mód
  $p$, definido por el símbolo de Legendre $\chi (n) = \legendre{n}{p}$.

  \begin{enumerate}
  \item[1)] Demuestre que
    $$\exp (g (\chi)\,L (1,\chi)) = \prod_n (1 - \zeta_p^n)\,\prod_r (1 - \zeta_p^r)^{-1},$$
    donde $g (\chi) = \sum_{1 \le a
      \le p-1} \chi (a)\,\zeta_p^a$, y los productos son sobre los no-residuos y
    residuos cuadráticos mód $p$ respectivamente.

  \item[2)] Use la parte anterior para calcular $L (1,\chi)$, donde $\chi$ es el
    carácter de orden $2$ mód $5$.  (Para el valor numérico en PARI/GP, basta
    digitar \texttt{lfun(5,1)})
  \end{enumerate}
\end{ejercicio}

\begin{ejercicio}
  Sean $X$ un grupo de caracteres de Dirichlet y $K$ un subcampo de
  $\QQ (\zeta_m)$ correspondiente. Demuestre que $K$ es un campo real si y
  solamente si todos los caracteres $\chi \in X$ son pares (satisfacen
  $\chi (-1) = +1$).
\end{ejercicio}

\begin{ejercicio}
  Los números y polinomios de Bernoulli tienen parientes muy cercanos:
  los \textbf{números y polinomios de Euler}. Estos se definen por las funciones
  generatrices
  \[ \frac{2}{e^t + e^{-t}} = \sum_{k \ge 0} \frac{E_k}{k!} \, t^k, \quad
     \frac{2 e^{xt}}{e^t + 1} = \sum_{k \ge 0} E_k (x)\,\frac{t^k}{k!}. \]
  Demuestre las identidades.
  \[ E_k = 2^k \, E_k \left(\frac{1}{2}\right), \quad
     E_k (x+1) + E_k (x) = 2\,x^k, \quad
     E_k (1-x) = (-1)^k\,E_k (x), \quad
     E_k' (x) = k\,E_{k-1} (x). \]
\end{ejercicio}

\begin{ejercicio}[Continuación]
  Consideremos la función periódica $f (x) = E_k (x - \lfloor x\rfloor)$.

  \begin{enumerate}
  \item[a)] Demuestre que la serie de Fourier para $f (x)$ viene dada por
    $$f (x) = \frac{2\cdot k!}{(\pi i)^{k+1}}\,\sum_{n\in \mathbb{Z}} \frac{e^{(2n+1)\pi i x}}{(2n+1)^{k+1}}.$$
  \item[b)] Deduzca que para la \textbf{función beta}
    $\beta (s) = \sum_{n \ge 0} \frac{(-1)^n}{(2n+1)^s}$ se tiene
    $$\beta (2k+1) = (-1)^k\,\frac{E_{2k}}{4^{k+1}\,(2k)!}\,\pi^{2k+1}.$$
  \end{enumerate}
\end{ejercicio}

\begin{ejercicio}[Continuación]
  Sea $\chi$ el carácter de Dirichlet no trivial mód $4$.

  \begin{enumerate}
  \item[a)] Demuestre que $\beta (s) = L (s,\chi)$.

  \item[b)] Exprese los valores especiales $\beta (2k+1)$ en términos de
    $B_{2k+1,\chi}$.

  \item[c)] Demuestre que $E_k = -\frac{2B_{k+1,\chi}}{k+1}$.
  \end{enumerate}
\end{ejercicio}
