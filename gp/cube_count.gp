/* ----------------------------------------------------------------------
  ¿Para cuántos primos p = 1 (3) se tiene que 19 es un cubo mód p?
---------------------------------------------------------------------- */

iscube (n,p) = p%3 == 1 && n%p != 0 && ((p-1)/znorder(Mod(n,p)))%3 == 0;

stat(N) = {
  local (p=2, prime_count = 0, c = 0);

  while (prime_count < N,
    c = c + iscube(19,p);
    p = nextprime (p+1);
    prime_count++;
  );

  return (1.0*c/N)
};


/* ----------------------------------------------------------------------
  ? for (n=2,7, printf ("10^%d:\t %.6f\n", n, stat (10^n)));
  10^2:     0.140000
  10^3:     0.160000
  10^4:     0.163500
  10^5:     0.166410
  10^6:     0.166575
  10^7:     0.166609
---------------------------------------------------------------------- */
